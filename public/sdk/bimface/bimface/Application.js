"use strict";function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_slicedToArray=function(){function e(e,t){var n=[],o=!0,a=!1,i=void 0;try{for(var r,l=e[Symbol.iterator]();!(o=(r=l.next()).done)&&(n.push(r.value),!t||n.length!==t);o=!0);}catch(e){a=!0,i=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),version="2021-1-27-21-20",Glodon=window.Glodon||{};Glodon.Version=version,function(){function e(e,t){for(var n=t.split("."),o=e,a=n.length,i=0;i<a;i++)void 0===o[n[i]]&&(o[n[i]]={}),o=o[n[i]];return o}e(Glodon,"Web.Lang.Utility.Namespace").ensureNamespace=e}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Common"),t=function(e){"string"==typeof e&&(e=JSON.parse(res)),this.code=e.code,this.message=e.message};t.prototype={getErrorCode:function(){return this.code},getErrorMessage:function(){return this.message}},e.Error=t}();var Vector3=function(){function e(t,n,o){_classCallCheck(this,e),this.x=t||0,this.y=n||0,this.z=o||0}return _createClass(e,[{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y,o=this.z-e.z;return t*t+n*n+o*o}}]),e}(),Box3=function(){function e(t,n){_classCallCheck(this,e),this.min=t||new Vector3(1/0,1/0,1/0),this.max=n||new Vector3(-1/0,-1/0,-1/0)}return _createClass(e,[{key:"getSize",value:function(){return new Vector3(this.max.x-this.min.x,this.max.y-this.min.y,this.max.z-this.min.z)}},{key:"setFromCenterAndSize",value:function(e,t){var n=new Vector3(t.x,t.y).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"getCenter",value:function(){return new Vector3(this.min.x+this.max.x,this.min.y+this.max.y,this.min.z+this.max.z).multiplyScalar(.5)}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}}]),e}();!function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Algorithm"),t=function(){function e(t,n){_classCallCheck(this,e),this.points=t,this.searchRangeSquared=Math.pow(n,2),this.EPSILON_SQR=.1,this.clusters=[],this._clusterId=1}return _createClass(e,[{key:"setSearchRange",value:function(e){this.searchRangeSquared=Math.pow(e,2)}},{key:"setPoints",value:function(e){this.points=e}},{key:"meanShift",value:function(e){for(var t=e.clone(),n=[];;){var o=this.rangeSearch(t);this.connect(n,o);var a=this.mean(o);if(t.distanceToSquared(a)<=this.EPSILON_SQR)break;t=a}return n}},{key:"mean",value:function(e){var t=new Vector3,n=!0,o=!1,a=void 0;try{for(var i,r=e[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var l=i.value;t.add(l)}}catch(e){o=!0,a=e}finally{try{!n&&r.return&&r.return()}finally{if(o)throw a}}return t.multiplyScalar(1/e.length),t}},{key:"rangeSearch",value:function(e){var t=[],n=!0,o=!1,a=void 0;try{for(var i,r=this.points[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var l=i.value;e.distanceToSquared(l)<=this.searchRangeSquared&&t.push(l)}}catch(e){o=!0,a=e}finally{try{!n&&r.return&&r.return()}finally{if(o)throw a}}return t}},{key:"clustering",value:function(e,t){var n=this;if(this.tmpPoints=this.points,this.clusters.length>0){1===this.clusters.length&&1===this.clusters[0].parents.length&&(this._clusterId=1),this.points=[];var o=[].concat(_toConsumableArray(this.clusters));this.clusters=[];for(var a=0;a<o.length;a++){var i=o[a],r=[];t?this.points=i.points:(this.resetClusterPoints(i.points),this.points=i.points);var l=[],s=0;e?(s=++this._clusterId,l=i.parents):(s=i.parents.pop(),void 0===s&&(s=0),l=i.parents);var d=!0,c=!1,u=void 0;try{for(var p,f=i.points[Symbol.iterator]();!(d=(p=f.next()).done);d=!0){var h=p.value;if(!h.stopMoving){var m=this.meanShift(h);e?this.mergeClustersInTarget({points:m,center:this.mean(m),id:s,parents:[].concat(_toConsumableArray(l))},r):this.mergeClusters({points:m,center:this.mean(m),id:s,parents:[].concat(_toConsumableArray(l))})}}}catch(e){c=!0,u=e}finally{try{!d&&f.return&&f.return()}finally{if(c)throw u}}e&&this.clusters.push.apply(this.clusters,r)}}else{var g=!0,v=!1,b=void 0;try{for(var y,w=this.points[Symbol.iterator]();!(g=(y=w.next()).done);g=!0){var C=y.value;if(!C.stopMoving){var M=this.meanShift(C),B=++this._clusterId,k=[0];k.push(B),this.mergeClusters({points:M,center:this.mean(M),id:this._clusterId++,parents:k})}}}catch(e){v=!0,b=e}finally{try{!g&&w.return&&w.return()}finally{if(v)throw b}}}this.clusters.forEach(function(e){n.resetPointStatus(e.points)})}},{key:"mergeClusters",value:function(e){var t=!1,n=!0,o=!1,a=void 0;try{for(var i,r=this.clusters[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var l=i.value,s=e.center.distanceToSquared(l.center)<=4*this.searchRangeSquared,d=JSON.stringify(l.parents)===JSON.stringify(e.parents);if(s&&d){this.connect(l.points,e.points,!0),l.center=this.mean(l.points),this.updateClusterBbox(l),t=!0;break}}}catch(e){o=!0,a=e}finally{try{!n&&r.return&&r.return()}finally{if(o)throw a}}!1===t&&(this.updateClusterBbox(e),this.clusters.push(e))}},{key:"mergeClustersInTarget",value:function(e,t){var n=!1,o=!0,a=!1,i=void 0;try{for(var r,l=t[Symbol.iterator]();!(o=(r=l.next()).done);o=!0){var s=r.value;if(e.center.distanceToSquared(s.center)<=4*this.searchRangeSquared){this.removeNodeFromParents(e.id,s.parents),this.connect(s.points,e.points,!0),s.center=this.mean(s.points),this.updateClusterBbox(s),n=!0;break}}}catch(e){a=!0,i=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw i}}!1===n&&(this.updateClusterBbox(e),e.id=++this._clusterId,e.parents.push(e.id),t.push(e))}},{key:"removeNodeFromParents",value:function(e,t){var n=t.indexOf(e);n>=0&&t.splince(n,1)}},{key:"updateClusterBbox",value:function(e){var t=(new Box3).setFromPoints(e.points);e.bbox=t}},{key:"connect",value:function(e,t,n){var o=!0,a=!1,i=void 0;try{for(var r,l=t[Symbol.iterator]();!(o=(r=l.next()).done);o=!0){var s=r.value;s.stopMoving&&!n||e.push(s),s.stopMoving=!0}}catch(e){a=!0,i=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw i}}return e}},{key:"resetPointStatus",value:function(e){var t=!0,n=!1,o=void 0;try{for(var a,i=e[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){a.value.stopMoving=!1}}catch(e){n=!0,o=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw o}}}},{key:"resetClusterPoints",value:function(e){for(var t=0;t<e.length;t++)for(var n=0;n<this.tmpPoints.length;n++)if(e[t].index===this.tmpPoints[n].index){e[t]=this.tmpPoints[n];break}}}]),e}();e.MeanShift=t}();var Vector2=function(){function e(t,n){_classCallCheck(this,e),this.x=t||0,this.y=n||0}return _createClass(e,[{key:"clone",value:function(){return new this.constructor(this.x,this.y)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this}},{key:"normalize",value:function(){return this.multiplyScalar(1/this.length())}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this}},{key:"rotateAround",value:function(e,t){var n=Math.cos(t),o=Math.sin(t),a=this.x-e.x,i=this.y-e.y;return this.x=a*n-i*o+e.x,this.y=a*o+i*n+e.y,this}},{key:"setLength",value:function(e){return this.multiplyScalar(e/this.length())}},{key:"angle",value:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}}]),e}(),Box2=function(){function e(t,n){_classCallCheck(this,e),this.min=t||new Vector2(1/0,1/0),this.max=n||new Vector2(-1/0,-1/0)}return _createClass(e,[{key:"getSize",value:function(){return new Vector2(this.max.x-this.min.x,this.max.y-this.min.y)}},{key:"setFromCenterAndSize",value:function(e,t){var n=new Vector2(t.x,t.y).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"getCenter",value:function(){return new Vector2(this.min.x+this.max.x,this.min.y+this.max.y).multiplyScalar(.5)}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}}]),e}();if(function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Algorithm"),t=function e(){_classCallCheck(this,e)};t.toThreeJsBox2=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=[],o=!0,a=!1,i=void 0;try{for(var r,l=e[Symbol.iterator]();!(o=(r=l.next()).done);o=!0){var s=r.value,d=Math.min(t,100)/100,c=Math.max(s[1][1]-s[0][1],s[1][0]-s[0][0]),u=c*d,p=new Vector2(s[0][0],s[0][1]),f=new Vector2(s[1][0],s[1][1]),h=new Box2(p,f),m=h.getSize();n.push((new Box2).setFromCenterAndSize(h.getCenter(),m.addScalar(2*u)))}}catch(e){a=!0,i=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw i}}var g=0,v=!0,b=!1,y=void 0;try{for(var w,C=n[Symbol.iterator]();!(v=(w=C.next()).done);v=!0){w.value.indices=[g++]}}catch(e){b=!0,y=e}finally{try{!v&&C.return&&C.return()}finally{if(b)throw y}}return n},t.toDrawingBox2=function(e){var t=[],n=!0,o=!1,a=void 0;try{for(var i,r=e[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var l=i.value,s=[];s.push([l.min.x,l.min.y]),s.push([l.max.x,l.max.y]),t.push(s)}}catch(e){o=!0,a=e}finally{try{!n&&r.return&&r.return()}finally{if(o)throw a}}return t},t.merge=function(e,t){for(var n=e.length,o=0;o<=n;o++){if(o===n){e.push(t);break}var a=e[o];if(a.intersectsBox(t)){a.union(t),a.indices=a.indices.concat(t.indices);break}}},t.mergeBoundingBox=function(e){for(var n=e,o=[];;){for(var a=0;a<n.length;a++)t.merge(o,n[a]);if(o.length===n.length)break;n=o.slice(0,o.length),o=[]}return o},e.BoundingBoxUtil=t}(),function(){function e(e){function t(){}return t.prototype=e,new t}function t(t,n){var o=e(n.prototype);o.constructor=t,t.prototype=o}Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Type").inheritPrototype=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.HttpRequest"),t=function(e){var t,n={type:"get",cache:!0,headers:{"Content-type":"application/x-www-form-urlencoded"},data:null,async:!0,success:null,failure:null},o=Object.assign(n,e);t=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),t.onreadystatechange=function(){if(4==t.readyState){var e=t.status;e>=200&&e<300||0==e?o.success&&o.success(t.responseText,t.responseXML):o.failure&&o.failure(e)}},t.open(o.type,o.url,o.async);for(var a in o.headers)t.setRequestHeader(a,o.headers[a]);t.send(o.data)},n=function(e,t){var n={};if(n[e])t&&t();else{var o=document.createElement("script");o.type="text/javascript",o.src=e,document.head.appendChild(o),n[e]=!0,o.readyState?o.onreadystatechange=function(){"loaded"!=o.readyState&&"complete"!=o.readyState||(o.onreadystatechange=null,t&&t())}:o.onload=function(){t&&t()}}},o=function e(t,o){t.length>1?n(t.shift(),function(){e(t,o)}):n(t.shift(),o)},a=function(e,n){var o=void 0;return o="string"==typeof e?{url:e,status:n}:e,new Promise(function(e,a){t(Object.assign({},o,{success:function(t){try{var i=JSON.parse(t)}catch(n){return e(t)}"success"==i.code||"noCode"==o.status?e("noCode"==n?i:i.data):a("requestError，dataCode:"+i.code+", dataMessage:"+i.message)},failure:function(e){a(e)}}))})};e.ajax=t,e.promiseJSONRequest=a,e.getScript=n,e.getScripts=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.FullScreen"),t=function(e){if(!e)return!1;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()},n=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()},o=function(){return document.webkitIsFullScreen||!!document.mozFullScreenElement||!!document.msFullScreenElement||!1},a=function(e){var t=function(){e&&e()};document.onfullscreenchange=t,document.onwebkitfullscreenchange=t,document.documentElement.onwebkitfullscreenchange=t,document.onmozfullscreenchange=t,document.onmsfullscreenchange=t};e.fullScreen=t,e.exitFullScreen=n,e.onFullScreenChanged=a,e.isFullScreen=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.ClientHelper"),t=null;if(!e.getIsDesktop){var n=function(){if("Mobile"===t)return!1;if("Web"===t)return!0;var e=navigator.userAgent,n=/(?:Windows Phone)/.test(e),o=/(?:SymbianOS)/.test(e)||n,a=/(?:Android)/.test(e),i=/(?:Firefox)/.test(e),r=(/(?:Chrome|CriOS)/.test(e),/(?:iPad|PlayBook)/.test(e)||a&&!/(?:Mobile)/.test(e)||i&&/(?:Tablet)/.test(e));return!(/(?:iPhone)/.test(e)&&!r||a||o||r)},o=function(e){t=e},a=function(){return/(?:iPhone)/.test(navigator.userAgent)},i=function(e){var t=function(e){return e.replace("viewToken.json","").replace(/\.\//g,"/").replace(/\/\//g,"/")};if(e.indexOf("://")>-1){var n=e.split("://");e=n[0]+"://"+t(n[1])}else e="//"===e.slice(0,2)?"//"+t(e.slice(2)):"./"!=e.slice(0,2)?t(e):"."+t(e.slice(1));return e},r=function(e,t,n){n=n||"asc";var o=!1;return t?t.indexOf(".")>-1&&(o=!0):t="name",e=e.sort(function(e,a){if(o){var i=c(e,t),r=c(a,t);return"asc"==n?i.localeCompare(r):r.localeCompare(i)}return"asc"==n?e[t].localeCompare(a[t]):a[t].localeCompare(e[t])}),d(e,t,o)},l=function(e,t,n){n=n||"asc";var o=!1;return t?t.indexOf(".")>-1&&(o=!0):t="name",e=e.sort(s(t,o)),d(e,t,o)},s=function(e,t){return function(n,o){function a(e,t,n){if(n){for(l=t;(n=a(e,l))<76&&n>65;)++l;return+e.slice(t-1,l)}return n=f&&f.indexOf(e.charAt(t)),n>-1?n+76:(n=e.charCodeAt(t)||0)<45||n>127?n:n<46?65:n<48?n-1:n<58?n+18:n<65?n-11:n<91?n+11:n<97?n-37:n<123?n+5:n-63}var i,r;t?(i=c(n,e),r=c(o,e)):(i=n[e],r=o[e]);var l,s,d=1,u=0,p=0,f=String.alphabet;if((i+="")!=(r+=""))for(;d;)if(s=a(i,u++),d=a(r,p++),s<76&&d<76&&s>66&&d>66&&(s=a(i,u,u),d=a(r,p,u=l),p=l),s!=d)return s<d?-1:1;return 0}},d=function(e,t,n){var o=[],a=[],i=[],r=[];return e.map(function(e,l){var s;s=n?c(e,t):e[t],/^[a-zA-Z]*$/.test(s.slice(0,1))?o.push(e):/^[\u4e00-\u9fa5]*$/.test(s.slice(0,1))?a.push(e):/^\d+(\.\d+)?$/.test(s.slice(0,1))?i.push(e):r.push(e)}),r.concat(i,o,a)},c=function(e,t){var n=t.split("."),o=e;return n.map(function(e,t){o=o[e]}),o},u=function(){return!!(window.ActiveXObject||"ActiveXObject"in window)},p=function(e,t,n,o,a,i){var r=void 0,l=void 0,s=void 0,d=void 0,c=0,u=Math.sqrt((n-e)*(n-e)+(o-t)*(o-t));if(0===u)return[0,{x:n,y:o}];var p=Math.sqrt((a-e)*(a-e)+(i-t)*(i-t));if(0===p)return[0,{x:a,y:i}];var f=Math.sqrt((n-a)*(n-a)+(o-i)*(o-i));if(0===f)return c=u,[c,{x:n,y:o}];if(u<p){if(o===i?r=n<a?0:Math.PI:(d=(a-n)/f,d-1>1e-5&&(d=1),r=Math.acos(d),o>i&&(r=2*Math.PI-r)),d=(e-n)/u,d-1>1e-5&&(d=1),l=Math.acos(d),o>t&&(l=2*Math.PI-l),s=l-r,s<0&&(s=-s),s>Math.PI&&(s=2*Math.PI-s),s>Math.PI/2)return[u,{x:n,y:o}];if(n===a)return[p*Math.sin(s),{x:n,y:t}];if(o===i)return[p*Math.sin(s),{x:e,y:o}];var h=0,m=0,g=(i-o)/a-n,v=-1/g,b=t-e*v;return h=(i-a*g-b)/(v-g),m=v*h+b,[u*Math.sin(s),{x:h,y:m}]}if(o===i?r=n<a?Math.PI:0:(d=(n-a)/f,d-1>1e-5&&(d=1),r=Math.acos(d),i>o&&(r=2*Math.PI-r)),d=(e-a)/p,d-1>1e-5&&(d=1),l=Math.acos(d),i>t&&(l=2*Math.PI-l),s=l-r,s<0&&(s=-s),s>Math.PI&&(s=2*Math.PI-s),s>Math.PI/2)return[p,{x:a,y:i}];if(n===a)return[p*Math.sin(s),{x:n,y:t}];if(o===i)return[p*Math.sin(s),{x:e,y:o}];var y=0,w=0,C=(i-o)/a-n,M=-1/C,B=t-e*M;return y=(i-a*C-B)/(M-C),w=M*y+B,[p*Math.sin(s),{x:y,y:w}]},f=function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}},h=function(){try{var e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2"))}catch(e){return!1}};e.getIsDesktop=n,e.setNavigatorType=o,e.getIsIphone=a,e.getIsIE=u,e.formatURL=i,e.sortByName=r,e.sortByRules=l,e.PointToLineDistance=p,e.isWebGLAvailable=f,e.isWebGL2Available=h}}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.MouseMotion"),t=function(e){function t(){n&&"walk"==e.getViewer().getEditorManager().editor.name||(o.addClass("motion-zoom"),a=Date.now(),setTimeout(function(){Date.now()-a>180&&o.removeClass("motion-zoom")},200))}var n=!1,o=e.getDomElement(),a=void 0,i=!1,r=!1,l=null;Glodon.Bimface.Viewer.Viewer3D&&e instanceof Glodon.Bimface.Viewer.Viewer3D&&(n=!0),o.addEventListener("keydown",function(e){17==event.keyCode&&(i=!0)}),o.addEventListener("keyup",function(e){17==event.keyCode&&(i=!1)}),o.addEventListener("mousedown",function(t){e._opt.enableZoomRect||i||(l={x:t.clientX,y:t.clientY})}),o.addEventListener("mousemove",function(t){if(l&&!r&&!(Math.abs(l.x-t.clientX)<2&&Math.abs(l.y-t.clientY)<2)){if(n){var a=e.getUseLeftHandedInput();if("walk"==e.getViewer().getEditorManager().editor.name)1==t.buttons&&o.addClass("motion-rotate");else{var i=e._getIsCursorEnabled();1==t.buttons?i&&o.addClass(a?"motion-rotate":"motion-translate"):o.addClass(a?"motion-translate":"motion-rotate")}}else 1==t.buttons&&o.addClass("motion-translate");r=!0}}),o.addEventListener("mousewheel",t,!1),o.addEventListener("DOMMouseScroll",t,!1),o.addEventListener("mouseup",function(e){l=!1,r=!1,o.removeClass("motion-translate"),o.removeClass("motion-rotate")})};e.setCursor=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=function(e,t){var n=document.createElement(e);return n.setAttribute("class",t),n};e.create=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=function(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg",e);return n.setAttribute("class",t),n};e.createNS=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=function(e){return e.indexof("#")?document.getElementById(e.replace("#","")):e.indexof(".")?document.getElementsByClassName(e.replace(".","")):document.getElementsByTagName(e)};e.select=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=function(e){var t=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),n={element:null,handle:null,axis:"all",cursor:"move",distance:0,start:null,move:null,stop:null,bBoxDetection:!1},o=Object.assign(n,e),a=o.element;if(!a)return!1;var i=o.handle||a,r=void 0,l=!1,s=this,d=function(e){return Math.pow(e.x,2)+Math.pow(e.y,2)>Math.pow(o.distance,2)&&(o.start&&o.start(r),!0)},c=function(e){var t=navigator.userAgent;return t.indexOf("compatible")>-1&&t.indexOf("MSIE")>-1&&!isOpera?1==e:0==e};this.resize=function(e,t,n){t=t||{x:0,y:0};var a=e.getBoundingClientRect(),i=e.parentElement.getBoundingClientRect(),r=a.left-i.left,l=a.top-i.top,s=e.offsetWidth,d=e.offsetHeight,c=e.parentElement.offsetWidth,u=e.parentElement.offsetHeight,p=Math.min(r+t.x,c-s),f=Math.min(l+t.y,u-d),h=r+t.x<0?0:p>0&&p||0,m=l+t.y<0?0:f>0&&f||0;n&&0!=h&&0!=m||(e.style.left=h+"px",e.style.top=m+"px",e.style.transform="none",o.record&&o.record(h,m))};var u=function(e){var t=a.getBoundingClientRect(),n=a.parentElement.getBoundingClientRect(),i=t.left-n.left,r=t.top-n.top;if(o.bBoxDetection)s.resize(a,e);else{var l=i+e.x,d=r+e.y;switch(o.axis){case"x":a.style.left=l+"px";break;case"y":a.style.top=d+"px";break;case"all":default:a.style.left=l+"px",a.style.top=d+"px"}}},p=function(e){var n=e;if(t){if(!c(n.button))return;r={x:n.clientX,y:n.clientY},document.addEventListener("mousemove",f)}else r={x:n.touches[0].clientX,y:n.touches[0].clientY},i.addEventListener("touchmove",f);o.start&&o.start(r)},f=function(e){var n=e;if(t)var a={x:n.clientX,y:n.clientY};else var a={x:n.touches[0].clientX,y:n.touches[0].clientY};var i={x:a.x-r.x,y:a.y-r.y};l?(o.move&&o.move(r,a,i),r=a,u(i)):l=d(i),e.preventDefault(),e.stopPropagation()},h=function(){l&&o.end&&o.end(r),l=!1,document.removeEventListener("mousemove",f),i.removeEventListener("touchmove",f)};t?(i.style.cursor=o.cursor,i.style.userSelect="none",i.addEventListener("mousedown",p),document.addEventListener("mouseup",h)):(i.addEventListener("touchend",h),i.addEventListener("touchstart",p))};e.drag=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=function(t){var n={element:null,axis:"all",minWidth:100,minHeight:100,distance:0,start:null,sizable:null,stop:null},o=Object.assign(n,t),a=o.element;if(!a)return!1;var i,r,l=void 0,s=!1,d=e.create("div","bf-resize"),c=function(e){return Math.pow(e.x,2)+Math.pow(e.y,2)>Math.pow(o.distance,2)&&(o.start&&o.start(l),!0)},u=function(e){var t=navigator.userAgent;return t.indexOf("compatible")>-1&&t.indexOf("MSIE")>-1&&!isOpera?1==e:0==e},p=function(e){var t=a.offsetLeft,n=a.offsetTop,l=i+e.x<o.minWidth?o.minWidth:i+e.x,s=r+e.y<o.minHeight?o.minHeight:r+e.y;switch(o.resize&&o.resize(l,s),a.style.left=t+"px",a.style.top=n+"px",o.axis){case"x":a.style.width=l+"px";break;case"y":a.style.height=s+"px";break;case"all":default:a.style.width=l+"px",a.style.height=s+"px"}},f=function(e){i=a.clientWidth,r=a.clientHeight;var t=e;u(t.button)&&(l={x:t.clientX,y:t.clientY},document.addEventListener("mousemove",h),document.addEventListener("touchmove",h))},h=function(e){var t=e,n={x:t.clientX,y:t.clientY},a={x:n.x-l.x,y:n.y-l.y};s?(o.sizable&&o.sizable(l,n,a),p(a)):s=c(a)},m=function(){s&&o.end&&o.end(l),s=!1,document.removeEventListener("mousemove",h),document.removeEventListener("touchmove",h)};a.addClass("bf-sizable"),a.appendChild(d),d.addEventListener("mousedown",f),d.addEventListener("touchstart",f),document.addEventListener("mouseup",m),document.addEventListener("touchend",m)};e.sizable=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=function(t){var n=this,o={element:null,min:0,max:100,cur:50,step:1,isShowProgress:!0,input:null,change:null,currentColor:"#11dab7",defaultColor:"#999"},a=Object.assign(o,t);this._opt=a;var i=e.create("div","bf-range"),r=e.create("input","bf-input-range");n.input=r,r.setAttribute("type","range"),r.setAttribute("step",a.step),r.setAttribute("min",a.min),r.setAttribute("max",a.max),r.setAttribute("value",a.cur);var l=e.create("span","bf-range-min");l.innerText=a.min;var s=e.create("span","bf-range-cur");n.cur=s,s.innerText=a.cur;var d=e.create("span","bf-range-max");d.innerText=a.max;var c=e.create("span","bf-range-progress");i.appendChild(r),a.isShowProgress&&(i.appendChild(l),i.appendChild(s),i.appendChild(d)),i.appendChild(c),a.element.appendChild(i),n.setProgress(a.cur),r.addEventListener("input",function(){n.setProgress(this.value),a.input&&a.input(this.value)}),r.addEventListener("change",function(){n.setProgress(this.value),a.change&&a.change(this.value)})};t.prototype.setProgress=function(e){var t=this._opt,n=t.max-t.min,o=this.input,a=this.cur,i=(e-t.min)/n*100;o.value=e,o.style.background="linear-gradient(to right,"+t.currentColor+" 0%,"+t.currentColor+"  "+i+"%,"+t.defaultColor+" "+i+"%, "+t.defaultColor+" 100%)",a.innerText=e},t.prototype.reset=function(){this.setProgress(this._opt.cur)},e.range=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=function(e){var t={element:null,min:0,max:100,from:null,to:null,step:1,currentColor:"#11dab7",defaultColor:"#999",change:null};this._opt=Object.assign(t,e),this._opt.from=this._opt.from||this._opt.min,this._opt.to=this._opt.to||this._opt.max,this.init()};t.prototype={init:function(){var t=e.create("div","bf-multiple-range"),n=e.create("div","bf-range-track"),o=e.create("span","bf-slider bf-slider-min");o.id="minSlider",o.type="minimum";var a=e.create("span","bf-slider bf-slider-max");a.id="maxSlider",a.type="maximum",this._state={from:this._opt.from,to:this._opt.to},n.style.backgroundColor=this._opt.currentColor,t.style.backgroundColor=this._opt.defaultColor,t.appendChild(n),t.appendChild(o),t.appendChild(a),this._opt.element.appendChild(t),this._track=n,this._sliders={min:o,max:a},this._element=t,this.bindEvent(),this.update(!1)},bindEvent:function(){var e,t,n=this,o=!1,a=function(n){var n=n||event;t=n.screenX,e=this,o=!0},i=function(a){if(o){var a=a||event,i=a.screenX-t,r=Math.round(i/n._pix/n._opt.step)*n._opt.step;0!=r&&(t=r*n._pix+t,"minimum"==e.type?n._state.from+=r:n._state.to+=r,n.recalculate(e),n.update(!0))}},r=function(){e=null,o=!1};this._sliders.min.addEventListener("mousedown",a),this._sliders.max.addEventListener("mousedown",a),document.addEventListener("mousemove",i),document.addEventListener("mouseup",r)},update:function(e){var t=this._sliders.min.offsetWidth,n=this._sliders.max.offsetWidth;if(!this._pix){var o=this._element.offsetWidth,a=this._opt.max-this._opt.min,i=(o-t-n)/a;this._pix=i}var r=(this._state.from-this._opt.min)*this._pix,l=(this._state.to-this._opt.min)*this._pix+t+n;this._track.style.left=r+t/2+"px",this._track.style.width=l-r-t/2-n/2+"px",this._sliders.min.style.left=r+"px",this._sliders.max.style.left=l+"px",this._opt.change&&e&&this._opt.change(this._state)},recalculate:function(e){this._state.to>=this._opt.max&&(this._state.to=this._opt.max),this._state.from<=this._opt.min&&(this._state.from=this._opt.min),e&&("maximum"==e.type&&this._state.to<=this._state.from&&(this._state.to=this._state.from),"minimum"==e.type&&this._state.from>=this._state.to&&(this._state.from=this._state.to))},getProgress:function(){return this._state},setProgress:function(e){this._state=e,this.recalculate(),this.update(!1)}},e.multipleRange=t}(),function(){var e=function(e){var t,n;this.addEventListener("touchstart",function(e){t=Date.now()}),this.addEventListener("touchend",function(o){(n=Date.now())-t<200&&e(o)})};HTMLElement.prototype.tap=e}(),function(){(window.ActiveXObject||"ActiveXObject"in window)&&(HTMLElement.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)},window.Element&&function(e){e.matches=e.matches||e.matchesSelector||e.webkitMatchesSelector||e.msMatchesSelector||function(e){for(var t=this,n=(t.parentNode||t.document).querySelectorAll(e),o=-1;n[++o]&&n[o]!=t;);return!!n[o]}}(Element.prototype),window.Element&&function(e){e.closest=e.closest||function(e){for(var t=this;t.matches&&!t.matches(e);)t=t.parentNode;return t.matches?t:null}}(Element.prototype))}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.UUID"),t=function(){for(var e=[],t="0123456789abcdef",n=0;n<36;n++)e[n]=t.substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.join("")};e.createUUID=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),t=function(e,t){var n=null,o=Date.now();return void 0==t&&(t=30),function(){var a=Date.now(),i=t-(a-o),r=this,l=arguments;clearTimeout(n),i<=0?(e.apply(r,l),o=Date.now()):n=setTimeout(e,i)}};e.throttle=t}(),function(){Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility").DataUtil={assertType:function(e,t){var n=function(t){return Object.prototype.toString.call(e)==="[object "+t+"]"};switch(t){case"obj":case"Obj":case"object":case"Object":return n("Object");case"arr":case"Arr":case"array":case"Array":return n("Array");case"num":case"Num":case"number":case"Number":return n("Number");case"func":case"Func":case"function":case"Function":return n("Function");case"str":case"Str":case"string":case"String":return n("String");default:return n(t)}},assertParamsType:function(){for(var e=this,t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];if(n.length>1){var a=n.splice(n.length-1,1),i=_slicedToArray(a,1),r=i[0],l=!0;return n.every(function(t){return l=e.assertType(t,r)}),l}},hasProperty:function(e,t){if(this.assertType(e,"obj"))return void 0!==e[t]}}}(),function(){Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Utils").Transformation={getTranslation:function(e){var t=this._getDecompose(e);return{x:t.position.x,y:t.position.y,z:t.position.z}},getQuaternion:function(e){var t=this._getDecompose(e);return{x:t.quaternion._x,y:t.quaternion._y,z:t.quaternion._z,w:t.quaternion._w}},getScaling:function(e){var t=this._getDecompose(e);return{x:t.scale.x,y:t.scale.y,z:t.scale.z}},quaternionToEulerAngles:function(e,t){var n=new THREE.Euler,o=new THREE.Quaternion(e.x,e.y,e.z,e.w),a=n.setFromQuaternion(o,t||"XYZ");return{x:a._x,y:a._y,z:a._z,order:a._order}},eulerAnglesToQuaternion:function(e){var t=new THREE.Quaternion,n=new THREE.Euler(e.x,e.y,e.z,e.order),o=t.setFromEuler(n);return{x:o._x,y:o._y,z:o._z,w:o._w}},_getDecompose:function(e){var t=new THREE.Matrix4,n=new THREE.Vector3,o=new THREE.Quaternion,a=new THREE.Vector3;return t.fromArray(e),t.decompose(n,o,a),{position:n,quaternion:o,scale:a}}}}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang"),t=function(){this.container={}};t.prototype.addEvent=function(e,t){return"string"==typeof e&&"function"==typeof t&&(void 0===this.container[e]?this.container[e]=[t]:this.container[e].push(t)),this},t.prototype.fireEvent=function(e){if(e&&this.container[e]){
var t=Array.prototype.slice.call(arguments);t.shift();for(var n=[].concat(_toConsumableArray(this.container[e])),o=n.length,a=0;a<o;a++){n[a].apply(null,t)}}return this},t.prototype.removeEvent=function(e,t){if("function"==typeof t&&"string"==typeof e){var n=this.container[e];if(n instanceof Array){for(var o=0,a=n.length;o<a;o+=1)if(n[o]===t){n.splice(o,1);break}0==n.length&&delete this.container[e]}return this}},e.EventManager=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Geometry"),t=function(e,t,n){this.x=e,this.y=t,this.z=n};t.prototype={get:function(){return{x:this.x,y:this.y,z:this.z}},set:function(e,t,n){this.x=e,this.y=t,this.z=n}},e.Point3d=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Geometry"),t=function(t,n){var o={},a=new e.Point3d,i=new e.Point3d;return a.set(t.x,t.y,t.z),i.set(n.x,n.y,n.z),o.min=a,o.max=i,o};e.BoundingBox=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Graphics.Utility"),t=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t};e.RGBToHex=t}(),!hostConfig)var hostConfig={APIHost:"https://api.bimface.com",resourceHost:"https://m.bimface.com",staticHost:"https://static.bimface.com",dataEnvType:"BIMFACE"};!function(){function e(e,t){function n(e){return"FloorPlan"==e||"CeilingPlan"==e}if("DrawingSheet"!=t.viewType)return null;var o=t.viewInfo,a=o.preview.width,i=o.preview.height,r=o.outline[0],l=o.outline[2],s=o.outline[1],d=o.outline[3],c=l-r,u=d-s;o=t;for(var p=o.portsAndViews,f=0;f<p.length;f++){var h=p[f];if(n(h.viewType)){var m=function(t,n,o,l,d){var p=e.x/a,f=(i-e.y)/i;if("Elevation"==d.viewType){f=(a-e.x)/a,p=e.y/i;var h=d.viewPoint.viewDirection;1!=Math.round(h[0])&&-1!=Math.round(h[1])||(p=(i-e.y)/i)}var m=(t-r)/c,g=(n-r)/c;if(p<m||p>g)return null;var v=(o-s)/u,b=(l-s)/u;if(f<v||f>b)return null;var y=(p-m)/(g-m),w=(f-v)/(b-v),C=((d.outline[2]-d.outline[0])*y+d.outline[0])*d.viewPoint.scale,M=((d.outline[3]-d.outline[1])*w+d.outline[1])*d.viewPoint.scale;return new THREE.Vector3(C,M,0)}(h.viewport[0],h.viewport[3],h.viewport[1],h.viewport[4],h);if(null!=m){if(n(h.viewType))null!==m&&(m.z=h.elevation);else if("Elevation"==h.viewType){var g=h.viewPoint.viewDirection,v=h.cropBox;0!=Math.round(g[0])?null!==m&&(m.z=m.y,m.y=m.x,m.x=g[0]<0?v[3]:v[0]):0!=Math.round(g[1])&&null!==m&&(m.z=m.y,m.y=g[1]<0?v[4]:v[1])}return m}}}return null}function t(e,t,n){if("DrawingSheet"!=t.viewType)return!1;var o=t.preview.width,a=t.preview.height,i=t.outline[0],r=t.outline[2],l=t.outline[1],s=t.outline[3],d=t.portsAndViews;for(var c in d){var u=d[c];if("FloorPlan"===u.viewType){var p=u.viewPoint.scale,f=u.outline[0]*p,h=u.outline[2]*p,m=u.outline[1]*p,g=u.outline[3]*p;if(!(e.x<f||e.x>h||e.y<m||e.y>g)){var v=(e.x-f)/(h-f),b=(e.y-m)/(g-m),y=u.viewport[3]-u.viewport[0],w=u.viewport[4]-u.viewport[1];n(o*((u.viewport[0]+y*v-i)/(r-i)),a-a*((u.viewport[1]+w*b-l)/(s-l)),u)}}}return!0}var n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Graphics.Utility.Relation"),o=function(e,t,n){Glodon.Web.Lang.Utility.HttpRequest.ajax({url:hostConfig.resourceHost+"/"+e+"/metadata/views.json",success:function(o){var a=JSON.parse(o).viewList,o=[];for(var i in a){var r=a[i];r.viewType==t&&(r.preview.path=hostConfig.resourceHost+"/"+e+"/"+r.preview.path,o.push(r))}n&&n(o)}})},a=function(e,t,n){Glodon.Web.Lang.Utility.HttpRequest.ajax({url:hostConfig.resourceHost+"/"+e+"/metadata/drawings.json",success:function(e){for(var o=JSON.parse(e).drawingList,a=0;a<o.length;a++){var i=o[a];if(i.viewInfo.id==t){n&&n(i);break}}}})},i=function(t,n){if("DrawingSheet"==n.viewType)return e(t,n);if("FloorPlan"!=n.viewType)return console.warn("Not support yet!"),null;var o=n.preview.width,a=n.preview.height,i=n.outline[0],r=n.outline[2],l=n.outline[1],s=n.outline[3],d=r-i,c=s-l,u=(0-i)/d,p=s/c,f=(t.x-o*u)/o,h=(a*p-t.y)/a;return f=f*d*n.viewPoint.scale,h=h*c*n.viewPoint.scale,new Glodon.Web.Geometry.Point3d(f,h,n.elevation)},r=function(e,n){var o=[];if(t(e,n,function(e,t,n){o.append({x:e,y:t})}))return 0==o.length?null:o;if("FloorPlan"!=n.viewType)return console.warn("Not support yet!"),null;var a=n.preview.width,i=n.preview.height,r=n.outline[0],l=n.outline[2],s=n.outline[1],d=n.outline[3],c=l-r,u=d-s,p=(0-r)/(l-r),f=d/(d-s),h=e.x/(c*n.viewPoint.scale),m=e.y/(u*n.viewPoint.scale);return h=h*a+a*p,m=i*f-m*i,{x:h,y:m,z:0}};n.getViews=o,n.getDrawingSheets=a,n.point2DToPoint3D=i,n.point3DToPoint2D=r}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Graphics.Utility"),t=function(e){var t=new Image;return new Promise(function(n,o){t.onload=function(){n(t)},t.onerror=function(e){o(e)},t.crossOrigin="anonymous",t.src=e,!0===t.complete&&n(t)})};e.ImageContainer=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Graphics"),t=Glodon.Web.Graphics.Utility.RGBToHex,n=function(e,t,n,o){this.red=e,this.green=t,this.blue=n,this.alpha=o},o=function(e,t){/^#[0-9a-fA-F]{6}$/.test(e)&&(this.red=parseInt(e.slice(1,3),16),this.green=parseInt(e.slice(3,5),16),this.blue=parseInt(e.slice(5),16)),"number"==typeof t?(t>1&&(t=1),t<0&&(t=0),this.alpha=t):this.alpha=1},a=function(){arguments.length<4?o.apply(this,arguments):n.apply(this,arguments)};a.prototype={getRGB:function(){return"rgba("+this.red+","+this.green+","+this.blue+")"},getRGBA:function(){return"rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")"},getHEX:function(){return""+t(this.red)+t(this.green)+t(this.blue)},getAlpha:function(){return this.alpha},fromObject:function(e){return this.red=e.red,this.green=e.green,this.blue=e.blue,this.alpha=e.alpha,this}},e.Color=a}(),function(){SVGElement.prototype.getClass=HTMLElement.prototype.getClass=function(e){return this.getAttribute("class")},SVGElement.prototype.hasClass=HTMLElement.prototype.hasClass=function(e){var t=this.getClass();return!!t&&(t&&t.split(" ")).indexOf(e)>-1},SVGElement.prototype.addClass=HTMLElement.prototype.addClass=function(e){var t=this.getClass(),n=t&&t.split(" ");return t?-1==n.indexOf(e)&&(n.push(e),t=n.join(" "),this.setAttribute("class",""+t)):this.setAttribute("class",""+e),this},SVGElement.prototype.removeClass=HTMLElement.prototype.removeClass=function(e){if(!this.hasClass(e))return this;var t=this.getClass().replace(e,"").trim();return t?this.setAttribute("class",""+t):this.removeAttribute("class"),this},SVGElement.prototype.toggleClass=HTMLElement.prototype.toggleClass=function(e,t){var n=(this.getClass(),this.hasClass(e));return void 0!=t?(t&&!n&&this.addClass(e),t||this.removeClass(e)):n?this.removeClass(e):this.addClass(e),!n}}(),function(){Array.prototype.getObjectByAttribute=function(e,t){for(var n=this,o=n.length,a=0;a<o;a++)if(n[a][e]==t)return n[a];return!1},Array.prototype.removeObjectByAttribute=function(e,t){for(var n=this,o=n.length,a=0;a<o;a++)if(n[a][e]==t)return n=n.splice(a,1);return!1},Array.prototype.getAllObjectByAttribute=function(e,t){for(var n=this,o=n.length,a=0,i=[];a<o;a++)n[a][e]==t&&i.push(n[a]);return i},Array.prototype.removeByValue=function(e){for(var t=this,n=t.length,o=n-1;o>=0;o--)t[o]==e&&t.splice(o,1);return t},Array.prototype.insert=function(e,t){return this.splice(e,0,t),this}}(),function(){SVGElement.prototype.setCss=HTMLElement.prototype.setCss=function(e){if(e)for(var t in e)this.style[t]=e[t]},SVGElement.prototype.getCss=HTMLElement.prototype.getCss=function(){return this.style}}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Data"),t=(Glodon.Web.Lang.Utility.HttpRequest,null),n={getInstance:function(){return null==t&&(t={},t.sendingPeriod=6e4,t.requestList=[],t.isEnabled=!0,t.modelType="",t.modelId="",t.handleId=null,t.send=function(e,n,o){if(t.isEnabled){var a={functionName:e+"."+n},i=Object.assign(a,o);this.requestList.push(i)}},t.intervalAction=function(){if(t.isEnabled){var e=t.requestList,n=e.length;if(n>0){var o=e.slice(0,n);t._send(o),e.splice(0,n)}}},t.handleId=setInterval(t.intervalAction,t.sendingPeriod),t._send=function(e){var t="https://api.bimface.com/inside/track?ModelType="+this.modelType+"&ModelId="+this.modelId,n={Events:e},o={"Content-Type":"application/json"};fetch(t,{method:"PUT",mode:"cors",body:JSON.stringify(n),headers:o,cache:"default"}).then(function(e){})},t.setIsEnabled=function(e){t.isEnabled=!0===e,t.isEnabled&&null===t.handleId?t.handleId=setInterval(t.intervalAction,t.sendingPeriod):t.isEnabled||null===t.handleId||(clearInterval(t.handleId),t.handleId=null)},t.getIsEnabled=function(){return t.isEnabled}),t}};e.StatisticsDataManager=n}(),function(e){function t(){r||(r=!0,a())}
var n,o,a,i,r,l,s='<svg><symbol id="gld-bf-reverse-lg" viewBox="0 0 1024 1024"><path d="M128 128h192v32H160v160H128V128z m0 736h192v-32H160v-160H128v192zM864 128h-192v32h160v160h32V128z m0 736h-192v-32h160v-160h32v192zM566.016 332.48l19.968-24.96L768 448H256v-32h420.768zM457.984 659.52l-19.968 24.96L256 544h512v32H347.232z"  ></path></symbol><symbol id="gld-bf-section-plane-pick" viewBox="0 0 1024 1024"><path d="M512 416l336 208-112 64 96 160-96 64-96-160-128 80V416z m32 57.44v300.832l106.688-66.688 95.456 159.136 42.688-28.448-97.088-161.824 93.632-53.568L544 473.44z"  ></path><path d="M640 96v288h-32V156.384L288 362.016V781.76l128-82.272v38.88l-160 103.776V345.056L640 96z"  ></path></symbol><symbol id="gld-bf-split-drawings" viewBox="0 0 1024 1024"><path d="M896 384v448H320V384h576z m-160 32H352v384h384V416z m128 192h-96v192h96v-192zM736 224v96h-32V256H192v384h64v32H160V224h576z m128 288h-96v64h96v-64z m0-96h-96v64h96v-64z"  ></path></symbol><symbol id="gld-bf-export" viewBox="0 0 1024 1024"><path d="M384 64v64H128v768h768v-256h64v320H64V64h320z m576 0v384h-64V173.184l-480 480.064-45.248-45.248L850.56 128H576V64h384z"  ></path></symbol><symbol id="gld-bf-arrowup" viewBox="0 0 1024 1024"><path d="M937.642667 707.157333L511.317333 281.173333 450.730667 341.333333 85.333333 707.072l60.16 60.330667L511.317333 401.92l365.994667 365.482667z"  ></path></symbol><symbol id="gld-bf-arrowdown" viewBox="0 0 1024 1024"><path d="M937.642667 316.842667L511.317333 742.826667 450.730667 682.666667 85.333333 316.928l60.16-60.330667L511.317333 622.08l365.994667-365.482667z"  ></path></symbol><symbol id="gld-bf-search" viewBox="0 0 1024 1024"><path d="M447.99808 128c75.328 0 148.544 26.688 206.144 75.2a318.976 318.976 0 0 1 98.944 341.568 318.72 318.72 0 0 1-304.896 223.36c-32.64 0-65.216-5.056-96.768-15.04a319.04 319.04 0 0 1-222.144-277.632 319.04 319.04 0 0 1 171.456-311.552c45.504-23.552 96-35.84 147.264-35.904z m0-128A447.872 447.872 0 0 0 1.72608 486.4 448 448 0 1 0 447.99808 0z"  ></path><path d="M750.27008 843.008l90.496-90.496 180.992 180.992L931.26208 1024z"  ></path></symbol><symbol id="gld-bf-translation" viewBox="0 0 1056 1024"><path d="M512 576v160h96l-112 128-112-128h96v-160h32z m224-192l128 112-128 112v-96.032L576 512v-32l160-0.032V384zM256 384v96h160v32H256v96l-128-112L256 384z m240-256L608 256h-96v160h-32V256h-96l112-128z" fill="#000000" ></path></symbol><symbol id="gld-bf-rotation" viewBox="0 0 1056 1024"><path d="M480 192h32v352h-32V192z m0 544h32v128h-32v-128zM672 500L832 480l-14.176 160z" fill="#000000" ></path><path d="M482.976 655.968c-184.384 0-336-83.392-336-192 0-97.344 122.24-175.36 282.944-189.664l9.888-0.8 2.304 31.904c-150.976 10.912-263.136 80.704-263.136 158.56 0 85.76 134.944 160 304 160 64.096 0 125.184-10.688 176.384-30.208 46.08-17.6 82.208-41.6 104.032-68.8l4.48-5.92 26.016 18.624c-25.248 35.328-68.288 65.088-123.136 85.984-54.944 20.96-119.872 32.32-187.776 32.32z" fill="#000000" ></path></symbol><symbol id="gld-bf-scaling" viewBox="0 0 1056 1024"><path d="M480 544v320H160V544h320z m-32 32H192v256h256v-256zM836.672 164.672l22.656 22.656-224 224-22.656-22.656zM160 480h32V192h352V160H160zM544 832h288V480h32v384H544z" fill="#000000" ></path><path d="M672 160h192v192h-32V192h-160z" fill="#000000" ></path></symbol><symbol id="gld-bf-room-height" viewBox="0 0 1024 1024"><path d="M896 768v32H96v-32h800zM496 256l112 128h-96v256h96l-112 128-112-128h96v-256h-96l112-128zM896 224v32H96V224h800z"  ></path></symbol><symbol id="gld-bf-next" viewBox="0 0 1024 1024"><path d="M404.64 692.704l169.28-169.44-169.28-169.408 22.656-22.592 169.28 169.28 0.064-0.032 22.624 22.72-192 192.128z"  ></path></symbol><symbol id="gld-bf-previous" viewBox="0 0 1024 1024"><path d="M619.264 692.704l-169.28-169.44 169.28-169.408-22.656-22.592-169.28 169.28-0.064-0.032-22.624 22.72 192 192.128z"  ></path></symbol><symbol id="gld-bf-drag" viewBox="0 0 1024 1024"><path d="M608 192a64 64 0 0 1 63.84 59.2L672 256v192h-32V256a32 32 0 0 0-63.776-3.744L576 256h-32a64 64 0 0 1 64-64zM416 192a64 64 0 0 1 63.84 59.2L480 256v192h-32V256a32 32 0 0 0-63.776-3.744L384 256v192h-32V256a64 64 0 0 1 64-64z"  ></path><path d="M320 384a64 64 0 0 1 63.84 59.2L384 448v160h-32v-160a32 32 0 0 0-63.776-3.744L288 448v160H256v-160a64 64 0 0 1 64-64zM704 272a64 64 0 0 1 63.84 59.2l0.16 4.8V608h-32v-272a32 32 0 0 0-63.776-3.744L672 336h-32a64 64 0 0 1 64-64zM512 864a256 256 0 0 0 255.872-248L768 608h-32a224 224 0 0 1-447.872 7.68L288 608H256a256 256 0 0 0 256 256zM512 128a64 64 0 0 1 63.84 59.2L576 192v256h-32V192a32 32 0 0 0-63.776-3.744L480 192v80h-32V192a64 64 0 0 1 64-64z"  ></path></symbol><symbol id="gld-bf-zoom-out" viewBox="0 0 1024 1024"><path d="M480 160a288 288 0 1 0 0 576 288 288 0 0 0 0-576z m0 32a256 256 0 1 1 0 512 256 256 0 0 1 0-512z"  ></path><path d="M640 416H320v64h320z"  ></path><path d="M651.328 660.672l-22.656 22.656 176 176 22.656-22.656z"  ></path></symbol><symbol id="gld-bf-zoom-in" viewBox="0 0 1024 1024"><path d="M480 160a288 288 0 1 0 0 576 288 288 0 0 0 0-576z m0 32a256 256 0 1 1 0 512 256 256 0 0 1 0-512z"  ></path><path d="M640 416H320v64h320z"  ></path><path d="M448 288v320h64V288z"  ></path><path d="M651.328 660.672l-22.656 22.656 176 176 22.656-22.656z"  ></path></symbol><symbol id="gld-bf-full-screen" viewBox="0 0 1024 1024"><path d="M608 192v32h169.6l-227.2 227.2 22.4 22.4L800 246.4V416h32V192h-224z m-156.8 358.4L224 777.6V608H192v224h224v-32H246.4l227.2-227.2-22.4-22.4z"  ></path><path d="M896 128v768H128V128h768m32-32H96v832h832V96z"  ></path></symbol><symbol id="gld-bf-measure-settings" viewBox="0 0 1024 1024"><path d="M607.744 193.28a318.208 318.208 0 0 1 116.8 65.76c9.728 8.544 12.16 22.656 5.888 33.92-6.048 10.88-9.184 23.136-9.152 35.552a74.752 74.752 0 0 0 74.88 74.432 27.84 27.84 0 0 1 27.488 21.28 316.096 316.096 0 0 1 1.696 136.768 27.68 27.68 0 0 1-24.32 21.856l-4.832 0.128a74.816 74.816 0 0 0-65.408 38.08 73.92 73.92 0 0 0 1.664 75.296 27.584 27.584 0 0 1-4.8 35.04 318.4 318.4 0 0 1-115.584 67.2 27.744 27.744 0 0 1-33.44-13.664A75.008 75.008 0 0 0 512 744.512c-28.096 0-53.792 15.584-66.656 40.416a27.776 27.776 0 0 1-33.376 13.664 322.464 322.464 0 0 1-118.88-70.24 27.36 27.36 0 0 1-5.056-33.888 74.048 74.048 0 0 0-0.128-74.368 74.944 74.944 0 0 0-64.864-37.12l-19.168 0.864-3.584-15.36a316.8 316.8 0 0 1 0.064-144.288 27.776 27.776 0 0 1 23.872-21.12l3.52-0.16a74.784 74.784 0 0 0 74.976-74.4 72.864 72.864 0 0 0-9.152-35.52 27.392 27.392 0 0 1 5.92-33.952 318.208 318.208 0 0 1 116.736-65.792 27.904 27.904 0 0 1 32 11.936A74.944 74.944 0 0 0 512 240.608c26.016 0 50.144-13.44 63.744-35.424a27.904 27.904 0 0 1 32-11.936z m-6.624 31.488l-1.728 2.656A106.976 106.976 0 0 1 512 272.608c-34.88 0-67.456-16.96-87.36-45.184l-1.792-2.656-8.672 2.912A286.336 286.336 0 0 0 329.888 275.2l-6.624 5.568 1.76 3.52c5.344 11.52 8.544 23.968 9.44 36.64l0.256 7.616a106.784 106.784 0 0 1-101.44 106.208l-2.496 0.064-1.76 8.352a284.8 284.8 0 0 0-0.032 106.4l0.32 1.568h0.416c33.28 2.08 63.744 19.52 82.24 47.168l3.584 5.664c17.952 30.848 19.168 68.48 3.488 100.352l-1.6 2.912 5.952 5.312a290.464 290.464 0 0 0 87.776 51.84l7.52 2.656 1.472-2.592a107.008 107.008 0 0 1 85.216-51.744l6.624-0.192c37.792 0 72.64 19.84 91.904 52.032l1.376 2.528 8.32-2.88a286.368 286.368 0 0 0 83.328-48.48l6.496-5.664-1.76-3.072a105.92 105.92 0 0 1-2.08-95.232l3.296-6.4a106.752 106.752 0 0 1 86.528-54.144l5.216-0.192 1.664-8.768a283.968 283.968 0 0 0-1.216-98.464l-1.888-8.928-3.072-0.096a106.752 106.752 0 0 1-100.672-100.128l-0.16-6.016a104.832 104.832 0 0 1 9.696-44.352l1.76-3.456-6.72-5.664a286.208 286.208 0 0 0-84.16-47.456l-8.736-2.912z m-92 127.264l6.976 0.032a128 128 0 1 1-8.192 255.872 128 128 0 0 1 8.192-255.872z m5.952 32a96 96 0 1 0-6.144 191.904 96 96 0 0 0 6.144-191.872z"  ></path></symbol><symbol id="gld-bf-scene-front" viewBox="0 0 1024 1024"><path d="M608 416v352H256V416h352m32-32H224v416h416V384z" fill="#FFFFFF" ></path><path d="M768 256v352H416V256h352m32-32H384v416h416V224z" fill="#FFFFFF" ></path><path d="M768 256v371.2L627.2 768H256V396.8L396.8 256H768m32-32H384l-160 160v416h416l160-160V224z" fill="#FFFFFF" ></path><path d="M755.2 256l-128 128H268.8l128-128h358.4M800 224H384l-160 160v32h416l160-160V224zM755.2 640l-128 128H268.8l128-128h358.4m44.8-32H384l-160 160v32h416l160-160v-32z" fill="#FFFFFF" ></path><path d="M256 416h352v352H256z" fill="#FFFFFF" fill-opacity=".65" ></path></symbol><symbol id="gld-bf-scene-back" viewBox="0 0 1024 1024"><path d="M416 256h352v352H416z" fill="#FFFFFF" fill-opacity=".65" ></path><path d="M608 416v352H256V416h352m32-32H224v416h416V384z" fill="#FFFFFF" ></path><path d="M768 256v352H416V256h352m32-32H384v416h416V224z" fill="#FFFFFF" ></path><path d="M768 256v371.2L627.2 768H256V396.8L396.8 256H768m32-32H384l-160 160v416h416l160-160V224z" fill="#FFFFFF" ></path><path d="M755.2 256l-128 128H268.8l128-128h358.4M800 224H384l-160 160v32h416l160-160V224zM755.2 640l-128 128H268.8l128-128h358.4m44.8-32H384l-160 160v32h416l160-160v-32z" fill="#FFFFFF" ></path></symbol><symbol id="gld-bf-scene-left" viewBox="0 0 1024 1024"><path d="M224 384l160-160v384l-160 160z" fill="#FFFFFF" fill-opacity=".65" ></path><path d="M608 416v352H256V416h352m32-32H224v416h416V384z" fill="#FFFFFF" ></path><path d="M768 256v352H416V256h352m32-32H384v416h416V224z" fill="#FFFFFF" ></path><path d="M768 256v371.2L627.2 768H256V396.8L396.8 256H768m32-32H384l-160 160v416h416l160-160V224z" fill="#FFFFFF" ></path><path d="M755.2 256l-128 128H268.8l128-128h358.4M800 224H384l-160 160v32h416l160-160V224zM755.2 640l-128 128H268.8l128-128h358.4m44.8-32H384l-160 160v32h416l160-160v-32z" fill="#FFFFFF" ></path></symbol><symbol id="gld-bf-scene-right" viewBox="0 0 1024 1024"><path d="M608 416v352H256V416h352m32-32H224v416h416V384z" fill="#FFFFFF" ></path><path d="M768 256v352H416V256h352m32-32H384v416h416V224z" fill="#FFFFFF" ></path><path d="M755.2 256l-128 128H268.8l128-128h358.4M800 224H384l-160 160v32h416l160-160V224zM755.2 640l-128 128H268.8l128-128h358.4m44.8-32H384l-160 160v32h416l160-160v-32z" fill="#FFFFFF" ></path><path d="M640 416l128-128v339.2l-128 128z" fill="#FFFFFF" fill-opacity=".6" ></path></symbol><symbol id="gld-bf-scene-top" viewBox="0 0 1024 1024"><path d="M608 416v352H256V416h352m32-32H224v416h416V384z" fill="#FFFFFF" ></path><path d="M768 256v352H416V256h352m32-32H384v416h416V224z" fill="#FFFFFF" ></path><path d="M755.2 256l-128 128H268.8l128-128h358.4M800 224H384l-160 160v32h416l160-160V224zM755.2 640l-128 128H268.8l128-128h358.4m44.8-32H384l-160 160v32h416l160-160v-32z" fill="#FFFFFF" ></path><path d="M268.8 384l128-128h358.4l-128 128z" fill="#FFFFFF" fill-opacity=".65" ></path></symbol><symbol id="gld-bf-scene-bottom" viewBox="0 0 1024 1024"><path d="M640 768l160-160H416l-160 160z" fill="#FFFFFF" fill-opacity=".65" ></path><path d="M608 416v352H256V416h352m32-32H224v416h416V384z" fill="#FFFFFF" ></path><path d="M768 256v352H416V256h352m32-32H384v416h416V224z" fill="#FFFFFF" ></path><path d="M768 256v371.2L627.2 768H256V396.8L396.8 256H768m32-32H384l-160 160v416h416l160-160V224z" fill="#FFFFFF" ></path><path d="M755.2 256l-128 128H268.8l128-128h358.4M800 224H384l-160 160v32h416l160-160V224zM755.2 640l-128 128H268.8l128-128h358.4m44.8-32H384l-160 160v32h416l160-160v-32z" fill="#FFFFFF" ></path></symbol><symbol id="gld-bf-scene" viewBox="0 0 1024 1024"><path d="M608 416v352H256V416h352m32-32H224v416h416V384z" fill="#333333" ></path><path d="M768 256v352H416V256h352m32-32H384v416h416V224z" fill="#333333" ></path><path d="M768 256v371.2L627.2 768H256V396.8L396.8 256H768m32-32H384l-160 160v416h416l160-160V224z" fill="#333333" ></path><path d="M755.2 256l-128 128H268.8l128-128h358.4M800 224H384l-160 160v32h416l160-160V224zM755.2 640l-128 128H268.8l128-128h358.4m44.8-32H384l-160 160v32h416l160-160v-32z" fill="#333333" ></path></symbol><symbol id="gld-bf-arrow-right" viewBox="0 0 1024 1024"><path d="M538.624 466.176L150.698667 853.248l60.245333 60.416 449.024-448L210.432 25.002667l-59.733333 60.928z"  ></path><path d="M879.957333 466.176L492.032 853.248l60.245333 60.416 449.024-448L551.765333 25.002667l-59.733333 60.928z"  ></path></symbol><symbol id="gld-bf-BIMFACE-logo" viewBox="0 0 6963 1024"><path d="M13.23008 23.3472l172.2368 172.2368V23.3472zM0 208.81408h172.19584L0 36.61824zM202.01472 23.3472v172.2368L374.21056 23.3472zM387.4816 208.81408V36.61824L215.2448 208.81408zM417.30048 23.3472l172.19584 172.2368V23.3472zM404.02944 36.61824v172.19584h172.2368zM606.04416 23.3472v172.2368L778.28096 23.3472zM791.51104 208.81408V36.61824L619.3152 208.81408zM821.32992 23.3472l172.19584 172.2368V23.3472zM808.05888 36.61824v172.19584h172.2368zM1010.0736 36.61824v172.19584h172.2368zM1023.34464 225.40288l172.19584 172.19584V225.40288zM1010.0736 238.63296v172.19584h172.2368zM1109.44256 513.51552l86.09792-86.09792h-172.19584zM1010.0736 440.64768v172.19584h172.2368zM1010.0736 629.43232v172.19584l172.2368-172.19584zM1195.54048 814.85824V642.6624l-172.19584 172.19584zM1010.0736 831.44704v172.19584l172.2368-172.19584zM808.05888 831.44704v172.19584l172.2368-172.19584zM821.32992 1016.91392h172.19584v-172.2368zM619.3152 831.44704l172.19584 172.19584V831.488zM606.04416 1016.91392h172.2368l-172.2368-172.2368zM404.02944 831.44704v172.19584L576.3072 831.488zM417.30048 1016.91392h172.19584v-172.2368zM808.05888 427.4176v172.19584l172.2368-172.19584zM993.52576 612.84352v-172.19584l-172.19584 172.19584zM791.51104 599.6544v-172.2368H619.3152zM606.04416 440.64768v172.19584h172.2368zM404.02944 427.4176v172.19584l172.2368-172.19584zM589.49632 612.84352v-172.19584l-172.19584 172.19584zM0 225.36192v172.2368l172.19584-172.2368zM13.23008 410.8288h172.2368V238.63296zM13.23008 427.37664l172.2368 172.2368v-172.2368zM0 612.84352h172.19584L0 440.64768zM0 629.43232v172.19584l172.19584-172.19584zM13.23008 814.85824h172.2368V642.6624zM13.23008 831.44704l172.2368 172.19584V831.488zM0 1016.91392h172.19584L0 844.67712zM1314.77504 23.3472l172.19584 172.2368V23.3472zM1301.54496 208.81408h172.19584L1301.54496 36.61824zM1473.7408 225.40288l-172.19584 172.19584V225.40288zM1486.97088 410.8288H1314.816l172.19584-172.19584zM1314.77504 427.4176l172.19584 172.19584v-172.19584zM1301.54496 612.84352h172.19584l-172.19584-172.19584zM1473.7408 629.43232l-172.19584 172.19584v-172.19584zM1486.97088 814.8992H1314.816l172.19584-172.2368zM1314.77504 831.44704l172.19584 172.19584V831.488zM1301.54496 1016.91392h172.19584l-172.19584-172.2368zM1606.20544 23.3472l172.2368 172.2368 110.592-172.19584zM2099.32288 523.4688l175.39072 175.39072 112.72192-175.43168zM2389.4016 559.88224l-102.52288 159.58016h215.08096l-102.52288-159.58016-4.99712-7.7824M1592.9344 36.61824v172.19584h172.2368zM1592.9344 225.40288v172.19584l172.2368-172.19584zM2083.10272 506.88V225.40288h-281.47712zM1794.99008 208.81408h288.11264L1909.18656 38.2976zM2099.69152 225.40288v282.17344h282.13248zM1778.44224 410.8288V238.63296l-172.2368 172.19584zM1778.44224 599.6544v-172.2368h-172.2368zM1592.9344 440.64768v172.19584h172.2368zM1592.9344 629.43232v172.19584l172.2368-172.19584zM1778.44224 814.85824V642.6624l-172.2368 172.19584zM1606.20544 831.44704l172.2368 172.19584V831.488zM1592.9344 1016.91392h172.2368l-172.19584-172.2368zM2899.7632 23.3472l110.63296 172.2368L3182.592 23.3472zM2514.1248 698.85952l175.39072-175.39072h-288.11264zM3023.6672 208.81408h172.19584V36.61824zM3195.86304 397.59872V225.40288H3023.6672zM2705.73568 506.88l281.47712-281.47712h-281.47712zM2705.73568 208.81408h288.11264L2879.65184 38.2976zM2689.14688 225.40288l-282.13248 282.17344h282.13248zM3010.39616 238.63296v172.19584H3182.592zM3010.39616 599.6544l172.19584-172.2368h-172.19584zM3195.86304 612.84352v-172.19584l-172.19584 172.19584zM3195.86304 801.62816v-172.19584H3023.6672zM3182.592 814.85824l-172.19584-172.19584v172.19584zM3010.39616 831.44704v172.19584L3182.592 831.488zM3023.6672 1016.91392h172.19584v-172.2368zM4172.84096 530.06336c0 27.4432-22.24128 49.68448-49.68448 49.68448M4123.15648 480.37888c27.4432 0 49.68448 22.24128 49.68448 49.68448M6010.88 917.54496H5504.2048a139.10016 139.10016 0 0 1-139.10016-139.10016V261.81632a139.10016 139.10016 0 0 1 139.10016-139.10016v0.08192l457.03168-0.08192h49.68448a49.68448 49.68448 0 0 0 0-99.36896H5504.2048a238.46912 238.46912 0 0 0-238.46912 238.46912v516.62848a238.46912 238.46912 0 0 0 238.46912 238.46912H6010.88a49.68448 49.68448 0 0 0 0-99.36896"  ></path><path d="M4123.15648 480.37888H3477.34016V222.08512a99.36896 99.36896 0 0 1 99.36896-99.36896h546.65216a49.64352 49.64352 0 0 0-0.2048-99.36896H3576.70912a198.73792 198.73792 0 0 0-198.69696 198.73792V1014.5792h99.328V579.74784h645.81632a49.68448 49.68448 0 1 0 0-99.36896M5121.88416 946.05312L4704.78848 60.29312l-0.4096-0.94208v-0.04096a59.5968 59.5968 0 0 0-109.3632 0v0.04096l-0.28672 0.69632-417.13664 886.00576a49.68448 49.68448 0 0 0 89.9072 42.31168l382.23872-812.35968 382.23872 812.35968a49.68448 49.68448 0 0 0 89.9072-42.31168M6855.39328 579.74784h49.68448a49.68448 49.68448 0 0 0 0-99.36896h-645.81632V222.08512a99.36896 99.36896 0 0 1 99.36896-99.36896v-0.12288l99.328 0.12288h447.11936a49.68448 49.68448 0 0 0 0-99.36896H6358.6304a198.69696 198.69696 0 0 0-198.69696 198.73792v596.09088a198.69696 198.69696 0 0 0 198.656 198.73792H6905.11872a49.68448 49.68448 0 0 0 0-99.36896H6358.6304a99.36896 99.36896 0 0 1-99.36896-99.36896v-238.42816h596.13184z"  ></path><path d="M4550.49216 817.72544l99.24608-237.9776 99.20512 237.9776z"  ></path></symbol><symbol id="gld-bf-warning-1" viewBox="0 0 1024 1024"><path d="M469.333333 682.666667h85.333334v85.333333h-85.333334v-85.333333z m0-384h85.333334v341.333333h-85.333334V298.666667z m42.666667 640c235.648 0 426.666667-191.018667 426.666667-426.666667S747.648 85.333333 512 85.333333 85.333333 276.352 85.333333 512s191.018667 426.666667 426.666667 426.666667z m0 85.333333C229.248 1024 0 794.752 0 512S229.248 0 512 0s512 229.248 512 512-229.248 512-512 512z"  ></path></symbol><symbol id="gld-bf-room-addnode" viewBox="0 0 1024 1024"><path d="M224 352v257.6a80 80 0 0 1 64 77.536V672h256.704A176.064 176.064 0 0 1 704 512.704L704 352h32v160.704a176 176 0 1 1-191.296 191.328L288 704l-0.032-15.136-0.128 4.384A80 80 0 1 1 192 609.6V352h32z m496 192a144 144 0 1 0 0 288 144 144 0 0 0 0-288z m16 64l-0.032 64H800v32h-64.032L736 768h-32l-0.032-64H640v-32h63.968L704 608h32zM208 640a48 48 0 1 0 0 96 48 48 0 0 0 0-96z m0-448A80 80 0 0 1 288 271.136V256h352v32H288l-0.032-15.136-0.128 4.384A80 80 0 1 1 208 192z m512 0a80 80 0 1 1 0 160 80 80 0 0 1 0-160z m-512 32a48 48 0 1 0 0 96 48 48 0 0 0 0-96z m512 0a48 48 0 1 0 0 96 48 48 0 0 0 0-96z"  ></path></symbol><symbol id="gld-bf-room-deletenode" viewBox="0 0 1024 1024"><path d="M224 352v257.6a80 80 0 0 1 64 77.536V672h256.704A176.064 176.064 0 0 1 704 512.704L704 352h32v160.704a176 176 0 1 1-191.296 191.328L288 704l-0.032-15.136-0.128 4.384A80 80 0 1 1 192 609.6V352h32z m496 192a144 144 0 1 0 0 288 144 144 0 0 0 0-288z m-512 96a48 48 0 1 0 0 96 48 48 0 0 0 0-96zM800 672v32h-160v-32h160zM208 192A80 80 0 0 1 288 271.136V256h352v32H288l-0.032-15.136-0.128 4.384A80 80 0 1 1 208 192z m512 0a80 80 0 1 1 0 160 80 80 0 0 1 0-160z m-512 32a48 48 0 1 0 0 96 48 48 0 0 0 0-96z m512 0a48 48 0 1 0 0 96 48 48 0 0 0 0-96z"  ></path></symbol><symbol id="gld-bf-room-dragnode" viewBox="0 0 1024 1024"><path d="M512 640v128h96l-112 128-112-128h96v-128h32z m256-256l128 112-128 112v-96.032L640 512v-32l128-0.032V384zM224 384v96h128v32H224v96l-128-112L224 384z m272 32a80 80 0 1 1 0 160 80 80 0 0 1 0-160z m0 32a48 48 0 1 0 0 96 48 48 0 0 0 0-96z m0-352L608 224h-96v128h-32V224h-96l112-128z"  ></path></symbol><symbol id="gld-bf-success--fill" viewBox="0 0 1024 1024"><path d="M512 1024A512 512 0 1 1 512 0a512 512 0 0 1 0 1024zM288 448L192 544 416 768 832 352 736 256l-320 320-128-128z"  ></path></symbol><symbol id="gld-bf-information--fill" viewBox="0 0 1024 1024"><path d="M512 1024A512 512 0 1 1 512 0a512 512 0 0 1 0 1024z m64-320V384H384v64h64v256H384v64h256v-64H576zM448 192v128h128V192H448z"  ></path></symbol><symbol id="gld-bf-warning--fill" viewBox="0 0 1024 1024"><path d="M512 1024A512 512 0 1 1 512 0a512 512 0 0 1 0 1024zM448 192v384h128V192H448z m0 448v128h128v-128H448z"  ></path></symbol><symbol id="gld-bf-fitpanel" viewBox="0 0 1024 1024"><path d="M768 256v448h-96v-32h64V288H352v64h-32V256h448z"  ></path><path d="M608 416v320H288V416h320z m-35.552 35.552H323.52v248.896h248.896V451.52z"  ></path></symbol><symbol id="gld-bf-explode" viewBox="0 0 1024 1024"><path d="M832 288l-320 160L192 288l320-160 320 160zM512 163.776L263.552 288 512 412.224 760.448 288 512 163.776zM128 384l320 160v352L128 736V384z m32 51.776v280.448l256 128v-280.448l-256-128zM896 736l-320 160V544l320-160z"  ></path></symbol><symbol id="gld-bf-n-ployline" viewBox="0 0 1024 1024"><path d="M128 591.104l683.136 239.104 10.592-30.208-596.864-208.896 640.128-224.032L453.696 224l-10.528 30.208 324.704 112.96z"  ></path></symbol><symbol id="gld-bf-elevation" viewBox="0 0 1024 1024"><path d="M224 352h640v32h-284L384 608l-224-256h64z m313.472 32H230.528L384 559.392 537.472 384zM640 672v32H160v-32z" fill="#333333" ></path></symbol><symbol id="gld-bf-rotate-horizontal" viewBox="0 0 1024 1024"><path d="M224 512v32h320v-32zM704 512v32h96v-32z"  ></path><path d="M512 728.48v34.4c73.024-23.712 128-127.04 128-250.88 0-141.376-71.648-256-160-256-74.56 0-137.184 81.6-154.944 192h32.416c16.448-93.664 67.648-160 122.528-160 66.72 0 128 98.048 128 224 0 105.376-42.88 191.232-96 216.48z"  ></path><path d="M512 640l-16 122.88 128-10.88z"  ></path></symbol><symbol id="gld-bf-rotate-vertical" viewBox="0 0 1024 1024"><path d="M512 224h32v320h-32zM512 704h32v96h-32z"  ></path><path d="M728.48 512h34.4c-23.712 73.024-127.04 128-250.88 128-141.376 0-256-71.648-256-160 0-74.56 81.6-137.184 192-154.944v32.416c-93.664 16.448-160 67.648-160 122.528 0 66.72 98.048 128 224 128 105.376 0 191.232-42.88 216.48-96z"  ></path><path d="M640 512l122.88-16-10.88 128z"  ></path></symbol><symbol id="gld-bf-hide-slice" viewBox="0 0 1024 1024"><path d="M586.72 518.848l-25.664-25.664A241.408 241.408 0 0 1 640 480c94.272 0 179.584 53.344 256 160-28.8 40.224-58.88 72.832-90.24 97.92l-22.72-22.784c24.96-19.52 49.312-44.512 73.056-75.136-66.912-86.304-138.688-128-216.096-128-18.048 0-35.84 2.24-53.28 6.848z m-89.728 46.016c-24.992 19.52-49.344 44.512-73.088 75.136 66.912 86.304 138.688 128 216.096 128 18.048 0 35.84-2.24 53.28-6.848l25.664 25.664c-25.6 8.8-51.904 13.184-78.944 13.184-94.272 0-179.584-53.344-256-160 28.8-40.224 58.88-72.832 90.24-97.92l22.72 22.784h0.032z" fill="#333333" ></path><path d="M703.872 636a64 64 0 0 0-59.84-59.872l-28.896-28.864a96.128 96.128 0 0 1 117.6 117.6l-28.864-28.864z m-127.744 8a64 64 0 0 0 59.84 59.872l28.896 28.864a96.128 96.128 0 0 1-117.6-117.6l28.864 28.864zM480 457.376L819.424 796.8l-22.656 22.624L457.376 480z" fill="#333333" ></path><path d="M384 736v32H128V192h640v256h-32V224H160v512z" fill="#333333" ></path></symbol><symbol id="gld-bf-distance-min" viewBox="0 0 1024 1024"><path d="M224 704v64h608v-64H224z m-32-32h672v128H192v-128z m64-192h512v32H256v-32z m64-224h128v32h-32v96h-32V288h-32v96h-32V256z m128 128V288h32v96h-32z m96-160v32h-32V224h32z m0 64v96h-32V288h32z m128 96V288h32v96h-32z m-64-96v96h-32V256h96v32h-64z" fill="#333333" ></path><path d="M192 375.584l29.44-12.608L278.464 496l-56.96 133.024-29.44-12.608L243.616 496 192 375.584z m646.432 0l-29.44-12.608-56.96 133.024 56.96 133.024 29.44-12.608-51.616-120.416 51.648-120.416h-0.032z" fill="#333333" ></path></symbol><symbol id="gld-bf-area" viewBox="0 0 1024 1024"><path d="M841.6 704L550.4 288H192v416M160 256h409.6L896 736H160V256z m0-32" fill="#333333" ></path><path d="M336 345.6l22.4 22.4-86.4 86.4-22.4-22.4 86.4-86.4z m160 0l22.4 22.4-246.4 246.4-22.4-22.4 246.4-246.4z m64 96l22.4 22.4-182.4 182.4-22.4-22.4 182.4-182.4z m64 96l22.4 22.4-86.4 86.4-22.4-22.4 86.4-86.4z m64 0" fill="#333333" ></path></symbol><symbol id="gld-bf-fittobox" viewBox="0 0 1024 1024"><path d="M496 224L256 352v256l240 128 240-128v-256l-240-128z m198.4 137.6l-198.4 102.4-195.2-102.4 195.2-102.4 198.4 102.4zM288 582.4v-192l192 99.2v201.6l-192-99.2v-9.6z m416 9.6l-192 99.2v-201.6l192-99.2v201.6z" fill="#515151" ></path><path d="M352 128H128v224h32V160h192zM352 864H128v-224h32v192h192zM640 128h224v224h-32V160h-192zM640 864h224v-224h-32v192h-192z" fill="#515151" ></path></symbol><symbol id="gld-bf-delete" viewBox="0 0 1024 1024"><path d="M640 192V128H384v64H128v64h768V192zM192 320v544c0 52.928 43.072 96 96 96h448c52.928 0 96-43.072 96-96V320H192z m64 512V384h128v448H256z m192 0V384h128v448H448z m320 0h-128V384h128v448z"  ></path></symbol><symbol id="gld-bf-route" viewBox="0 0 1024 1024"><path d="M240 288a112 112 0 1 1 0-224 112 112 0 0 1 0 224zM224 288h32v128H224V288z m0 192h32v128H224v-128z m576-160h32v128h-32v-128z m0 192h32v118.144h-32V512zM240 896a112 112 0 1 1 0-224 112 112 0 0 1 0 224z m576-608a112 112 0 1 1 0-224 112 112 0 0 1 0 224z m-576 320a176 176 0 1 1 0 352 176 176 0 0 1 0-352z m0 32a144 144 0 1 0 0 288 144 144 0 0 0 0-288z m576-32a112 112 0 1 1 0 224 112 112 0 0 1 0-224z m-179.008-69.44l91.84 89.12-22.272 22.976-91.84-89.152 22.272-22.944zM499.2 404.8l91.84 89.184-22.272 22.944-91.84-89.152 22.272-22.944z m-137.76-133.696l91.84 89.152-22.272 22.944-91.84-89.152 22.272-22.944zM223.648 137.376l91.84 89.152-22.272 22.944-91.84-89.12 22.272-22.976z" fill="#000000" ></path></symbol><symbol id="gld-bf-n-cloud" viewBox="0 0 1024 1024"><path d="M694.4 192C752 192 800 240 800 297.6c0 48-32 86.4-73.6 99.2 41.6 12.8 73.6 51.2 73.6 99.2s-32 86.4-73.6 99.2c41.6 12.8 73.6 54.4 73.6 99.2 0 57.6-48 105.6-105.6 105.6-48 0-86.4-32-99.2-73.6C582.4 768 544 800 496 800s-86.4-32-99.2-73.6C384 768 342.4 800 297.6 800 240 800 192 752 192 694.4c0-48 32-86.4 73.6-99.2C224 582.4 192 544 192 496s32-86.4 73.6-99.2C224 384 192 342.4 192 297.6 192 240 240 192 297.6 192c48 0 86.4 32 99.2 73.6C409.6 224 448 192 496 192s86.4 32 99.2 73.6C608 224 649.6 192 694.4 192m0-32c-38.4 0-73.6 19.2-99.2 44.8-25.6-25.6-60.8-44.8-99.2-44.8s-73.6 19.2-99.2 44.8C371.2 179.2 336 160 297.6 160 220.8 160 160 220.8 160 297.6c0 38.4 19.2 73.6 44.8 99.2-25.6 25.6-44.8 60.8-44.8 99.2s19.2 73.6 44.8 99.2c-25.6 25.6-44.8 60.8-44.8 99.2C160 771.2 220.8 832 297.6 832c38.4 0 73.6-19.2 99.2-44.8 25.6 25.6 60.8 44.8 99.2 44.8s73.6-19.2 99.2-44.8c25.6 28.8 60.8 44.8 99.2 44.8 76.8 0 137.6-60.8 137.6-137.6 0-38.4-19.2-73.6-44.8-99.2 25.6-25.6 44.8-60.8 44.8-99.2s-19.2-73.6-44.8-99.2c28.8-25.6 44.8-60.8 44.8-99.2C832 220.8 771.2 160 694.4 160z"  ></path></symbol><symbol id="gld-bf-up" viewBox="0 0 1129 1024"><path d="M600.275862 564.965517v459.034483h-105.931034V564.965517H15.677793L564.965517 15.677793 1114.253241 564.965517H600.275862z"  ></path></symbol><symbol id="gld-bf-down" viewBox="0 0 1129 1024"><path d="M600.275862 459.034483V0h-105.931034v459.034483H15.677793L564.965517 1008.322207 1114.253241 459.034483H600.275862z"  ></path></symbol><symbol id="gld-bf-transparent" viewBox="0 0 1024 1024"><path d="M512 0L32 256v512l480 256 480-256V256z m394.24 273.28L512 476.16 120.96 274.56 512 70.4zM96 718.08v-384l384 197.76v402.56l-384-198.4z m832 17.92l-384 198.4V531.84l384-197.76v401.92z"  ></path></symbol><symbol id="gld-bf-untransparent" viewBox="0 0 1024 1024"><path d="M968.56051 244.585987l-456.56051 238.063695-456.56051-238.063695L512 0zM22.828025 306.547771l456.56051 235.454777v481.997452L22.828025 782.675159zM1001.171975 782.675159l-456.56051 241.324841V542.002548l456.56051-235.454777z"  ></path></symbol><symbol id="gld-bf-properties-" viewBox="0 0 1024 1024"><path d="M320 320v64H256V320h64z m448 0v64H384V320h384zM320 512v64H256V512h64z m448 0v64H384V512h384z m-448 192v64H256v-64h64z m448 0v64H384v-64h384zM64 0v960h896V0H64z m64 896V192h768v704H128z" fill="#333333" ></path></symbol><symbol id="gld-bf-ncloud" viewBox="0 0 1024 1024"><path d="M795.5 492c0.2-4.7 0.2-9 0.2-12.4 0-56.4-22-109.3-61.8-149.2-39.8-39.8-92.8-61.8-149.2-61.8-43.7 0-86.6 14.8-124.2 43-25.7 19.2-47.2 43.6-62.8 70.8-17-8.9-35.9-13.5-55.5-13.5-31.3 0-61.4 14.5-84.7 40.9-15.6 17.6-26.7 39-32 61.2-26.4 10.5-50 28.4-67 51.2-19.9 26.7-30.5 58.5-30.5 91.9 0 84.8 69 153.9 153.9 153.9l0-0.4L781 767.6l0 0.2c76.1 0 138-61.9 138-138C919.1 559 864.6 499.7 795.5 492L795.5 492zM786.6 736 786.6 736l-514.1-0.1C209.6 731 160 678.4 160 614.4c0-52.8 33.4-99.8 83.3-116.4 0.2-0.1 0.3-0.1 0.4-0.2 5-1.4 8.8-5.5 9.7-10.8 7.1-42.7 44.2-85.9 88.9-85.9 18.3 0 35.9 5.5 50.8 16 1.5 1.4 3.3 2.5 5.3 3.2l0 0c7.8 2.9 16.5-0.7 20-8.3 30.3-65.2 98-111.3 166.3-111.3 98.7 0 179 80.3 179 179 0 6.7-0.4 17.2-1 26.4-0.5 8.2 5.2 15.5 13.3 16.9l0 0c1.4 0.2 2.8 0.3 4.2 0.1l0 0.1c58.5 0 106.9 48.4 106.9 106.9C887.2 686.7 842.5 733.1 786.6 736L786.6 736z"  ></path></symbol><symbol id="gld-bf-axial-" viewBox="0 0 1024 1024"><path d="M608 128h32v736h-32V128z m128 128v32H928v416h-192v32h224V256h-224zM96 256h32v96H96V256z m0 192h32v96H96v-96z m0 192h32v96H96v-96z m320 64v32h96v-32h-96z m-192 0h96v32H224v-32zM224 256v32h96V256H224z m192 0h96v32h-96V256zM256 480h224v32H256z"  ></path></symbol><symbol id="gld-bf-sectionbox1" viewBox="0 0 1024 1024"><path d="M592 128L160 345.056V717.12l304 155.04L896 655.104V283.04L592 128z m269.664 172.544L464 500.064 194.368 362.56l397.664-200.096 269.632 138.08zM192 396.384l256 130.56v302.016l-256-130.56v-302.016z m672 240l-384 192.576v-302.016l384-192.576v302.016z"  ></path></symbol><symbol id="gld-bf-axial" viewBox="0 0 1024 1024"><path d="M416 128h-32v736h32V128zM288 256v32H96v416h192v32H64V256h224z m640 0h-32v96h32V256z m0 192h-32v96h32v-96z m0 192h-32v96h32v-96z m-320 64v32h-96v-32h96z m192 0h-96v32h96v-32z m0-448v32h-96V256h96z m-192 0h-96v32h96V256zM544 480h224v32h-224z"  ></path><path d="M672 384v224h-32v-224z"  ></path></symbol><symbol id="gld-bf-section-axial" viewBox="0 0 1024 1024"><path d="M320 749.76V362.016l256-173.632v387.744l-256 173.632z m-32 60.384l320-217.056V128L288 345.056v465.088z"  ></path><path d="M750.4 640.928l-15.52 26.848-277.12-160 15.488-26.88 277.12 160z m46.368-83.072l81.536 177.28-188.8 15.424 107.264-192.704z"  ></path></symbol><symbol id="gld-bf-min-" viewBox="0 0 1024 1024"><path d="M64 576v64h275.2L12.8 966.4l44.8 44.8L384 684.8V960h64V576H64z m838.4-499.2L576 403.2V128H512v384h384V448H620.8l326.4-326.4-44.8-44.8z"  ></path></symbol><symbol id="gld-bf-max-" viewBox="0 0 1024 1024"><path d="M576 64v64h275.2L524.8 454.4l44.8 44.8L896 172.8V448h64V64H576zM454.4 524.8L128 851.2V576H64v384h384v-64H172.8l326.4-326.4-44.8-44.8z"  ></path></symbol><symbol id="gld-bf-show" viewBox="0 0 1024 1024"><path d="M85.333333 505.941333S230.101333 256 512 256c286.378667 0 426.666667 251.050667 426.666667 251.050667s-139.221333 248.362667-426.666667 251.52c-292.309333 3.2-426.666667-252.586667-426.666667-252.586667zM512 682.666667a170.666667 170.666667 0 1 0 0-341.333334 170.666667 170.666667 0 0 0 0 341.333334z m0-42.666667a128 128 0 1 1 0-256 128 128 0 0 1 0 256z"  ></path></symbol><symbol id="gld-bf-hide" viewBox="0 0 1024 1024"><path d="M235.733333 213.333333l592.213334 592.213334-29.568 29.610666L206.165333 243.029333 235.690667 213.333333z m688.128 283.093334c-5.632-9.386667-141.482667-229.674667-412.757333-229.674667-52.096 0-99.114667 8.234667-141.226667 21.333333l34.261334 34.261334a428.8 428.8 0 0 1 106.965333-13.866667c250.752 0 376.917333 209.408 376.917333 209.408s-48.426667 81.152-145.792 142.378667l30.336 30.378666c98.048-64.426667 148.181333-145.792 151.466667-151.296l12.8-21.589333-12.970667-21.333333z m-306.090666 217.258666a425.984 425.984 0 0 1-106.666667 13.738667c-250.026667 0-376.96-209.408-376.96-209.408s48.682667-80.896 145.792-142.122667l-30.336-30.378666c-97.792 64.256-148.053333 145.28-151.296 150.912L85.333333 518.016l13.098667 21.589333c5.632 9.429333 142.122667 229.717333 412.672 229.717334 52.053333 0 99.072-8.106667 141.056-21.205334l-34.389333-34.432z m-138.88-316.586666c10.325333-2.773333 21.077333-4.693333 32.213333-4.693334a125.866667 125.866667 0 0 1 125.610667 125.610667c0 11.264-1.962667 21.845333-4.693334 32.213333l33.237334 33.237334a167.509333 167.509333 0 0 0-219.733334-219.605334l33.365334 33.237334z m64.128 241.834666c-10.325333 2.773333-20.906667 4.693333-31.914667 4.693334a125.866667 125.866667 0 0 1-125.653333-125.610667c0-11.093333 1.962667-21.76 4.693333-31.914667l-33.237333-33.28a167.509333 167.509333 0 0 0 219.605333 219.605334l-33.493333-33.493334z"  ></path></symbol><symbol id="gld-bf-layers" viewBox="0 0 1024 1024"><path d="M512 512L118.4 352 512 192l393.6 160L512 512z m-310.4-160l310.4 128 310.4-128L512 224l-310.4 128z"  ></path><path d="M707.2 464l115.2 48-310.4 128-310.4-128 115.2-48-41.6-16-156.8 64L512 672l393.6-160-156.8-64z"  ></path><path d="M707.2 624l115.2 48-310.4 128-310.4-128 115.2-48-41.6-16-156.8 64L512 832l393.6-160-156.8-64z"  ></path></symbol><symbol id="gld-bf-distance" viewBox="0 0 1024 1024"><path d="M800 480v256H192v-256h608z m-32 32H224v192h544v-192z" fill="#333333" ></path><path d="M672 608.032h32v-96h-32zM576 608.032h32v-96h-32zM384 608.032h32v-96h-32zM480 640h32v-128h-32zM288 608.032h32v-96H288zM192 352h608v-32H192z" fill="#333333" ></path><path d="M768 384.032h32V288h-32v96.032z m-576 0h32V288H192v96.032z" fill="#333333" ></path></symbol><symbol id="gld-bf-angle" viewBox="0 0 1024 1024"><path d="M192 704v64h640v-64H192z m-32-32h704v128H160v-128z" fill="#333333" ></path><path d="M216.736 672.608l-18.336-25.088L692.064 256.608l18.336 25.088z" fill="#333333" ></path><path d="M288 439.072c136.512 23.456 203.616 111.136 192.416 264.928h-32.8c10.112-138.08-40.128-212.544-159.616-233.024v-31.904z" fill="#333333" ></path></symbol><symbol id="gld-bf-view" viewBox="0 0 1024 1024"><path d="M528 160L224 320v384l304 160 304-160V320l-0.032 0.032M528.032 195.584L797.664 338.08 528 480 258.368 338.08l269.664-142.496zM256 372.992l256 134.752v311.68L256 684.672v-311.68z m544 311.68L544 819.424v-311.68l256-134.752v311.68z"  ></path></symbol><symbol id="gld-bf-orbit" viewBox="0 0 1024 1024"><path d="M774.816 705.536C717.76 784.704 625.472 832 528 832c-167.616 0-304-136.384-304-304h64l-80-128-80 128h64c0 185.28 150.72 336 336 336 107.712 0 209.696-52.256 272.736-139.776l-25.92-18.688zM864 528c0-185.28-150.72-336-336-336-108.928 0-211.584 53.184-274.56 142.24l26.112 18.464C336.576 272.128 429.44 224 528 224c167.616 0 304 136.384 304 304h-64l80 128 80-128h-64z"  ></path><path d="M688 416l-160-64v0.224l-159.712 63.872L368 416v224l160 64 160-64V416zM512 663.136l-112-44.8V463.264l112 44.8v155.072zM411.328 433.344L528 386.496v0.032l116.896 46.688L528 480l-116.672-46.656zM656 618.336l-112 44.8V508.064l112-44.8v155.072z"  ></path></symbol><symbol id="gld-bf-pan" viewBox="0 0 1024 1024"><path d="M528 496H768V416l128 96-128 96v-80h-240V768H608l-96 96-96-96h80v-240H256V608l-128-96 128-96v80h240V256H416l96-128 96 128h-80v240z"  ></path></symbol><symbol id="gld-bf-zoom" viewBox="0 0 1024 1024"><path d="M512 202.816L308.16 384h168.096L512 670.016 547.744 384h168.096L512 202.816zM594.752 704h-165.504L512 786.752 594.752 704z m-147.008-32l0.512 3.968 3.52-3.968H480l-3.52-28.032L480 640h-4L448 416H224l288-256 288 256h-224l-28 224H544l3.52 3.968L544 672h28.256l3.52 3.968 0.48-3.968H672l-160 160-160-160h95.744z"  ></path></symbol><symbol id="gld-bf-add" viewBox="0 0 1024 1024"><path d="M448 448H128v128h320v320h128V576h320V448H576V128H448v320z"  ></path></symbol><symbol id="gld-bf-minus" viewBox="0 0 1024 1024"><path d="M128 448h768v128H128z"  ></path></symbol><symbol id="gld-bf-firstperson" viewBox="0 0 1024 1024"><path d="M528 224a80 80 0 1 0 0-160 80 80 0 0 0 0 160z m0 32a112 112 0 1 1 0-224 112 112 0 1 1 0 224z"  ></path><path d="M612.096 256h-170.624c-64.48 0-89.088 51.392-95.744 113.632L320 576.832c0 18.016 11.872 31.68 32.512 31.68s29.728-13.024 31.712-31.872l32.576-194.496 0.16 531.104c0 27.072 19.328 46.752 47.04 46.752 27.68 0 48.032-18.592 48.448-48.096L512 640h32l0.448 271.808c0 27.072 15.68 48.192 47.552 48.192 27.712 0 48.288-21.28 48.288-48.352l1.632-529.504 30.688 194.08c2.624 19.264 11.008 32.192 31.648 32.192s30.208-11.776 31.968-32.448l-23.424-211.136C707.392 302.912 676.544 256 612.096 256z m60.192 655.648A79.424 79.424 0 0 1 592 992c-28.096 0-50.336-11.456-64.096-30.08-14.4 18.752-37.184 30.08-63.904 30.08-45.216 0-79.04-33.856-79.04-78.72l-0.096-280.64a65.28 65.28 0 0 1-32.352 7.872c-37.728 0-64.512-27.36-64.512-63.68l0.256-3.936 25.664-206.656C323.2 279.36 363.52 224 441.472 224h170.624c78.656 0 125.344 55.264 132.48 137.28l23.456 211.168 0.064 6.24c-3.168 37.184-26.24 61.728-63.84 61.728-12.032 0-22.4-2.56-31.104-7.168l-0.864 278.4z"  ></path></symbol><symbol id="gld-bf-measure" viewBox="0 0 1024 1024"><path d="M160 672h736v-256H160v256z m-32-288h800v320H128V384z m0-32h800v32H128v-32z"  ></path><path d="M224 416h32v96H224v-96z m96 0h32v96h-32v-96z m96 0h32v96h-32v-96z m192 0h32v96h-32v-96z m-96 0h32v160h-32v-160z m192 0h32v96h-32v-96z m96 0h32v96h-32v-96z"  ></path></symbol><symbol id="gld-bf-notes" viewBox="0 0 1024 1024"><path d="M192 768.672l640 0 0 64-640 0 0-64Z"  ></path><path d="M931.904 775.2"  ></path><path d="M1191.008 516.096"  ></path><path d="M1214.56 492.544"  ></path><path d="M166.4 439.712 165.76 438.592 167.04 438.592Z"  ></path><path d="M359.712 682.784l-134.88 22.464 22.464-134.848L359.712 682.784zM359.712 682.784"  ></path><path d="M725.44 317.056l39.328-39.328-112.384-112.384-39.328 39.328L725.44 317.056zM725.44 317.056"  ></path><path d="M702.656 339.84 590.272 227.488 269.792 547.936 382.176 660.288 495.456 547.04 495.456 547.04Z"  ></path></symbol><symbol id="gld-bf-narrow" viewBox="0 0 1024 1024"><path d="M352 480l192 192-288 96L352 480zM292 754.9l-22-23.3L768 256l23.5 24L292 754.9z"  ></path></symbol><symbol id="gld-bf-noval" viewBox="0 0 1024 1024"><path d="M512 192c158.8 0 288 129.2 288 288S670.8 768 512 768 224 638.8 224 480 353.2 192 512 192M512 160c-176.7 0-320 143.3-320 320s143.3 320 320 320 320-143.3 320-320S688.7 160 512 160L512 160z"  ></path></symbol><symbol id="gld-bf-nrectangle" viewBox="0 0 1024 1024"><path d="M800.2 256.1l0 447.7-576.3 0L223.9 256.1 800.2 256.1M832.2 224.1 191.8 224.1l0 511.7 640.3 0L832.2 224.1 832.2 224.1z"  ></path></symbol><symbol id="gld-bf-ntext" viewBox="0 0 1024 1024"><path d="M784 224l0 150.4-14.6 0c-8.7-34.4-18.3-58.5-28.8-73.6s-25.1-27-43.5-36c-10.3-4.9-28.3-7.3-54-7.3l-41 0 0 425c0 28.2 1.6 45.8 4.7 52.8s9.2 13.2 18.2 18.5c9.1 5.3 21.5 7.9 37.2 7.9l18.3 0 0 15L392.1 776.7l0-15 18.3 0c16 0 28.8-2.8 38.6-8.5 7-3.8 12.6-10.3 16.7-19.5 3-6.5 4.5-23.6 4.5-51.2l0-424.9-39.8 0c-37.1 0-64.1 7.9-80.8 23.6-23.6 22-38.5 52.6-44.7 93.3L288 374.5 288 224 784 224z"  ></path></symbol><symbol id="gld-bf-mark" viewBox="0 0 1024 1024"><path d="M192.2 800.2l608-608.2 22.6 22.6-608 608.2C214.8 822.8 192.2 800.2 192.2 800.2zM809.6 822.8l-608-608.2 22.6-22.6 608 608.2C832.2 800.2 809.6 822.8 809.6 822.8z"  ></path></symbol><symbol id="gld-bf-zoomrect" viewBox="0 0 1024 1024"><path d="M886.4 809.6l-96-96c25.6-28.8 41.6-64 41.6-105.6 0-9.6 0-19.2-3.2-28.8v-6.4c-3.2-9.6-3.2-16-6.4-22.4 0-3.2-3.2-6.4-3.2-9.6-3.2-6.4-6.4-9.6-9.6-16-3.2-6.4-6.4-9.6-9.6-16l-6.4-6.4c-6.4-9.6-16-16-22.4-22.4v-288h-512v512h288c6.4 9.6 12.8 16 22.4 22.4l6.4 6.4c6.4 3.2 9.6 6.4 16 9.6 6.4 3.2 9.6 6.4 16 9.6 3.2 0 6.4 3.2 9.6 3.2 6.4 3.2 16 6.4 22.4 6.4h6.4c9.6 3.2 19.2 3.2 28.8 3.2 35.2 0 67.2-12.8 96-32l96 96 19.2-19.2zM288 672v-448h448v236.8c-19.2-9.6-41.6-12.8-64-12.8-89.6 0-160 70.4-160 160 0 22.4 6.4 44.8 12.8 64h-236.8z m384 64c-9.6 0-19.2 0-28.8-3.2-3.2 0-3.2 0-6.4-3.2-6.4-3.2-12.8-3.2-19.2-6.4-3.2 0-3.2-3.2-6.4-3.2-6.4-3.2-12.8-6.4-19.2-12.8 0 0-3.2 0-3.2-3.2l-19.2-19.2-6.4-6.4c-12.8-19.2-19.2-44.8-19.2-70.4 0-70.4 57.6-128 128-128 25.6 0 48 6.4 70.4 19.2l6.4 6.4c6.4 6.4 16 12.8 19.2 19.2 0 0 0 3.2 3.2 3.2 6.4 6.4 9.6 12.8 12.8 19.2 0 3.2 3.2 3.2 3.2 6.4 3.2 6.4 6.4 12.8 6.4 19.2 0 3.2 0 3.2 3.2 6.4 3.2 9.6 3.2 19.2 3.2 28.8 0 70.4-57.6 128-128 128z"  ></path></symbol><symbol id="gld-bf-selected" viewBox="0 0 1024 1024"><path d="M930.133333 315.733333L827.733333 213.333333 409.6 631.466667 196.266667 418.133333 85.333333 529.066667l213.333334 213.333333 102.4 102.4L512 742.4l418.133333-426.666667z" fill="#333333" ></path></symbol><symbol id="gld-bf-tree" viewBox="0 0 1024 1024"><path d="M800 672v-192h-288V288h96V128h-224v160h96v192H192v192H128v160h160v-160H224v-160h256v160h-64v160h160v-160h-64v-160h256v160h-64v160h160v-160z"  ></path></symbol><symbol id="gld-bf-infor" viewBox="0 0 1024 1024"><path d="M512 85.333333c238.933333 0 426.666667 187.733333 426.666667 426.666667s-187.733333 426.666667-426.666667 426.666667-426.666667-187.733333-426.666667-426.666667 187.733333-426.666667 426.666667-426.666667m0-85.333333C230.4 0 0 230.4 0 512s230.4 512 512 512 512-230.4 512-512-230.4-512-512-512z"  ></path><path d="M469.333333 256h85.333334v85.333333h-85.333334zM469.333333 426.666667h85.333334v341.333333h-85.333334z"  ></path></symbol><symbol id="gld-bf-box-hide" viewBox="0 0 1024 1024"><path d="M528 128L96 352v352l304 160 131.2-67.2c-9.6-9.6-22.4-12.8-32-19.2L416 819.2v-278.4l384-198.4v188.8c9.6 3.2 22.4 6.4 32 9.6V288l-304-160zM128 684.8v-278.4l256 134.4v278.4l-256-134.4z m272-172.8l-268.8-140.8 396.8-208 268.8 144L400 512z" fill="#333333" ></path><path d="M682.72 582.848l-25.664-25.664A241.408 241.408 0 0 1 736 544c94.272 0 179.584 53.344 256 160-28.8 40.224-58.88 72.832-90.24 97.92l-22.72-22.784c24.96-19.52 49.312-44.512 73.056-75.136-66.912-86.304-138.688-128-216.096-128-18.048 0-35.84 2.24-53.28 6.848z m-89.728 46.016c-24.992 19.52-49.344 44.512-73.088 75.136 66.912 86.304 138.688 128 216.096 128 18.048 0 35.84-2.24 53.28-6.848l25.664 25.664c-25.6 8.8-51.904 13.184-78.944 13.184-94.272 0-179.584-53.344-256-160 28.8-40.224 58.88-72.832 90.24-97.92l22.72 22.784h0.032z" fill="#333333" ></path><path d="M799.872 700a64 64 0 0 0-59.84-59.872l-28.896-28.864a96.128 96.128 0 0 1 117.6 117.6l-28.864-28.864z m-127.744 8a64 64 0 0 0 59.84 59.872l28.896 28.864a96.128 96.128 0 0 1-117.6-117.6l28.864 28.864zM576 521.376L915.424 860.8l-22.656 22.624L553.376 544z" fill="#333333" ></path></symbol><symbol id="gld-bf-information" viewBox="0 0 1024 1024"><path d="M512 160c195.2 0 352 156.8 352 352s-156.8 352-352 352S160 707.2 160 512 316.8 160 512 160m0-32C300.8 128 128 300.8 128 512s172.8 384 384 384 384-172.8 384-384S723.2 128 512 128z"  ></path><path d="M480 320h64v64h-64zM480 448h64v256h-64z"  ></path></symbol><symbol id="gld-bf-properties" viewBox="0 0 1024 1024"><path d="M1191.008 516.096"  ></path><path d="M1214.56 492.544"  ></path><path d="M288 416l64 0 0 64-64 0 0-64Z"  ></path><path d="M416 416l352 0 0 64-352 0 0-64Z"  ></path><path d="M288 544l64 0 0 64-64 0 0-64Z"  ></path><path d="M416 544l352 0 0 64-352 0 0-64Z"  ></path><path d="M288 672l64 0 0 64-64 0 0-64Z"  ></path><path d="M416 672l352 0 0 64-352 0 0-64Z"  ></path><path d="M852 160 192 160l0 160 0 544 672 0L864 160 852 160zM384 208l64 0 0 64-64 0L384 208zM288 208l64 0 0 64L288 272 288 208zM832 832 224 832 224 320l608 0L832 832z"  ></path></symbol><symbol id="gld-bf-map" viewBox="0 0 1024 1024"><path d="M656 96C524.8 96 416 201.6 416 336S656 736 656 736 896 467.2 896 336 790.4 96 656 96z m0 339.2c-67.2 0-121.6-54.4-121.6-121.6 0-67.2 54.4-121.6 121.6-121.6s121.6 54.4 121.6 121.6c0 67.2-54.4 121.6-121.6 121.6zM128 704h480v32H128zM128 416h288v32h-288z"  ></path><path d="M320 256h32v672h-32zM640 768h32v160h-32zM704 704h160v32h-160z"  ></path></symbol><symbol id="gld-bf-maximize" viewBox="0 0 1024 1024"><path d="M608 192v32h169.6l-227.2 227.2 22.4 22.4L800 246.4V416h32V192zM451.2 550.4L224 777.6V608H192v224h224v-32H246.4l227.2-227.2z"  ></path><path d="M896 128v768H128V128h768m32-32H96v832h832V96z"  ></path></symbol><symbol id="gld-bf-minimize" viewBox="0 0 1024 1024"><path d="M256 544v32h169.6l-227.2 227.2 22.4 22.4 227.2-227.2V768h32v-224zM803.2 198.4L576 425.6V256h-32v224h224v-32h-169.6l227.2-227.2z"  ></path><path d="M896 128v768H128V128h768m32-32H96v832h832V96z"  ></path></symbol><symbol id="gld-bf-reset-box" viewBox="0 0 1024 1024"><path d="M210.56 672l112-160h-224z" fill="#333333" ></path><path d="M530.016 864v-32a304 304 0 1 0-304-304h-32c0-185.568 150.4-336 336-336 185.568 0 336 150.432 336 336S715.552 864 530.016 864z" fill="#333333" ></path></symbol><symbol id="gld-bf-rotate-box" viewBox="0 0 1024 1024"><path d="M528 832c-166.4 0-304-137.6-304-304h64l-80-128-80 128h64C192 713.6 342.4 864 528 864c108.8 0 211.2-51.2 272-140.8l-25.6-19.2c-57.6 80-150.4 128-246.4 128zM864 528C864 342.4 713.6 192 528 192c-108.8 0-211.2 54.4-275.2 140.8l25.6 19.2c57.6-80 150.4-128 249.6-128C694.4 224 832 361.6 832 528h-64l80 128 80-128h-64z"  ></path><path d="M640 416v224h-224V416h224m32-32h-288v288h288V384z"  ></path></symbol><symbol id="gld-bf-close16" viewBox="0 0 1024 1024"><path d="M929.7 873.9 567.8 511.8l361.4-361.6c11.9-11.9 11.9-31.2 0-43.2l-12.7-12.7c-11.9-11.9-31.2-11.9-43.1 0L512 455.9 150.6 94.3c-11.9-11.9-31.2-11.9-43.1 0L94.8 107c-11.9 11.9-11.9 31.2 0 43.2l361.4 361.6L94.2 873.9c-11.9 11.9-11.9 31.3 0 43.2l12.7 12.7c11.9 11.9 31.2 11.9 43.1 0L512 567.6l361.9 362.1c11.9 11.9 31.2 11.9 43.1 0l12.7-12.7C941.6 905.1 941.6 885.8 929.7 873.9z"  ></path></symbol><symbol id="gld-bf-orbitcamera" viewBox="0 0 1024 1024"><path d="M512 32"  ></path><path d="M528 832C360.384 832 224 695.616 224 528l64 0-80-128-80 128 64 0C192 713.28 342.72 864 528 864c107.712 0 209.696-52.256 272.736-139.776l-25.952-18.688C717.76 784.704 625.472 832 528 832z"  ></path><path d="M864 528C864 342.72 713.28 192 528 192c-108.928 0-211.584 53.184-274.56 142.24l26.112 18.464C336.576 272.128 429.44 224 528 224c167.616 0 304 136.384 304 304l-64 0 80 128 80-128L864 528z"  ></path><path d="M704 416l-96 48L608 416l-256 0 0 224 256 0 0-48 96 48L704 416zM576 608l-192 0 0-160 192 0 0 32 0 96L576 608zM672 588.224l-64-32 0-56.448 64-32L672 588.224z"  ></path></symbol><symbol id="gld-bf-orbitpoint" viewBox="0 0 1024 1024"><path d="M512 32"  ></path><path d="M528 832C360.384 832 224 695.616 224 528l64 0-80-128-80 128 64 0C192 713.28 342.72 864 528 864c107.712 0 209.696-52.256 272.736-139.776l-25.952-18.688C717.76 784.704 625.472 832 528 832z"  ></path><path d="M864 528C864 342.72 713.28 192 528 192c-108.928 0-211.584 53.184-274.56 142.24l26.112 18.464C336.576 272.128 429.44 224 528 224c167.616 0 304 136.384 304 304l-64 0 80 128 80-128L864 528z"  ></path><path d="M528 528m-112 0a3.5 3.5 0 1 0 224 0 3.5 3.5 0 1 0-224 0Z"  ></path></symbol><symbol id="gld-bf-settings" viewBox="0 0 1024 1024"><path d="M796.896 435.552c-6.72-25.12-16.672-48.96-29.408-70.976l55.872-84.32-0.096-0.096-79.456-79.456L743.712 200.64l-84.32 55.872c-22.016-12.736-45.824-22.688-70.976-29.408L568.32 128l-0.128 0-112.384 0L455.68 128l-20.128 99.104c-25.12 6.72-48.96 16.672-70.976 29.408L280.288 200.64 280.192 200.736 200.736 280.192 200.64 280.288l55.872 84.32c-12.736 22.016-22.688 45.824-29.408 70.976L128 455.68l0 0.128 0 112.384 0 0.128 99.104 20.128c6.72 25.12 16.672 48.96 29.408 70.976L200.64 743.712l0.096 0.096 79.456 79.456 0.096 0.096 84.32-55.872c22.016 12.736 45.824 22.688 70.976 29.408L455.68 896l0.128 0 112.384 0 0.128 0 20.096-99.104c25.12-6.72 48.96-16.672 70.976-29.408l84.32 55.872 0.096-0.096 79.456-79.456 0.096-0.096-55.872-84.32c12.736-22.016 22.688-45.824 29.408-70.976L896 568.32l0-0.128 0-112.384L896 455.68 796.896 435.552zM512 672c-88.352 0-160-71.648-160-160s71.648-160 160-160 160 71.648 160 160S600.352 672 512 672z"  ></path></symbol><symbol id="gld-bf-home" viewBox="0 0 1024 1024"><path d="M928 512L512 128 96 512h128v352h192V608h192v256h192V512z"  ></path></symbol><symbol id="gld-bf-sectionbox" viewBox="0 0 1024 1024"><path d="M576 160l32 0 0 704-32 0 0-704Z"  ></path><path d="M672 256 672 288 704 288 830.016 288 864 288 864 672 830.016 672 704 672 672 672 672 704 896 704 896 256Z"  ></path><path d="M128 512l32 0 0 96-32 0 0-96Z"  ></path><path d="M128 704l32 0c16 0 32 0 32 0l0-32L128 672 128 704z"  ></path><path d="M416 288 452 288 480 288 512 288 512 256 416 256Z"  ></path><path d="M128 352l32 0 0 96-32 0 0-96Z"  ></path><path d="M128 256l64 0 0 32-64 0 0-32Z"  ></path><path d="M256 256l96 0 0 32-96 0 0-32Z"  ></path><path d="M416 672 416 704 512 704 512 672 452 672Z"  ></path><path d="M256 672l96 0 0 32-96 0 0-32Z"  ></path></symbol></svg>',d=(d=document.getElementsByTagName("script"))[d.length-1].getAttribute("data-injectcss")
;if(d&&!e.__iconfont__svg__cssinject__){e.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(e){console&&console.log(e)}}n=function(){var e,t,n,o;(o=document.createElement("div")).innerHTML=s,s=null,(n=o.getElementsByTagName("svg")[0])&&(n.setAttribute("aria-hidden","true"),n.style.position="absolute",n.style.width=0,n.style.height=0,n.style.overflow="hidden",e=n,(t=document.body).firstChild?(o=e,(n=t.firstChild).parentNode.insertBefore(o,n)):t.appendChild(e))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(n,0):(o=function(){document.removeEventListener("DOMContentLoaded",o,!1),n()},document.addEventListener("DOMContentLoaded",o,!1)):document.attachEvent&&(a=n,i=e.document,r=!1,(l=function(){try{i.documentElement.doScroll("left")}catch(e){return void setTimeout(l,50)}t()})(),i.onreadystatechange=function(){"complete"==i.readyState&&(i.onreadystatechange=null,t())})}(window),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Control"),t=function(){return{id:null,tagName:"div",className:"bf-control",title:"",element:""}};e.ControlConfig=t}(),function(){var e=Object.freeze({Click:"Click",MouseEnter:"MouseEnter",MouseLeave:"MouseLeave",MouseMove:"MouseMove",StateChange:"StateChange",Change:"Change"});Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Control").ControlEvent=e}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Control"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),n=function(e){var n=this;n.eventManager=new Glodon.Web.Lang.EventManager,n.element=t.create(e.tagName,e.className),n.id=e.id||Glodon.Web.Lang.Utility.UUID.createUUID(),e.title&&!e.isPanel&&n.setTitle(e.title),e.element&&e.element.appendChild(n.element)};n.prototype={addEventListener:function(e,t){var n=this,o=n.eventManager;n.element.addEventListener(e.toLocaleLowerCase(),t),o.addEvent(e,t)},removeEventListener:function(e,t){var n=this;n.eventManager.removeEvent(e,t),n.element.removeEventListener(e.toLocaleLowerCase(),t)},show:function(){this.element.style.display=""},hide:function(){this.element.style.display="none"},setTitle:function(e){this.element.setAttribute("title",e)},getTitle:function(){return this.element.getAttribute("title")},setClassNames:function(e){this.element.setAttribute("class",e)},getClassNames:function(){return this.element.getClass()},addClassName:function(e){this.element.addClass(e)},removeClassName:function(e){this.element.removeClass(e)},toggleClassName:function(e,t){this.element.toggleClass(e,t)},setDomId:function(e){this.element.setAttribute("id",e)},getDomId:function(){return this.element.getAttribute("id")},getId:function(){return this.id},setHtml:function(e){this.element.innerHTML=e},setStyle:function(e){this.element.setCss(e)},destroy:function(){this.element.parentNode&&this.element.parentNode.removeChild(this.element)}},e.Control=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Toolbar"),t=new Glodon.Bimface.UI.Control.ControlConfig,n=function(){var e={className:"bf-toolbar"};return Object.assign({},t,e)};e.ToolbarConfig=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Control"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Toolbar"),n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),o=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),function(t){this._controls=[],e.Control.call(this,t),this.element.addEventListener("mousedown",this.bringToFront.bind(this))});n.Type.inheritPrototype(o,e.Control),o.prototype.addControl=function(e){this.getControls().push(e),this.element.appendChild(e.element)},o.prototype.bringToFront=function(){if(!this.element.hasClass("bf-pinned")){var e=document.querySelector(".bf-pinned");e&&e.removeClass("bf-pinned"),this.element.addClass("bf-pinned")}},o.prototype.addControls=function(e){for(var t=this,n=0,o=e.length;n<o;n++)t.addControl(e[n]);return this.getControls()},o.prototype.insertControl=function(e,t){var n=this.getControls();n.insert(e,t);var o=n[e+1];o?this.element.insertBefore(t.element,o.element):this.element.appendChild(t.element)},o.prototype.removeControl=function(e){var t=this.getControls(),n=t.getObjectByAttribute("id",e);t.removeObjectByAttribute("id",e),this.element.removeChild(n.element)},o.prototype.getControls=function(){return this._controls},o.prototype.getControl=function(e){return this.getControls().getObjectByAttribute("id",e)},o.prototype.destroy=function(){for(var e=this.getControls(),t=0;t<e.length;t++)e[t].destroy();this._controls=[],this.element.parentNode&&this.element.parentNode.removeChild(this.element)},t.Toolbar=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Button"),t=(Glodon.Bimface.UI.Button.ButtonOption,new Glodon.Bimface.UI.Control.ControlConfig),n=function(){var e={className:"bf-button",title:"button",checkedState:!1,defaultClass:"",changeClass:"",inheritTitle:!1};return Object.assign({},t,e)};e.ButtonConfig=n}(),function(){var e=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Control")),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Button"),n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),o=function(t){e.Control.call(this,t),this._enabled=!0};n.Type.inheritPrototype(o,e.Control),o.prototype.addToolbar=function(e){this.toolbar=e,this.element.appendChild(e.element)},o.prototype.getToolbar=function(e){return this.toolbar},o.prototype.disabled=function(){this._enabled=!1,this.element.addClass("bf-button-disabled")},o.prototype.enabled=function(){this._enabled=!0,this.element.removeClass("bf-button-disabled")},t.Button=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Button"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),n=Glodon.Bimface.UI.Control.ControlEvent,o=function(t){e.Button.call(this,t);var o=this;o._checked=t.checkedState,o._checked&&this.addClassName("bf-checked"),o.addEventListener(n.Click,function(){o.toggleCheckedState()})};t.Type.inheritPrototype(o,e.Button),o.prototype.toggleCheckedState=function(){this.setCheckedState(!this._checked)},o.prototype.setCheckedState=function(e){this._checked!=e&&(this._checked=e,this.toggleClassName("bf-checked",e),this.eventManager.fireEvent(n.StateChange,e))},o.prototype.isChecked=function(){return this._checked},e.ToggleButton=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Control"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Button"),n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Toolbar"),o=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),a=new n.ToolbarConfig,i=new e.ControlConfig,r=function(t){e.Control.call(this,t);var o=this;o._inheritTitle=t.inheritTitle;var r=new e.Control(i);r.setClassNames("bf-current"),a.element=o.element,a.className="bf-sub-toolbar bf-scroll-bar";var l=new n.Toolbar(a);o.currentElement=r,o._subToolbar=l,o.element.appendChild(o.currentElement.element),o.addEventListener("Click",function(){o.toggleDropDownList()})};o.Type.inheritPrototype(r,e.Control),r.prototype.toggleDropDownList=function(){this.checked=!this.checked,this.toggleClassName("bf-expand")},r.prototype.showDropDownList=function(){this._checked=!0,this.addClassName("bf-expand")},r.prototype.hideDropDownList=function(e){this._checked=!1,this.removeClassName("bf-expand")},r.prototype.addControl=function(e){var t=this,n=t.getControls();t._subToolbar.addControl(e),1==n.length&&t.setSelectedControlById(e.id),e.addEventListener("Click",function(){for(var o=0,a=n.length;o<a;o++)n[o].setCheckedState(!1);t.currentElement.setHtml(this.outerHTML.replace("checked","")),e.setCheckedState(!0),t._currentControl=e,t.eventManager.fireEvent("Change",e)})},r.prototype.removeControl=function(e){this._subToolbar.removeControl(e)},r.prototype.getControls=function(){return this._subToolbar.getControls()},r.prototype.getControl=function(e){return this._subToolbar.getControl(e)},r.prototype.getCurrentControl=function(){return this._currentControl},r.prototype.setSelectedControlById=function(e){var t=this.getControl(e);t.setCheckedState(!1);var n=t.element.cloneNode(!0);this._inheritTitle||n.removeAttribute("title"),this.currentElement.setHtml(n.outerHTML),t.setCheckedState(!0),this._currentControl=t},r.prototype.setSelectedUiById=function(e){this.element.querySelector(".bf-checked").removeClass("bf-checked"),this.setSelectedControlById(e),this.eventManager.fireEvent("Change",this.getControl(e))},t.ComboBox=r}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Button"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),n=function(t){e.ComboBox.call(this,t),this.currentElement=t.home,this.home=t.home,this.element.appendChild(this.currentElement.element)};t.Type.inheritPrototype(n,e.ComboBox),n.prototype.addControl=function(e){var t=this,n=t.getControls();t._subToolbar.addControl(e),e.addEventListener("Click",function(){for(var o=0,a=n.length;o<a;o++)n[o].setCheckedState(!1);t.currentElement.setCheckedState(!1),t._currentControl=e,t.eventManager.fireEvent("Change",e)})},n.prototype.recover=function(){this.home.setCheckedState(!1),this.hideDropDownList()},e.TouchComboBox=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Button"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),n=function(t){e.ToggleButton.call(this,t)};t.Type.inheritPrototype(n,e.ToggleButton),e.ComboBoxOptionButton=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Button"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),n=function(t){e.Button.call(this,t);var n=this;n.addClassName(t.defaultClass),n._defaultClass=t.defaultClass,n._changeClass=t.changeClass,this.type="default",n._title=t.title,n._changeTitle=t.changeTitle||t.title,n._checked&&this.addClassName("bf-checked"),n.addEventListener("Click",function(){n.toggleState(),n.eventManager.fireEvent("Change",n.type)})};t.Type.inheritPrototype(n,e.Button),n.prototype.toggleState=function(){this.setState("change"==this.type?"default":"change")},n.prototype.setState=function(e){this.type=e,"default"==e?(this.addClassName(this._defaultClass),this.removeClassName(this._changeClass)):(this.addClassName(this._changeClass),this.removeClassName(this._defaultClass))},e.ChangeButton=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Button"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),n={},o=function(t){e.Button.call(this,t);var o=this;o._checked=t.checkedState,o.addEventListener("Click",function(){o.setChecked()}),n[t.groupName]?(n[t.groupName].push(o),this._groupList=n[t.groupName]):(n[t.groupName]=[o],this._groupList=n[t.groupName],o.setChecked())};t.Type.inheritPrototype(o,e.Button),o.prototype.setChecked=function(){for(var e=this._groupList,t=0,n=e.length;t<n;t++)e[t].removeClassName("bf-checked");this.addClassName("bf-checked")},e.SingleButton=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Menu"),t=new Glodon.Bimface.UI.Control.ControlConfig,n=function(){var e={className:"bf-menu",isSubMenu:!1,text:null};return Object.assign({},t,e)};e.MenuConfig=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Menu"),t=new Glodon.Bimface.UI.Control.ControlConfig,n=function(){var e={className:"bf-menu-item"};return Object.assign({},t,e)};e.MenuItemConfig=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Button"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Menu"),n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),o=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),function(t){this._controls=[],e.Button.call(this,t),this.isDisabled=!1});n.Type.inheritPrototype(o,e.Button),o.prototype.setText=function(e){this.element.innerText=e},o.prototype.disabled=function(e){this.element.addClass("bf-disabled"),this.isDisabled=!0},o.prototype.enabled=function(e){this.element.removeClass("bf-disabled"),this.isDisabled=!1},o.prototype.hide=function(e){this.element.addClass("bf-hide"),this.isHide=!0},o.prototype.show=function(e){this.element.removeClass("bf-hide"),this.isHide=!1},o.prototype.addEventListener=function(e,t){var n=this,o=n.eventManager;this.isDisabled||(n.element.addEventListener(e.toLocaleLowerCase(),t),o.addEvent(e,t))},t.MenuItem=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Menu"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),n=function(){this.element=t.create("div","bf-spacer")};n.prototype.hide=function(e){this.element.addClass("bf-hide"),this.isHide=!0},e.Spacer=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Toolbar"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Menu"),n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),o=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),a=function(t){if(e.Toolbar.call(this,t),this.element.addEventListener("mousedown",function(e){e.stopPropagation()}),this.element.addEventListener("contextmenu",function(e){e.preventDefault()}),this.isDisabled=!1,t.isSubMenu){var n=o.create("div","bf-menu-item");n.innerText=t.text;var a=o.create("div","bf-menu");this.element.appendChild(n),this.element.appendChild(a),this.subElement=a}};n.Type.inheritPrototype(a,e.Toolbar),a.prototype.setPosition=function(e){this.element.style.left=e.x+"px",this.element.style.top=e.y+"px"},a.prototype.addControl=function(e){this.getControls().push(e),this.subElement?this.subElement.appendChild(e.element):this.element.appendChild(e.element)},a.prototype.disabled=function(e){this.element.addClass("bf-disabled"),this.isDisabled=!0},a.prototype.enabled=function(e){this.element.removeClass("bf-disabled"),this.isDisabled=!1},a.prototype.destroy=function(e){this.element&&this.element.remove(),this.element=null},t.Menu=a}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Control"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Panel"),n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),o=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility");t.PanelPositions=t.PanelPositions||{};var a=function(o){var a=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop();o.isPanel=!0,this._opt=o,e.Control.call(this,o),this._controls=[];var i=this,r=i.element;i.isShow=!0;var l=n.create("div","bf-panel-body"),s=n.create("div","bf-panel-header"),d=n.create("div","bf-panel-footer"),c=n.create("div","bf-panel-container bf-scroll-bar"),u=n.create("div","bf-close"),p=o.css;for(var f in p)r.style[f]=""+p[f];if(o.easyMode||r.appendChild(u),o.title){var h=n.create("div","bf-title");h.textContent=o.title,r.appendChild(h),r.addClass("bf-has-title"),i.headerElement=h}l.appendChild(s),l.appendChild(c),r.appendChild(l),l.appendChild(d),h&&o.enableDrag&&a&&(this.drag=new Glodon.Web.Lang.Utility.Dom.drag({element:this.element,handle:h,bBoxDetection:!0,move:function(e,t,n){i.eventManager.fireEvent("Move",e,t,n)},record:function(e,n){t.PanelPositions[o.className]={left:e,top:n}}})),this.body=l,this.container=c,this.header=s,this.footer=d,o.enableSizable&&Glodon.Web.Lang.Utility.Dom.sizable({element:this.element,axis:"all",sizable:function(e,t,n){i.eventManager.fireEvent("Sizable",e,t,n)}}),r.addEventListener("mousedown",this.onMouseDown.bind(this)),r.addEventListener("mousemove",this.onMouseMove.bind(this)),document.addEventListener("mouseup",this.onMouseUp.bind(this)),u.addEventListener("click",function(){i.hide()}),c.addEventListener("click",function(e){var t=e.target.closest(".bf-group-title");if(t&&t.hasClass("bf-group-title")){t.parentNode.toggleClass("bf-collapse")}}),c.addEventListener("DOMNodeRemoved",function(){i.showTips()}),c.addEventListener("DOMNodeInserted",function(){i.hideTips()}),window.addEventListener("resize",this.initPosition.bind(this))};o.Type.inheritPrototype(a,e.Control),a.prototype.setData=function(e,t){if(this.clear(),e&&e.length>0){for(var n='<table class="bf-table">',o=0,a=e.length;o<a;o++){for(var i='<tbody class="bf-group '+(t&&"bf-collapse")+'"><tr class="bf-group-title"><td colspan="2"><i class="bf-icon"></i>'+e[o].group+"</td></tr>",r=e[o].items,l=0,s=r.length;l<s;l++){var d=r[l];i+='<tr class="bf-group-content"><td class="bf-key">'+d.key+'</td><td class="bf-value">'+d.value+"</td></tr>"}i+="</tbody>",n+=i}n+="</table>",this.container.innerHTML=n}},a.prototype.setTitleContent=function(e){this.headerElement.textContent=e},a.prototype.onMouseDown=function(){this.isMouseDown=!0,this.element.removeEventListener("mousemove",this.onMouseMove),this.bringToFront()},a.prototype.onMouseMove=function(e){!0!==this.isMouseDown&&(e.preventDefault(),e.stopPropagation())},a.prototype.onMouseUp=function(){this.isMouseDown=!1,this.element.addEventListener("mousemove",this.onMouseMove)},a.prototype.bringToFront=function(){if(!this.element.hasClass("bf-pinned")){var e=document.querySelector(".bf-pinned");e&&e.removeClass("bf-pinned"),this.element.addClass("bf-pinned")}},a.prototype.showTips=function(){if(this.tipsElement)return void this.body.insertBefore(this.tipsElement,this.body.childNodes[1])},a.prototype.setTips=function(e,t){this.tipsElement&&this.tipsElement.remove();var o={default:"bf-panel-tips",loading:"bf-panel-loading"},a=o[t]||o.default,i=n.create("div",a);i.textContent=e,this.tipsElement=i,this.showTips()},a.prototype.hideTips=function(){this.tipsElement&&this.tipsElement.remove()},a.prototype.setContainerHeader=function(e){if("String"==typeof e);else{e.style.right="100%",e.style.bottom="100%",document.body.appendChild(e);var t=e.offsetHeight;document.body.removeChild(e),e.removeAttribute("style"),e.style.marginTop="-"+t+"px",this.body.style.paddingTop=t+"px",this.header.appendChild(e)}},a.prototype.setContainerFooter=function(e){"String"==typeof e||this.footer.appendChild(e)},a.prototype.close=function(){this.destroy(),this.eventManager.fireEvent("Close"),this.isShow=!1,window.removeEventListener("resize",this.initPosition.bind(this))},a.prototype.hide=function(e){this.isShow=!1,this.element.style.display="none",!0!==e&&this.eventManager.fireEvent("Hide")},a.prototype.show=function(e){this.isShow=!0,this.element.style.display="",!0!==e&&this.eventManager.fireEvent("Show"),this.bringToFront(),this.initPosition()},a.prototype.clear=function(){this.container.innerHTML=""},a.prototype.toggle=function(){this.isShow?this.element.style.display="none":(this.element.style.display="",this.bringToFront()),this.isShow=!this.isShow},a.prototype.addControl=function(e){this.getControls().push(e),this.container.appendChild(e.element)},a.prototype.getControls=function(){return this._controls},a.prototype.getControl=function(e){return this.getControls().getObjectByAttribute("id",e)},a.prototype.setHtml=function(e){this.container.innerHTML=e},a.prototype.addClass=function(e){this.element.addClass(e)},a.prototype.removeClass=function(e){this.element.removeClass(e)},a.prototype.setHeight=function(e){this.element.style.height=e+"px"},a.prototype.setWidth=function(e){this.element.style.width=e+"px"},a.prototype.setHeader=function(e){this._opt.title=e,this.headerElement.textContent=e},a.prototype.getTitle=function(){return this._opt.title},a.prototype.isDisplay=function(){return"none"!=this.element.style.display},a.prototype.initPosition=function(){this.isShow&&this.drag&&(t.PanelPositions[this._opt.className]?(this.element.style.left=t.PanelPositions[this._opt.className].left+"px",this.element.style.top=t.PanelPositions[this._opt.className].top+"px",this.drag.resize(this.element)):this.drag.resize(this.element,null,!0))},t.Panel=a}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Panel"),t=new Glodon.Bimface.UI.Control.ControlConfig,n=function(){var e={className:"bf-panel",title:"panel",css:{width:"200px",height:"200px",minWidth:"200px",minHeight:"200px"},enableDrag:!0,enableSizable:!0};return Object.assign({},t,e)};e.PanelConfig=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Tree"),t=function(e){var t=this;t._root=e,t.element=e.element,t.eventManager=e.eventManager,t.addEventListener=e.addEventListener,t.removeEventListener=e.removeEventListener,e.addEventListener("SelectionChanged",function(e,n){t._selectionNode==e?n||(t._selectionNode=null):(t._selectionNode&&t._selectionNode.deselect(),t._selectionNode=e)})};t.prototype={getRoot:function(){return this._root},getChecked:function(){function e(o,a){var i=o.getCheckedState(),r=o.element.getAttribute("data-filter");switch(i){case"unchecked":break;case"checked":if(o==t)n="all";else{var l=Object.assign({},a);l[r]=o.id,n.push(l)}break;case"half":var s=o.getControls(),d=Object.assign({},a);o!=t&&(d[r]=o.id);for(var c=0,u=s.length;c<u;c++)e(s[c],d)}}var t=this._root,n=[];return e(t,{}),n},getSelection:function(){function e(t,n){var o=t.element.getAttribute("data-filter"),a=t.getParent();if(!a)return n;n[o]=t.id,e(a,n)}var t=this._selectionNode,n={};return!!t&&(e(t,n),n)},clear:function(e){var t=this.getRoot();!function t(n){n.setCheckedState(e),n.setIconState("default"),n.deselect();var o=n.getControls();if(o&&o.length>0)for(var a=0;a<o.length;a++)t(o[a])}(t)}},e.Tree=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Toolbar"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Tree"),n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),o=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),a=function(t){e.Toolbar.call(this,t),this._opt=Object.assign({},t),t.hasCheckbox&&(this._checkedState=t.isChecked?"checked":"unchecked"),this._iconState=!0;var n=o.create("div","bf-tree-node bf-collapse");this._enabled=t.enabled,this._selection=t.selection,this._selectionState="unSelected",this._datas=t.datas,this.treeNode=n};n.Type.inheritPrototype(a,e.Toolbar),a.prototype.setData=function(e,t){var n=this,a=this._opt,i=this.treeNode;if(a.hasCheckbox){var r=a.isChecked?"bf-checked":"",l=o.create("span","bf-label "+r);l.innerHTML='<input type="checkbox" checked="'+a.isChecked+'"><span class="bf-checkbox"></span>',this.checkbox=l,i.appendChild(l),l.addEventListener("click",function(e){var t=l.getElementsByTagName("input")[0].checked,o=t?"unchecked":"checked";n.setCheckedState(!t),n.eventManager.fireEvent("CheckedChanged",o,n)})}var s=o.create("span","bf-tree-name");if(t=t||BimfaceLanguage.bf_panel_modelTree_nameUndefined,s.textContent=t,n.setTitle(t),s.addEventListener("click",function(e){if(n._enabled)if(n._selection){var t=this.hasClass("bf-selected");t?n.deselect():n.select(),t=!t,n._selectionState=t?"selected":"unselected",n.eventManager.fireEvent("SelectionChanged",n,t)}else n.toggleExpansion()}),a.icon&&(this.icon=a.icon,i.appendChild(a.icon.element),this.icon.addEventListener("Change",function(e){n._iconState="default"==e,n.setChildrenIconState(e),n.eventManager.fireEvent("IconChanged",n,e)})),a.hasExpand){var d=o.create("span","bf-icon"),i=this.treeNode;d.addEventListener("click",function(){n.toggleExpansion();var e=void 0;e=!i.hasClass("bf-collapse"),n.eventManager.fireEvent("ExpandChanged",n,e)}),i.appendChild(d)}i.appendChild(s),this.element.appendChild(i),this.treeName=s,this.id=e,this.name=t},a.prototype.addChildNode=function(e){var t=this;if(this._controls.push(e),e._parent=this,!this.subTree){var n=o.create("span","bf-icon"),a=this.treeNode;n.addEventListener("click",function(){t.toggleExpansion()}),a.insertBefore(n,this.treeNode.children[0]),this.subTree=o.create("div","bf-sub-tree"),this.element.appendChild(this.subTree)}this.subTree.appendChild(e.element),e.addEventListener("CheckedChanged",function(e,n){n._opt.propagation&&t.setParentCheckedState(n),t.eventManager.fireEvent("CheckedChanged",e,n)}),e.addEventListener("SelectionChanged",function(e,n,o){t.eventManager.fireEvent("SelectionChanged",e,n,o)}),e.addEventListener("IconChanged",function(n,o){e._opt.propagation&&t.setParentIconState(e),t.eventManager.fireEvent("IconChanged",n,o)})},a.prototype.removeChildNode=function(e){var t=this._controls.getObjectByAttribute("id",e);this.subTree.removeChild(t.element),this._controls.removeObjectByAttribute("id",e)},a.prototype.getChildNode=function(){return this.subTree},a.prototype.getCheckedState=function(){return this._checkedState},a.prototype.getIconState=function(){return this._iconState},a.prototype.getSelectionState=function(){return this._selectionState},a.prototype.getConfig=function(){return this._opt},a.prototype.getParent=function(){return!!this._parent&&this._parent},a.prototype.setCheckedState=function(e){var t=this._opt;this._checkedState=e?"checked":"unchecked",t.hasCheckbox&&this.checkbox&&(this.checkbox.getElementsByTagName("input")[0].checked=e,this.checkbox.toggleClass("bf-checked",e),this.checkbox.toggleClass("bf-unchecked",!e),this.checkbox.removeClass("bf-half")),this.setChildrenCheckedState(e)},a.prototype.setIconState=function(e){this.icon&&(this.icon.setState(e),this.setChildrenIconState(e),this._iconState="default"==e)},a.prototype.setParentCheckedState=function(e){var t=this.getControls();if(t&&t.length>0){for(var n,o=0,a=t.length;o<a;o++){var i=t[o].getCheckedState();n?i!=n&&(n="half"):n=i}this._checkedState=n}switch(this._checkedState){case"checked":this.checkbox.getElementsByTagName("input")[0].checked=!0,this.checkbox.addClass("bf-checked"),this.checkbox.removeClass("bf-unchecked"),this.checkbox.removeClass("bf-half");break;case"unchecked":this.checkbox.getElementsByTagName("input")[0].checked=!1,this.checkbox.addClass("bf-unchecked"),this.checkbox.removeClass("bf-checked"),this.checkbox.removeClass("bf-half");break;case"half":this.checkbox.getElementsByTagName("input")[0].checked=!0,this.checkbox.addClass("bf-half"),this.checkbox.removeClass("bf-unchecked"),this.checkbox.removeClass("bf-checked")}},a.prototype.setChildrenCheckedState=function(e){var t=this.getControls(),n=t.length;if(t&&n>0)for(var o=0;o<n;o++)t[o].setCheckedState(e)},a.prototype.setParentIconState=function(e){var t=this.getControls();if(t&&t.length>0){for(var n=!1,o=0,a=t.length;o<a;o++){var i=t[o].getIconState();if(i){n=i;break}}this._iconState=n}n?this.icon.setState("default"):this.icon.setState("change")},a.prototype.setChildrenIconState=function(e){var t=this.getControls(),n=t.length;if(t&&n>0)for(var o=0;o<n;o++)t[o].setIconState(e)},a.prototype.expand=function(){var e=this;this.treeNode.removeClass("bf-collapse"),this.eventManager.fireEvent("Expand",e)},a.prototype.collapse=function(){var e=this;this.treeNode.addClass("bf-collapse"),this.eventManager.fireEvent("Collapse",e)},a.prototype.toggleExpansion=function(e){var t=this;this.treeNode.hasClass("bf-collapse")?t.expand():t.collapse()},a.prototype.select=function(){if(this._selection)return this.treeName.addClass("bf-selected")},a.prototype.deselect=function(){this.treeName&&this.treeName.removeClass("bf-selected")},a.prototype.disabled=function(){this._enabled=!1,this.treeName.addClass("bf-disabled")},a.prototype.enabled=function(){this._enabled=!0,this.treeName.removeClass("bf-disabled")},a.prototype.addNode=function(e){this.treeNode.appendChild(e)},a.prototype.removeNode=function(e){this.treeNode.appendChild(e)},a.prototype.setAttribute=function(e,t){this.treeNode.setAttribute(e,t)},t.TreeNode=a}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Tree"),t=new Glodon.Bimface.UI.Control.ControlConfig,n=function(){var e={className:"bf-tree",title:"tree",icon:null,hasCheckbox:!0,isChecked:!0,enabled:!0,selection:!0,propagation:!0,hasExpand:!1};return Object.assign(t,e)};e.TreeNodeConfig=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Select"),t=new Glodon.Bimface.UI.Control.ControlConfig,n=function(){var e={className:"bf-select",options:["请选择"],prefix:"",suffix:"",default:null};return Object.assign({},t,e)};e.SelectConfig=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Control"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Select"),n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),o=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),a=function(t){this._controls=t.options,e.Control.call(this,t);var n=this;n._opt=t;var a=o.create("span","bf-select-current");a.addEventListener("click",function(){a.toggleClass("bf-open")}),document.addEventListener("mousedown",function(e){e.target.closest(".bf-select")||a.removeClass("bf-open")}),n._currentElement=a,t.default?n.setCurrentOption(t.default):n.setCurrentOption(t.options[0].id);for(var i=o.create("ul","bf-select-list bf-scroll-bar"),r=n._controls,l=0,s=r.length;l<s;l++){var d=n.createElement(r[l]);i.appendChild(d)}n.element.appendChild(n._currentElement),n.element.appendChild(i),t.element&&t.element.appendChild(n.element)};n.Type.inheritPrototype(a,e.Control),a.prototype.setCurrentOption=function(e){if(!this.currentOption||e!=this.currentOption.id){var t=this.eventManager,n=this._controls,o=n.getObjectByAttribute("id",e);0!=o&&(this.currentOption=o,this._currentElement.innerText=""+this._opt.prefix+o.name+this._opt.suffix,t.fireEvent(Glodon.Bimface.UI.Control.ControlEvent.Change,o))}},a.prototype.getCurrentOption=function(){return this.currentOption},a.prototype.createElement=function(e){var t=this,n=o.create("li","bf-select-option");return n.innerText=e.name,n.setAttribute("id",e.id),n.addEventListener("click",function(){t.setCurrentOption(e.id),t._currentElement.removeClass("bf-open")}),n},t.Select=a}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Tabs"),t=new Glodon.Bimface.UI.Control.ControlConfig,n=function(){var e={className:"bf-select",options:[{id:"default",name:"请选择",className:"bf-tabs-option",title:"请选择"}],default:null};return Object.assign({},t,e)};e.TabsConfig=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Control"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Tabs"),n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),o=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),a=function(t){this._controls=t.options,e.Control.call(this,t);var n=this,a=o.create("ul","bf-tabs-list");this.list=a;for(var i=n._controls,r=0,l=i.length;r<l;r++){var s=n.createElement(i[r]);a.appendChild(s)}t.default?n.setCurrentOption(t.default):n.setCurrentOption(t.options[0].id),n.element.appendChild(a),t.element&&t.element.appendChild(n.element)};n.Type.inheritPrototype(a,e.Control),a.prototype.setCurrentOption=function(e){for(var t=this.eventManager,n=this._controls,o=n.getObjectByAttribute("id",e),a=this.list.querySelectorAll("li"),i=0,r=a.length;i<r;i++)a[i].id==e?a[i].addClass("active"):a[i].removeClass("active");-1!=o&&(this.currentOption=o,t.fireEvent(Glodon.Bimface.UI.Control.ControlEvent.Change,o))},a.prototype.getCurrentOption=function(){return this.currentOption},
a.prototype.createElement=function(e){var t=this,n=(this.eventManager,o.create("li","bf-tabs-option "+e.className));return n.innerText=e.name,n.setAttribute("id",e.id),n.setAttribute("title",e.name),n.addEventListener("click",function(){t.getCurrentOption().id!=e.id&&t.setCurrentOption(e.id)}),n},a.prototype.addOption=function(e){if(!this._controls.getObjectByAttribute("id",e.id)){this._controls.push(e);var t=this.createElement(e);this.list.appendChild(t)}},t.Tabs=a}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Tips"),t=new Glodon.Bimface.UI.Control.ControlConfig,n=function(){var e={className:"bf-tips",element:null,html:"提示",timeOut:0};return Object.assign({},t,e)};e.TipsConfig=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Control"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Tips"),n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),o=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),a=function(t){e.Control.call(this,t);var n=this,a=this.element,i=o.create("div","bf-tips-container"),r=o.create("div","bf-close");i.innerHTML=t.html,a.appendChild(i),a.appendChild(r),r.addEventListener("click",function(){n.hide()}),this.container=i,this.timeOut=t.timeOut,this.show()};n.Type.inheritPrototype(a,e.Control),a.prototype.close=function(){this.element.remove()},a.prototype.hide=function(){this.element.style.display="none"},a.prototype.show=function(){var e=this;e.element.style.display="",e.timeOut&&(clearTimeout(e.counter),e.counter=setTimeout(function(){e.hide()},e.timeOut))},a.prototype.getHtml=function(e){this.container.innerHTML=e},a.prototype.setHtml=function(e){return this.container.innerHTML},t.Tips=a}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=function(){var e={Toolbars:["MainToolbar","ModelTree"],navigatorType:"",Buttons:["Home","RectangleSelect","Measure","Section","Walk","Map","Property","Setting","Information","FullScreen"],effectMode:"performance"},t=Glodon.Bimface.Viewer.Viewer3DConfig();return Object.assign({},e,t)};e.WebApplication3DConfig=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=Object.freeze({ViewAdded:"ViewAdded",ViewLoading:"ViewLoading",Rendered:"Rendered",PureRender:"PureRender",ComponentsSelectionChanged:"ComponentsSelectionChanged",ComponentsHoverChanged:"ComponentsHoverChanged",MouseClicked:"MouseClicked",MouseDragged:"MouseDragged",MouseDoubleClicked:"MouseDoubleClicked",ContextMenu:"ContextMenu",RectSelection:"RectSelection",Error:"Error",AddView:"AddView",RemoveView:"RemoveView",FamilyTypeChanged:"FamilyTypeChanged",MissingDrawingElement:"MissingDrawingElement",ToolbarHomeClick:"ToolbarHomeClick",DemandLoaded:"DemandLoaded",ButtonOnToolbarClicked:"ButtonOnToolbarClicked",AxisGridHover:"AxisGridHover",FloorExplosion:"FloorExplosion",Hover:"Hover",MouseMove:"MouseMove",ViewChanged:"ViewChanged",ModelAdded:"ModelAdded"});e.WebApplication3DEvent=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Viewer"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom")),n=Glodon.Bimface.Data.StatisticsDataManager.getInstance(),o=function(e){e.navigatorType&&Glodon.Web.Lang.Utility.ClientHelper.setNavigatorType(e.navigatorType);var o,a=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop();if(a)o=t.create("div","bf-container");else{e.Toolbars=["MainToolbar","ModelTree"],e.Buttons=["Home","ViewButton","Measure","Section","Walk","MobileProperty"],e.enableViewHouse=!1,o=t.create("div","bf-container  bf-mobile ");var i=e.domElement.offsetWidth,r=e.domElement.offsetHeight;o.style.fontSize=90*Math.min(i,r,414)/750+"px"}var l=this,s=e;e.domElement.appendChild(o),s.domElement=o,this.getViewer=function(){return d},this.getEventManager=function(){return u},this.getToolbars=function(){return l.UI.getToolbars()},this.getToolbar=function(e){return"LeftToolbar"==e&&(e="ModelTree"),l.UI.getToolbar(e)},this.getPanel=function(e){return l.UI.getPanel(e)},this.getPlugin=function(e){return l.UI.getPlugin(e)},this.render=function(){this.getViewer().render()},this.addView=function(e,t,n){d.addView(e,t,n)},this.getAnnotationManager=function(){return l.getPlugin("Annotation")},this.destroy=function(){this.UI.destroy(),this.UI=null,d.destroy(),d=null,o.onclick=null,o.remove()},this.addEventListener=Glodon.Bimface.Viewer.Viewer3D.prototype.addEventListener,this.removeEventListener=Glodon.Bimface.Viewer.Viewer3D.prototype.removeEventListener;var d=new Glodon.Bimface.Viewer.Viewer3D(s),c=Glodon.Bimface.Viewer.Viewer3DEvent,u=d.getEventManager();d.addEventListener(c.ViewAdded,function(){l.UI.init();var e=d.getViewer(),t=e.getNumOfElements(),o=e.getNumOfTriangles(),a=void 0,i=d._data.modelType;a="singleMode"==i?"model":i;var r={eventId:"加载",loadModel:"normal",type:a,elements:t,triangles:o};n.send("Glodon.Bimface.Application.WebApplication3D","ViewAdded",r)}),d.addEventListener(c.ViewChanged,function(){l.UI&&l.UI.updateModelTree()}),d.addEventListener(c.AddView,function(t){if(1===t){var n=new Glodon.Bimface.Application.UI.UIConfig;n=Object.assign(n,e),n.element=o,n.viewer=d,l.UI=new Glodon.Bimface.Application.UI.UI(n)}}),d.addEventListener(c.RemoveView,function(e){0==e&&(l.UI.destroy(),l.UI=null)}),a&&(o.onclick=function(){var e=document.activeElement,t=document.getElementById("cloud-main-canvas");t&&e!=t&&"INPUT"!=e.tagName&&"TEXTAREA"!=e.tagName&&t.focus()})};e.WebApplication3D=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=function(){var e={Toolbars:["MainToolbar"],Buttons:["Home","Measure","Section","Explode","Setting","FullScreen"],EnableFamilyList:!0},t=Glodon.Bimface.Viewer.Viewer3DConfig();return t.enableExplosion=!0,Object.assign({},e,t)};e.WebApplicationRfaConfig=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=Object.freeze({ViewAdded:"ViewAdded",ViewLoading:"ViewLoading",ComponentsSelectionChanged:"ComponentsSelectionChanged",ComponentsHoverChanged:"ComponentsHoverChanged",Error:"Error"});e.WebApplicationRfaEvent=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=Glodon.Bimface.UI.Control.ControlEvent,a=new Glodon.Bimface.UI.Button.ButtonConfig;a.id="Home",a.title=BimfaceLanguage.bf_btn_home,a.className="bf-button gld-bf-home";var i=new Glodon.Bimface.UI.Button.Button(a);if("ViewerDrawing"==n.viewerType)i.addEventListener(o.Click,function(){n.home()});else{var r=n instanceof Glodon.Bimface.Viewer.Viewer3D,l=Glodon.Bimface.Viewer.Viewer3DEvent;i.addEventListener(o.Click,function(){var e=t.getControl("ViewButton");e&&e.recover();var o=t.getControl("Interactive");if(o&&o.hideDropDownList(),r){if(n.getViewHouseIsLoaded())n.getEventManager().fireEvent(l.ToolbarHomeClick);else{var a=n.getCustomHomeview()||n.getDefaultHomeview();n.setCameraStatus(a)}}else n.home()})}return i};e.Home=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=n instanceof Glodon.Bimface.Viewer.Viewer3D,a=Glodon.Bimface.UI.Control.ControlEvent;if(!o)return void console.log("The API is not supported on this viewer.");var i=Glodon.Bimface.Viewer.NavigationMode3D,r={OrbitPoint:i.PickWithRect,OrbitCamera:i.Fly},l=new Glodon.Bimface.UI.Button.ButtonConfig;l.id="OrbitButton",l.title="导航",l.inheritTitle=!0;var s=new Glodon.Bimface.UI.Button.ComboBox(l),d=new Glodon.Bimface.UI.Button.ButtonConfig;d.id="OrbitPoint",d.title="绕构件旋转",d.className="bf-button gld-bf-orbitpoint";var c=new Glodon.Bimface.UI.Button.ComboBoxOptionButton(d),u=new Glodon.Bimface.UI.Button.ButtonConfig;u.id="OrbitCamera",u.title="绕相机旋转",u.className="bf-button gld-bf-orbitcamera";var p=new Glodon.Bimface.UI.Button.ComboBoxOptionButton(u);return s.addControl(c),s.addControl(p),s.addEventListener(a.Change,function(e){t.getControl("Section").setCheckedState(!1),n.setNavigationMode(r[e.id])}),s};e.OrbitButton=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=(e.getRootElement(),n instanceof Glodon.Bimface.Viewer.Viewer3D),a=Glodon.Bimface.UI.Control.ControlEvent;if(!o)return void console.log("The API is not supported on this viewer.");var i=new Glodon.Bimface.UI.Button.ButtonConfig;i.id="Home",i.title="Home",i.className="bf-button gld-bf-scene";var r=new Glodon.Bimface.UI.Button.ComboBoxOptionButton(i),l=new Glodon.Bimface.UI.Button.ButtonConfig;l.id="ViewButton",l.title="视角",l.className="bf-combobox viewButton",l.inheritTitle=!0,l.home=r;var s=new Glodon.Bimface.UI.Button.TouchComboBox(l);s.element.addClass(BimfaceLanguage.name);var d={Top:"top",Bottom:"bottom",East:"right",South:"front",West:"left",North:"back"};for(var c in d){var u=d[c],p=new Glodon.Bimface.UI.Button.ButtonConfig;p.id=c,p.title=c,p.className="bf-button";var f=new Glodon.Bimface.UI.Button.ComboBoxOptionButton(p);f.setHtml('<svg class="gld-bf-scene-inner"><use class="" xlink:href="#gld-bf-scene-'+u+'"></use></svg>'),s.addControl(f)}return s.addEventListener(a.Change,function(e){n.setView(e.id)}),document.querySelector(".bf-mobile").addEventListener("touchstart",function(e){if("canvas"==e.target.tagName.toLowerCase()){var t=document.querySelector(".gld-bf-view.bf-checked");t&&t.click()}}),s};e.ViewButton=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=n instanceof Glodon.Bimface.Viewer.Viewer3D,a=Glodon.Bimface.UI.Control.ControlEvent,i=Glodon.Bimface.Viewer.Viewer3DEvent;if(!o)return void console.log("The API is not supported on this viewer.");var r=new Glodon.Bimface.UI.Button.ButtonConfig;r.id="RectangleSelect",r.title=BimfaceLanguage.bf_btn_zoom,r.className="bf-button gld-bf-zoomrect";var l=new Glodon.Bimface.UI.Button.ToggleButton(r),s=function(e){e.end&&l.setCheckedState(!1)};return l.addEventListener(a.StateChange,function(e){e?(n.enableZoomRect(!0),n.addEventListener(i.RectSelection,s)):(n.enableZoomRect(!1),n.removeEventListener(i.RectSelection,s))}),l};e.RectangleSelect=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=Glodon.Bimface.UI.Control.ControlEvent,a=Glodon.Bimface.Viewer.ViewerDrawingEvent,i=new Glodon.Bimface.UI.Button.ButtonConfig;i.id="RectZoom",i.title=BimfaceLanguage.bf_btn_zoom,i.className="bf-button gld-bf-zoomrect";var r=new Glodon.Bimface.UI.Button.ToggleButton(i),l=function(){setTimeout(function(){r.setCheckedState(!1)},200)};return r.addEventListener(o.StateChange,function(e){if(e)n.rectZoom(),n.addEventListener(a.ViewZoomed,l);else{var o=t.getControl("Measure");o&&o._checked?n.getViewer().mouseEditorMgr.activeEditorByName("measure"):n.getViewer().mouseEditorMgr.activeEditorByName("pick"),n.removeEventListener(a.ViewZoomed,l)}}),r};e.RectZoom=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),t=function(e,t,n,o){var a=this,i=Glodon.Bimface.Viewer.Viewer3DEvent,r=function(e){for(var t=[],n=0;n<e.length;n++){for(var o=e[n].name,a=e[n].parameters,i=[],r=0;r<a.length;r++)i=i.concat(a[r].items);t=t.concat([{group:o,items:i}])}return t},l=function(){p._tab&&"components"!=p._tab.getCurrentOption().id?p.setTips(BimfaceLanguage.bf_panel_props_matSel):p.setTips(BimfaceLanguage.bf_panel_props_propSel)},s=function(t){var n=void 0;return e.getModels().some(function(e){var o=[];if(o=t?t[e.modelId]||[]:e.getSelectedComponents(),n||1!==o.length){if(o.length>1||1===o.length&&n&&n.id!==o[0])return n=void 0,!0}else n={modelId:e.modelId,id:o[0]}}),n},d=function(t,n){var o=n?t:s(t);if(p.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),p.clear(),!o)return l(),p.setData("");!p._tab||p._tab&&"components"==p._tab.getCurrentOption().id?e.getModel(o.modelId).getComponentProperty(o.id,function(e){p.setTips(BimfaceLanguage.bf_panel_props_propSel),p.setData(e.properties)},function(e){l(),p.setData("")}):(!p._tab||p._tab&&"components"!=p._tab.getCurrentOption().id)&&(t?e.getModel(o.modelId).getMaterialProperty(o.id,function(e){if(p.setTips(BimfaceLanguage.bf_panel_props_matSel),e&&e.length>0){var t=r(e);p.setData(t,!0)}else p.setData("")},function(){p.setTips(BimfaceLanguage.bf_panel_props_matSel),p.setData("")}):p.setData(""))},c=function(t){var n=s();if(!n)return"components"==t?p.setTips(BimfaceLanguage.bf_panel_props_propSel):p.setTips(BimfaceLanguage.bf_panel_props_matSel),p.setData("");"components"==t?d(n,!0):(p.setData(""),e.getModel(n.modelId).getMaterialProperty(n.id,function(e){if(e&&e.length>0){var t=r(e);p.setData(t,!0)}else l(),p.setData("")},function(){l(),p.setData("")}))};if(p)return p.show(),e.addEventListener(i.ComponentsSelectionChanged,d),p;var u=new Glodon.Bimface.UI.Panel.PanelConfig;u.title=BimfaceLanguage.bf_btn_props,u.className="bf-panel property-panel",u.css=o?{left:0,top:0,width:"100%",height:"100%"}:{right:"10px",top:"10px",width:"300px",height:"416px"};var p=new Glodon.Bimface.UI.Panel.Panel(u);p.setTips(BimfaceLanguage.bf_panel_props_propSel),e.propertyPanel=p,p.addClass("property-panel"),p.addClass("bf-property-panel");var f=[{id:"components",name:BimfaceLanguage.bf_panel_props_props},{id:"material",name:BimfaceLanguage.bf_panel_props_mats}];if(!a._tab&&e._manifest.Features.HasMaterialProperty){var h=new Glodon.Bimface.UI.Tabs.TabsConfig;h.className="bf-property-tab",h.default="components",h.options=f;var m=new Glodon.Bimface.UI.Tabs.Tabs(h);m.addEventListener(Glodon.Bimface.UI.Control.ControlEvent.Change,function(e){c(e.id)}),p._tab=m,p.setContainerHeader(m.element)}return c("components"),e.addEventListener(i.SelectionChangedInModel,d),p.addEventListener("Hide",function(){e.removeEventListener(i.SelectionChangedInModel,d)}),p};e.PropertyPanel=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=e.getRootElement(),a=n instanceof Glodon.Bimface.Viewer.Viewer3D,i=Glodon.Bimface.UI.Control.ControlEvent,r=Glodon.Bimface.Viewer.Viewer3DEvent;if(!a)return void console.log("The API is not supported on this viewer.");var l=new Glodon.Bimface.UI.Button.ButtonConfig;l.id="Property",l.title=BimfaceLanguage.bf_btn_props,l.className="bf-button gld-bf-properties";var s,d=new Glodon.Bimface.UI.Button.ToggleButton(l);return d.addEventListener(i.StateChange,function(a){a?(s=new Glodon.Bimface.Application.UI.Panel.PropertyPanel(n,o,t),s.addEventListener("Hide",function(){d.setCheckedState(!1)}),o.appendChild(s.element),s.bringToFront(),s.initPosition(),e.addPanel(s)):(s.close(),e.removePanel(s.id)),n.getEventManager().fireEvent(r.ButtonOnToolbarClicked,{id:l.id,isChecked:a})}),d};e.Property=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=e.getRootElement(),a=n instanceof Glodon.Bimface.Viewer.Viewer3D,i=Glodon.Bimface.UI.Control.ControlEvent;if(!a)return void console.log("The API is not supported on this viewer.");var r=new Glodon.Bimface.UI.Button.ButtonConfig;r.id="MobileProperty",r.title="属性",r.className="bf-button gld-bf-properties";var l,s=new Glodon.Bimface.UI.Button.ToggleButton(r);return s.addEventListener(i.StateChange,function(){s.isChecked()?(l=new Glodon.Bimface.Application.UI.Panel.PropertyPanel(n,o,t,!0),l.addEventListener("Hide",function(){"none"!=l.element.style.display&&o.removeChild(l.element),s.setCheckedState(!1)}),o.appendChild(l.element),e.addPanel(l)):(o.removeChild(l.element),e.removePanel(l.id))}),s};e.MobileProperty=t}();var MeasureResultFormat=function e(){_classCallCheck(this,e)};MeasureResultFormat.formatDistance=function(e,t){if(void 0==e)return null;var n=t.precision,o=t.scale||1,a=t.unit,i=t.defaultUnit,r=1;return"Centimeter"===a?r=10:"Meter"===a?r=1e3:"Kilometer"===a&&(r=1e6),"m"===i&&(o*=1e3),e*=o,e/=r,this.formatPrecision(e,n)},MeasureResultFormat.formatArea=function(e,t){var n=t.precision,o=t.scale,a=t.unit,i=t.defaultUnit,r=1;return"Centimeter"===a?r=100:"Meter"===a?r=1e6:"Kilometer"===a&&(r=1e13),"m"===i&&(o*=1e3),e*=Math.pow(o,2),e/=r,this.formatPrecision(e,n)},MeasureResultFormat.getPostFix=function(e,t){if("None"===e)return"";var n={None:"",Kilometer:"km",Meter:"m",Centimeter:"cm",Millimeter:"mm"},o=n[e];return t?o+="²":o=" "+o,o},MeasureResultFormat.toLocaleString=function(e){var t=e.toString(),n=/\d{1,3}(?=((\d{3})+(\.\d+)?)$)/g;return t=t.replace(n,"$&,")},MeasureResultFormat.formatPrecision=function(e,t){if(e=parseInt(Math.round(e*Math.pow(10,t)))/Math.pow(10,t),0!=t){var n=e.toFixed(t).split(".");e=n[0]+"."+n[1]}else e=this.toLocaleString(e);return e},function(){var e,t,n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),o=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),a=function(o,a){var i=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop();t=o._opt.viewer;var r,l=n.create("div","bf-tab-container"),s=n.create("div","bf-tab-body"),d=n.create("div","bf-tab-foot"),c=n.create("ul","bf-measure-tab"),u=n.create("div","bf-measure-tabface");u.innerHTML='<li class="bf-measure-tab-item" data-type="Distance">\n                            <i class="gld-bimface gld-bf-distance" ></i>\n                        </li>',c.innerHTML='<li class="bf-measure-tab-item bf-active" data-type="Distance">\n                  <i class="gld-bimface gld-bf-distance" title="'+BimfaceLanguage.bf_tip_measure_distance+'"></i>\n                </li>\n                <li class="bf-measure-tab-item" data-type="MinimumDistance">\n                  <i class="gld-bimface gld-bf-distance-min" title="'+BimfaceLanguage.bf_tip_measure_mindis+'"></i>\n                </li>\n                <li class="bf-measure-tab-item" data-type="Angle">\n                  <i class="gld-bimface gld-bf-angle" title="'+BimfaceLanguage.bf_tip_measure_angle+'"></i>\n                </li>\n                <li class="bf-measure-tab-item" data-type="Elevation">\n                  <i class="gld-bimface gld-bf-elevation" title="'+BimfaceLanguage.bf_tip_measure_elevation+'"></i>\n                </li>';for(var p=c.querySelectorAll(".bf-measure-tab-item"),f=0;f<p.length;f++)p[f].addEventListener("click",function(){for(var e=0;e<p.length;e++)p[e].removeClass("bf-active");var t=this.getAttribute("data-type");this.addClass("bf-active"),o.setMeasureType(t);var n=o.getSelectedItem(),a=n&&n.type==t?o.drawableManager.mapMeasureInfo[n.getId()]:{};C(t,a)});d.innerHTML='<div class="settingBtn">'+BimfaceLanguage.bf_panel_measure_clearAll+"<div>",d.addEventListener("click",function(){o.clear()});var h=n.create("span","bf-clear-all gld-bf-measure-settings");h.addEventListener("click",function(e){v(),e.preventDefault(),e.stopPropagation()}),l.appendChild(c),l.appendChild(s),i&&(l.appendChild(d),d.appendChild(h));var m={Millimeter:"mm",Centimeter:"cm",Meter:"m",Kilometer:"km"},g=function(e){if(e){r.setTitleContent(BimfaceLanguage.bf_btn_measure);var t=r.element.querySelector(".bf-close");t.style.display="block",b.style.display="none",l.style.display="block"}else{var t=r.element.querySelector(".bf-close");t.style.display="none",r.setTitleContent(BimfaceLanguage.bf_panel_measure_setting),b.style.display="block",l.style.display="none"}},v=function(e){g(!1);var t,n=o.getUnits(),a=o.getPrecision();"object"==(void 0===a?"undefined":_typeof(a))&&(a=a.distance),t='<ul class="bf-measure-setting">\n                <li class="bf-measure-lengthUnits">\n                  <span >'+BimfaceLanguage.bf_panel_measure_units+" :</span>\n                  <div class = 'unit'></div>\n                </li>\n                <li class=\"bf-measure-prompt\">"+BimfaceLanguage.bf_panel_measure_unitsTip+'</li>\n                <li class="bf-measure-precision">\n                  <span >'+BimfaceLanguage.bf_panel_measure_precision+" :</span>\n                  <div class = 'unit'></div>\n                </li>\n\n              </ul>",y.innerHTML=t;var i={type:"ComboBox",id:"units",inheritTitle:!0,className:"bf-combobox",options:{},handles:{Change:function(e){}}},r=new Glodon.Bimface.Application.Button(i);for(var l in m){var s=m[l],d={type:"ComboBoxOptionButton",title:s,id:l,className:"bf-button",html:'<span class="bf-button-name">'+s+"</span>"};r.addControl(new Glodon.Bimface.Application.Button(d))}r.setSelectedControlById(n.distance),y.querySelector(".bf-measure-lengthUnits .unit").appendChild(r.element),r.element.onclick=function(){u.element.removeClass("bf-expand")};var c={type:"ComboBox",id:"units",inheritTitle:!0,className:"bf-combobox",options:{},handles:{Change:function(e){}}},u=new Glodon.Bimface.Application.Button(c),p={0:"0",1:"0.0",2:"0.00",3:"0.000"};for(var l in p){var s=p[l],d={type:"ComboBoxOptionButton",title:s,id:l.toString(),className:"bf-button",html:'<span class="bf-button-name">'+s+"</span>"};u.addControl(new Glodon.Bimface.Application.Button(d))}u.setSelectedControlById(a),y.querySelector(".bf-measure-precision .unit").appendChild(u.element),u.element.onclick=function(){r.element.removeClass("bf-expand")},w.innerHTML="<div class=\"bf-measure-btns\">\n                                    <span class= 'save'>"+BimfaceLanguage.bf_panel_measure_save+" </span> <span class= cancel>"+BimfaceLanguage.bf_general_cancel+"</span>\n                               </div>",w.querySelector(".save").onclick=function(){var e=u.getCurrentControl().id,t=r.getCurrentControl().id;o.setPrecision({distance:e,elevation:e,angle:e}),o.setUnits({distance:t,elevation:t}),g(!0),C(o.type,{}),o.getEventManager().fireEvent("MeasureParamsUpdated")},w.querySelector(".cancel").onclick=function(){g(!0)}},b=n.create("div","bf-setting-container"),y=n.create("div","bf-setting-body"),w=n.create("div","bf-setting-foot");b.appendChild(y),b.appendChild(w);var C=function(e,t){var n=void 0,a=o.getUnits(),i="None"!=a.distance&&"<span class='units'>"+m[a.distance]+"</span>"||"",r="None"!=a.elevation&&"<span class='units'>"+m[a.elevation]+"</span>"||"";switch(e){case Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Distance:var l=void 0!==t.distance?M(t.distance):"--",d=void 0!==t.distanceX?M(t.distanceX):"--",c=void 0!==t.distanceY?M(t.distanceY):"--",u=void 0!==t.distanceZ?M(t.distanceZ):"--";n='<ul class="bf-measure-info">\n                  <li class="bf-measure-distance">'+BimfaceLanguage.bf_panel_measure_distance+'：\n                    <span class="bf-measure-value">'+l+"</span>"+i+'\n                    <span class="bf-measure-reset gld-bimface gld-bf-reset-box" title="'+BimfaceLanguage.bf_tip_section_resetBox+'"><span>\n                  </li>\n                  <li class="bf-measure-x">X： '+d+'</li>\n                  <li class="bf-measure-y">Y： '+c+'</li>\n                  <li class="bf-measure-z">Z： '+u+"</li>\n                </ul>",s.innerHTML=n,s.querySelector(".gld-bf-reset-box").addEventListener("click",function(){o.reset()});break;case Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Angle:var p=void 0!==t.angle?MeasureResultFormat.formatPrecision(t.angle,o.getMeasureParams().precision):"--";n='<ul class="bf-measure-info">\n                    <li class="bf-measure-distance">'+BimfaceLanguage.bf_panel_measure_angle+'：\n                      <span class="bf-measure-value">'+p+'</span> °\n                      <span class="bf-measure-reset gld-bimface gld-bf-reset-box" title="'+BimfaceLanguage.bf_tip_section_resetBox+'"><span></li>\n                  </ul>',s.innerHTML=n,s.querySelector(".gld-bf-reset-box").addEventListener("click",function(){o.reset()});break;case Glodon.Bimface.Plugins.Measure.MeasureTypeOption.MinimumDistance:var l=void 0!==t.distance?M(t.distance):"--";n='<ul class="bf-measure-info">\n                    <li class="bf-measure-distance">'+BimfaceLanguage.bf_panel_measure_mindis+'：\n                      <span class="bf-measure-value">'+l+"</span>"+i+"\n                    </li>\n                  </ul>",s.innerHTML=n;break;case Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Elevation:var f="--";t.points&&(f=M(t.points[0].z),0==f.split(" ")[0]&&(f="±"+f)),n='<ul class="bf-measure-info">\n                    <li class="bf-measure-distance">'+BimfaceLanguage.bf_panel_measure_elevation+'：\n                    <span class="bf-measure-value">'+f+"</span> "+r+'\n                    <span class="bf-measure-reset gld-bimface gld-bf-reset-box" title="'+BimfaceLanguage.bf_tip_section_resetBox+'"><span>\n                    </li>\n                  </ul>',s.innerHTML=n,s.querySelector(".gld-bf-reset-box").addEventListener("click",function(){o.reset()})}},M=function(e){return MeasureResultFormat.formatDistance(e,o.getMeasureParams())},B=new Glodon.Bimface.UI.Panel.PanelConfig;if(B.title=BimfaceLanguage.bf_btn_measure,B.id="MeaurePanel",B.css=i?{right:"10px",bottom:"270px",width:"200px",height:"240px"}:{maxWidth:"414px",left:"50%",transform:"translate(-50%)",bottom:"0.12em",width:"100%",height:"2em"},B.enableSizable=!1,B.className="bf-panel bf-measurement-panel",o.addEventListener(Glodon.Bimface.Plugins.Measure.MeasureEvent.Measuring,function(e){C(e.type,{})}),o.addEventListener(Glodon.Bimface.Plugins.Measure.MeasureEvent.Measured,function(e){C(e.type,e),e.type==Glodon.Bimface.Plugins.Measure.MeasureTypeOption.MinimumDistance&&(o.measureItem.setMinDistanceLine(e),o.measureItem.draw())}),o.addEventListener(Glodon.Bimface.Plugins.Measure.MeasureEvent.MeasureSelected,function(e){var t=c.querySelectorAll(".bf-measure-tab-item"),n=!0,a=!1,i=void 0;try{for(var r,l=t[Symbol.iterator]();!(n=(r=l.next()).done);n=!0){r.value.removeClass("bf-active")}}catch(e){a=!0,i=e}finally{try{!n&&l.return&&l.return()}finally{if(a)throw i}}var s=!0,d=!1,u=void 0;try{for(var p,f=t[Symbol.iterator]();!(s=(p=f.next()).done);s=!0){var h=p.value;if(h.getAttribute("data-type")===e.type){h.addClass("bf-active");break}}}catch(e){d=!0,u=e}finally{try{!s&&f.return&&f.return()}finally{if(d)throw u}}o.setMeasureType(e.type),C(e.type,e)}),o.addEventListener(Glodon.Bimface.Plugins.Measure.MeasureEvent.MeasureUnselected,function(e){C(o.type,{})}),o.addEventListener(Glodon.Bimface.Plugins.Measure.MeasureEvent.Reset,function(){C(o.getMeasureType(),{})}),r=new Glodon.Bimface.UI.Panel.Panel(B),t=o._opt.viewer,r.container.appendChild(l),r.container.appendChild(b),!i){var k=a.offsetWidth,T=a.offsetHeight;r.element.style.fontSize=100*Math.min(k,T,414)/750+"px",r.element.addClass("measure-panel");var L=r.element.querySelector(".bf-measure-tab"),x=r.element.querySelector(".bf-close");x.innerHTML="<span class='quit'>"+BimfaceLanguage.bf_general_exit+"</span>",L.measure=o,e=L.querySelectorAll(".bf-measure-tab-item");var P;L.id="measureTabs",L.addEventListener("click",function(t){L.hasClass("tab-open")?(L.removeClass("tab-open"),r.element.removeClass("tab-open")):(L.addClass("tab-open"),r.element.addClass("tab-open")),t.target.hasClass("gld-bf-distance")?(P=e[0],r.element.removeClass("miniStyle"),C(Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Distance,{}),L.measure.setMeasureType(Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Distance)):t.target.hasClass("gld-bf-angle")?(P=e[2],r.element.addClass("miniStyle"),C(Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Angle,{}),L.measure.setMeasureType(Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Angle)):(P=e[3],r.element.addClass("miniStyle"),C(Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Elevation,{}),L.measure.setMeasureType(Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Elevation)),L.querySelector(".bf-active").removeClass("bf-active"),P.addClass("bf-active"),u.innerHTML="",u.appendChild(P.cloneNode(!0)),t.preventDefault(),t.stopPropagation()},!0),u.addEventListener("click",function(e){L.hasClass("tab-open")?(L.removeClass("tab-open"),r.element.removeClass("tab-open")):(L.addClass("tab-open"),r.element.addClass("tab-open"))}),x.addEventListener("click",function(e){x.click()},!0),r.element.appendChild(L),r.element.appendChild(u)}return"rfaView"==t._data.renderType&&c.addClass("bf-measure-tab-rfa"),C(o.getMeasureType(),{}),r};o.MeasurePanel=a}();var hideSectionPanel=function(e){var t=e.getToolbar("MainToolbar");if(t){var n=t.getControl("Section");if(n){var o=n.getToolbar();if(o){o.getControl("SectionBox").setCheckedState(!1);o.getControl("SectionPlane").setCheckedState(!1);o.getControl("PickSectionPlane").setCheckedState(!1)}else n.setCheckedState(!1)}}},clearSection=function(e){hideSectionPanel(e),clearSectionPlane(e),clearSectionBox(e)},clearSectionPlane=function(e){var t=e.getPlugin("SectionPlane");t&&(t.exit(),e.removePlugin("SectionPlane"))},clearSectionBox=function(e){var t=e.getPlugin("SectionBox");t&&(t.exit(),e.removePlugin("SectionBox"))},resetSection=function(e){var t=e.getPlugin("SectionBox"),n=e.getPlugin("SectionPlane");t&&t.restore(),n&&(n.restoreRotation(),n.setProgress(0))},updateSection=function(e,t){var n=e.getViewer(),o=e.getPlugin("SectionBox");if(!o){var a=e.getToolbar("MainToolbar");if(a){var i=a.getControl("Section");if(i){i.getToolbar().getControl("SectionBox").setCheckedState(!0),o=e.getPlugin("SectionBox")}}}o.setBox(t),n.zoomToBoundingBox(t)},getSectionState=function(e){var t=e.getPlugin("SectionBox"),n=e.getPlugin("SectionPlane"),o=e.getToolbar("MainToolbar"),a={enable:!1,button:null};(t||n)&&(a.enable=!0);var i=o.getControl("Section");if(i){var r=i.getToolbar(),l=r.getControl("SectionBox"),s=r.getControl("SectionPlane");l.isChecked()&&(a.button=l),s.isChecked()&&(a.button=s)}return a};!function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),Glodon.Web.Lang.Utility.ClientHelper.getIsIphone(),function(e,t){var n=e.getViewer(),o=e.getRootElement(),a=n instanceof Glodon.Bimface.Viewer.Viewer3D,i=Glodon.Bimface.UI.Control.ControlEvent,r=Glodon.Bimface.Viewer.Viewer3DEvent;if(!a)return void console.log("The API is not supported on this viewer.");var l=new Glodon.Bimface.UI.Button.ButtonConfig;l.id="Measure",l.title=BimfaceLanguage.bf_btn_measure,l.className="bf-button gld-bf-measure";var s,d=new Glodon.Bimface.UI.Button.ToggleButton(l),c=new Glodon.Bimface.Plugins.Measure.MeasureConfig;c.viewer=n;var u;return d.addEventListener(i.StateChange,function(a){if(a){Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop();hideSectionPanel(e);var i=t.getControl("Explode");i&&i.setCheckedState(!1),u=e.getPlugin("Measure"),u||(u=new Glodon.Bimface.Plugins.Measure.Measure(c),u.id="Measure",e.addPlugin(u)),u.switchOn(),s=new Glodon.Bimface.Application.UI.Panel.MeasurePanel(u,o),s.addEventListener("Hide",function(){d.setCheckedState(!1)}),o.appendChild(s.element),s.bringToFront(),s.initPosition(),e.addPanel(s)}else e.removePanel(s.id),s.close(),s=null,u.switchOff();n.getEventManager().fireEvent(r.ButtonOnToolbarClicked,{id:l.id,isChecked:a})}),d});e.Measure=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),Glodon.Web.Lang.Utility.ClientHelper.getIsIphone(),function(e,t){var n=e.getViewer(),o=e.getRootElement(),a=Glodon.Bimface.UI.Control.ControlEvent,i=new Glodon.Bimface.UI.Button.ButtonConfig;i.id="DrawingMeasure",i.title=BimfaceLanguage.bf_btn_measure,i.className="bf-button gld-bf-measure"
;var r,l=new Glodon.Bimface.UI.Button.ToggleButton(i),s=Glodon.Bimface.Viewer.ViewerDrawingEvent,d=new Glodon.Bimface.Plugins.Measure.MeasureConfig;d.viewer=n;var c;return l.addEventListener(a.StateChange,function(t){t?(c=e.getPlugin("DrawingMeasure"),c||(c=new Glodon.Bimface.Plugins.Measure.Measure(d),c.id="DrawingMeasure",e.addPlugin(c)),c.switchOn(),r=new Glodon.Bimface.Application.UI.Panel.DrawingMeasurePanel(c,o),r.addEventListener("Hide",function(){l.setCheckedState(!1)}),o.appendChild(r.element),r.bringToFront(),r.initPosition(),e.addPanel(r)):(e.removePanel(r.id),r.close(),r=null,c.switchOff()),n.getEventManager().fireEvent(s.ButtonOnToolbarClicked,{id:"Measure",isChecked:t})}),l});e.DrawingMeasure=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o="Viewer3D"==n.viewerType,a=(n.viewerType,Glodon.Bimface.UI.Control.ControlEvent),i=new Glodon.Bimface.UI.Button.ButtonConfig;i.id="Annotation",i.title="批注",i.className="bf-button gld-bf-notes";var r=new Glodon.Bimface.UI.Button.Button(i),l=new Glodon.Bimface.Plugins.Annotation.AnnotationToolbarConfig;l.viewer=e.getViewer();var s=self._annotation=new Glodon.Bimface.Plugins.Annotation.AnnotationToolbar(l),d=Glodon.Bimface.Plugins.Annotation.AnnotationToolbarEvent;return r._annotationManager=s.getAnnotationManager(),r._annotationToolbar=s,e._plugins.push(r),r.addEventListener(a.Click,function(){t.hide();var e=t.getControl(o&&"Measure"||"DrawingMeasure");e&&e.setCheckedState(!1),s.show(),s.addEventListener(d.Saved,function(){t.show()}),s.addEventListener(d.Cancelled,function(){t.show()})}),r};e.Annotation=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),n=function(t){var n=t.getViewer(),o=(t.getRootElement(),new Glodon.Bimface.UI.Panel.PanelConfig);o.title=BimfaceLanguage.bf_panel_section_box,o.id="SectionBoxPanel",o.css={right:"10px",bottom:"60px",width:"200px",height:"200px"},o.className="bf-panel bf-section-panel bf-sectionBox-panel",o.enableSizable=!1;var a,i=new Glodon.Bimface.UI.Panel.Panel(o),r=t.getPlugin("SectionBox");return function(){var o=Glodon.Bimface.Application.UI.Toolbar.SectionToolbarConfig(),l=Glodon.Bimface.Application.UI.Toolbar.Toolbar(o,t),s=l.getControl("SectionReset");a=l.getControl("SectionBoxVisiable"),a.setCheckedState(!1);var d=l.getControl("SectionBoxReverse");s.addEventListener(Glodon.Bimface.UI.Control.ControlEvent.Click,function(){a.setCheckedState(!1),d.setCheckedState(!1)});var c=e.create("div","bf-range-container"),u='<ul class="bf-range-list">\n        <li>\n          <span class="bf-range-name">'+BimfaceLanguage.bf_panel_section_X+'</span>\n          <div class="bf-section-range" id="sectionX"></div>\n        </li>\n        <li>\n          <span class="bf-range-name">'+BimfaceLanguage.bf_panel_section_Y+'</span>\n          <div class="bf-section-range" id="sectionY"></div>\n        </li>\n        <li>\n          <span class="bf-range-name">'+BimfaceLanguage.bf_panel_section_Z+'</span>\n          <div class="bf-section-range" id="sectionZ"></div>\n        </li>\n      </ul>';if(c.innerHTML=u,i.addControl(l),i.container.appendChild(c),r&&r._sectionBox)r.showBox(),r.update();else{if(n._sectionBox)r=n._sectionBox;else{var p=new Glodon.Bimface.Plugins.Section.SectionBoxConfig;p.viewer=n,p.id="SectionBox",r=new Glodon.Bimface.Plugins.Section.SectionBox(p)}t.removePlugin("SectionBox"),t.addPlugin(r)}n.render()}(),i.hideBox=function(){a&&a.setCheckedState(!0)},i};t.SectionBoxPanel=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=void 0;if(Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop()){var o=new Glodon.Bimface.UI.Button.ButtonConfig;o.id="Section",o.title=BimfaceLanguage.bf_btn_section,o.className="bf-button bf-toolbar-button gld-bf-sectionbox",n=new Glodon.Bimface.UI.Button.Button(o);var a=new Glodon.Bimface.UI.Toolbar.ToolbarConfig;a.id="SectionSub",a.title=BimfaceLanguage.bf_btn_section,a.className="bf-sub-toolbar",a.buttons=["PickSectionPlane","SectionPlane","SectionBox"];var t=new Glodon.Bimface.Application.UI.Toolbar.Toolbar(a,e);n.addToolbar(t)}else{var i=e.getViewer(),r=e.getRootElement(),l=i instanceof Glodon.Bimface.Viewer.Viewer3D,s=Glodon.Bimface.UI.Control.ControlEvent;if(!l)return void console.log("The API is not supported on this viewer.");var d=function(){var t=e.getPlugin("SectionBox");if(t){var n=t.getProgress("x");rangeX.setProgress({from:n[0],to:n[1]});var o=t.getProgress("y");rangeY.setProgress({from:o[0],to:o[1]});var a=t.getProgress("z");rangeZ.setProgress({from:a[0],to:a[1]})}},c=new Glodon.Bimface.UI.Button.ButtonConfig;c.id="Section",c.title=BimfaceLanguage.bf_btn_section,c.className="bf-button gld-bf-sectionbox",n=new Glodon.Bimface.UI.Button.ToggleButton(c);var u;n.addEventListener(s.StateChange,function(o){if(o){var a=t.getControl("Measure");a&&a.setCheckedState(!1);var l=t.getControl("Explode");l&&l.setCheckedState(!1),u=new Glodon.Bimface.Application.UI.Panel.SectionPlanePanel(e),u.addEventListener("Hide",function(){n.setCheckedState(!1)}),r.appendChild(u.element),u.bringToFront(),i.addEventListener("Rendered",d),e.addPanel(u)}else clearSection(e),u&&(e.removePanel(u.id),u.close(),i.render())})}return n};e.Section=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n,o,a,i=e.getViewer(),r=e.getRootElement(),l=i instanceof Glodon.Bimface.Viewer.Viewer3D,s=Glodon.Bimface.UI.Control.ControlEvent,d=Glodon.Bimface.Viewer.Viewer3DEvent;if(!l)return void console.log("The API is not supported on this viewer.");var c=function(t,n){var o=e.getPlugin("SectionBox");if(o){var a=[n.from,n.to];o.setProgress(t,a),i.render()}},u=function(){var e=i._sectionBox;if(e){var t=e.getProgress("x");n.setProgress({from:t[0],to:t[1]});var r=e.getProgress("y");o.setProgress({from:r[0],to:r[1]});var l=e.getProgress("z");a.setProgress({from:l[0],to:l[1]})}},p=function(){var n=e.getToolbar("MainToolbar"),o=n.getControl("Measure");o&&o.setCheckedState(!1);var a=n.getControl("Explode");a&&a.setCheckedState(!1);var i=t.getControl("SectionPlane");i&&i.setCheckedState(!1);var r=t.getControl("PickSectionPlane");r&&r.setCheckedState(!1);var l=e.getPlugin("SectionPlane");l&&(e.removePlugin(l.id),l.exit())},f=new Glodon.Bimface.UI.Button.ButtonConfig;f.id="SectionBox",f.title=BimfaceLanguage.bf_panel_section_box,f.className="bf-button gld-bf-sectionbox1";var h,m=new Glodon.Bimface.UI.Button.ToggleButton(f);return m.addEventListener(s.StateChange,function(t){if(t)p(),h=new Glodon.Bimface.Application.UI.Panel.SectionBoxPanel(e),h.addEventListener("Hide",function(){m.setCheckedState(!1)}),r.appendChild(h.element),h.initPosition(),n=new Glodon.Web.Lang.Utility.Dom.multipleRange({element:h.element.querySelector("#sectionX"),min:0,max:100,defaultColor:"#555555",currentColor:"#999999",change:function(e){c("x",e)}}),o=new Glodon.Web.Lang.Utility.Dom.multipleRange({element:h.element.querySelector("#sectionY"),min:0,max:100,defaultColor:"#555555",currentColor:"#999999",change:function(e){c("y",e)}}),a=new Glodon.Web.Lang.Utility.Dom.multipleRange({element:h.element.querySelector("#sectionZ"),min:0,max:100,defaultColor:"#555555",currentColor:"#999999",change:function(e){c("z",e)}}),u(),i.addEventListener("Rendered",u),e.addPanel(h),i.render();else{var l=e.getPlugin("SectionBox");l&&l.hideBox(),h&&(e.removePanel(h.id),h.close(),i.render())}i.getEventManager().fireEvent(d.ButtonOnToolbarClicked,{id:f.id,isChecked:t})}),m};e.SectionBox=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),n=function(e){return e=parseFloat(e),e<0?360+e:e},o=function(t){var o=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),a=t.getViewer(),i=t.getRootElement(),r=new Glodon.Bimface.UI.Panel.PanelConfig;r.title=BimfaceLanguage.bf_panel_section_plane,r.id="SectionPlanePanel",r.css=o?{right:"10px",bottom:"170px",width:"200px",height:"90px"}:{maxWidth:"414px",left:"50%",transform:"translate(-50%)",bottom:"0.12em",width:"100%",height:"1.02em"},r.className="bf-panel bf-section-panel bf-sectionPlane-panel",r.enableSizable=!1;var l=new Glodon.Bimface.UI.Panel.Panel(r),s=t.getPlugin("SectionPlane");if(s){var d=s.getProgress();s.setDirection(s.getDirection()),s.setPlane(s.getPlane()),s.setProgress(d)}return function(){var r=e.create("div","bf-section-plane-head"),d=new Glodon.Bimface.UI.Select.SelectConfig;if(s&&(d.default=s._plane),d.className="bf-select bf-select-axial",o){var c=new Glodon.Bimface.UI.Tabs.TabsConfig,u=e.create("div","bf-section-select");c.className="bf-tabs";var p=[{id:"X",name:"X"},{id:"Y",name:"Y"},{id:"Z",name:"Z"}];c.options=p,c.element=u;var f=new Glodon.Bimface.UI.Tabs.Tabs(c),h=new Glodon.Bimface.Application.UI.Button.SectionPlaneVisiable(t);l.toggleButton=h;var m=new Glodon.Bimface.Application.UI.Button.SectionDirection(t);f.addEventListener("Change",function(e){s&&(s.setPlane(e.id),s.coordinateSystem.update(),a.render())}),r.appendChild(u)}else{d.options=[{id:"X",name:"X"},{id:"Y",name:"Y"},{id:"Z",name:"Z"}];var g=new Glodon.Bimface.UI.Select.Select(d);l.select=g;var h=new Glodon.Bimface.Application.UI.Button.SectionPlaneVisiable(t);l.toggleButton=h;var m=new Glodon.Bimface.Application.UI.Button.SectionDirection(t);g.addEventListener("Change",function(e){s&&(s.setPlane(e.id),s.coordinateSystem.update(),a.render())}),r.appendChild(g.element)}var v=e.create("div","bf-section-range"),b=new Glodon.Web.Lang.Utility.Dom.range({element:v,min:0,max:100,cur:50,defaultColor:"#666",currentColor:"#666",isShowProgress:!1,input:function(e){s&&(s.setProgress(e),a.render())},change:function(e){s&&(s.setProgress(e),a.render())}}),y=e.create("div","bf-section-range");y.innerHTML='<i class="bf-range-icon gld-bf-rotate-vertical"></i>';var w=e.create("div","bf-section-range");w.innerHTML='<i class="bf-range-icon gld-bf-rotate-horizontal"></i>';var C=new Glodon.Web.Lang.Utility.Dom.range({element:y,min:-179,max:180,cur:0,defaultColor:"#666",currentColor:"#666",isShowProgress:!1,input:function(e){s&&(s.setRotateAngle(void 0,n(e)),a.render())},change:function(e){s&&(s.setRotateAngle(void 0,n(e)),a.render())}}),M=new Glodon.Web.Lang.Utility.Dom.range({element:w,min:-179,max:180,cur:0,defaultColor:"#666",currentColor:"#666",isShowProgress:!1,input:function(e){s&&(s.setRotateAngle(n(e),void 0),a.render())},change:function(e){s&&(s.setRotateAngle(n(e),void 0),a.render())}});if(a.addEventListener("Rendered",function(){var e=a._sectionPlane;if(e){var t=e.getProgress();0==o&&b.setProgress(t);var n=e.getRotateAngle();C.setProgress(n.angleB>180?n.angleB-360:n.angleB),M.setProgress(n.angleA>180?n.angleA-360:n.angleA)}}),l.container.appendChild(r),0==o&&l.container.appendChild(v),o?r.appendChild(h.element):r.appendChild(m.element),s&&o&&s._sectionTool)s.showPlane();else{var B=new Glodon.Bimface.Plugins.Section.SectionPlaneConfig;B.viewer=a,B.id="SectionPlane",s=new Glodon.Bimface.Plugins.Section.SectionPlane(B),t.removePlugin("SectionPlane"),t.addPlugin(s)}if(!o){var k=i.offsetWidth,T=i.offsetHeight;s.hidePlane(),l.element.style.fontSize=100*Math.min(T,k,414)/750+"px",l.element.addClass("section-panel");var L=l.element.querySelector(".bf-section-plane-head");l.element.querySelector(".bf-close").innerHTML="<span class='quit'>"+BimfaceLanguage.bf_general_exit+"</span>",l.element.appendChild(L)}a.render()}(),l};t.SectionPlanePanel=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=e.getRootElement(),a=n instanceof Glodon.Bimface.Viewer.Viewer3D,i=Glodon.Bimface.UI.Control.ControlEvent,r=Glodon.Bimface.Viewer.Viewer3DEvent;if(!a)return void console.log("The API is not supported on this viewer.");var l=new Glodon.Bimface.UI.Button.ButtonConfig;l.id="SectionPlane",l.title=BimfaceLanguage.bf_panel_section_plane,l.className="bf-button gld-bf-section-axial";var s,d=new Glodon.Bimface.UI.Button.ToggleButton(l),c=function(){var n=e.getToolbar("MainToolbar"),o=n.getControl("Measure");o&&o.setCheckedState(!1);var a=n.getControl("Explode");a&&a.setCheckedState(!1);var i=t.getControl("SectionBox");i&&i.setCheckedState(!1);var r=e.getPlugin("SectionBox");r&&e.removePlugin(r.id);var l=t.getControl("PickSectionPlane"),s=e.getPlugin("SectionPlane");l&&(l._checked&&s&&(e.removePlugin(s.id),s.hidePlane(),s.exit()),l.setCheckedState(!1));var d=e.getPlugin("SectionPlaneForAreaTree");d&&(d.exit(),e.removePlugin("SectionPlaneForAreaTree"))};return d.addEventListener(i.StateChange,function(t){if(n.getEventManager().fireEvent(r.ButtonOnToolbarClicked,{id:l.id,isChecked:d.isChecked()}),t){c();var a=n.getDomElement();s=new Glodon.Bimface.Application.UI.Panel.SectionPlanePanel(e),s.addEventListener("Hide",function(){d.setCheckedState(!1),a.removeAttribute("style")}),a.style.cursor="default",o.appendChild(s.element),s.bringToFront(),e.addPanel(s),s.initPosition(),n.render()}else{var i=e.getPlugin("SectionPlane");i&&i.hidePlane(),s&&(e.removePanel(s.id),s.close(),n.render())}}),d};e.SectionPlane=t}(),function(){var e=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel")),t=function(e){var t=(e.getViewer(),e.getRootElement(),new Glodon.Bimface.UI.Panel.PanelConfig);t.title=BimfaceLanguage.bf_panel_section_selectPlane,t.id="PickSectionPlanePanel",t.css={right:"10px",bottom:"170px",width:"200px",height:"90px"},t.className="bf-panel bf-section-panel bf-pickSectionPlane-panel",t.enableSizable=!1;var n=new Glodon.Bimface.UI.Panel.Panel(t);return function(){var t=new Glodon.Bimface.UI.Toolbar.ToolbarConfig;t.id="SectionToolbar",t.className="bf-pick-section-plane",t.buttons=["SectionPlaneVisiable","PickSectionPlaneReset"];var o=Glodon.Bimface.Application.UI.Toolbar.Toolbar(t,e);n.addControl(o)}(),n};e.PickSectionPlanePanel=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=e.getRootElement(),a=n instanceof Glodon.Bimface.Viewer.Viewer3D,i=Glodon.Bimface.UI.Control.ControlEvent,r=Glodon.Bimface.Viewer.Viewer3DEvent;if(!a)return void console.log("The API is not supported on this viewer.");var l=new Glodon.Bimface.UI.Button.ButtonConfig;l.id="PickSectionPlane",l.title=BimfaceLanguage.bf_panel_section_selectPlane,l.className="bf-button gld-bf-section-plane-pick";var s,d=new Glodon.Bimface.UI.Button.ToggleButton(l),c=function(){var n=e.getToolbar("MainToolbar"),o=n.getControl("Measure");o&&o.setCheckedState(!1);var a=n.getControl("Explode");a&&a.setCheckedState(!1);var i=t.getControl("SectionBox");i&&i.setCheckedState(!1);var r=e.getPlugin("SectionBox");r&&r.hideBox();var l=t.getControl("SectionPlane");l&&l.setCheckedState(!1);var s=e.getPlugin("SectionPlane");s&&s.hidePlane();var d=e.getPlugin("SectionPlaneForAreaTree");d&&(d.exit(),e.removePlugin("SectionPlaneForAreaTree"))},u=function(){var t=n.getDomElement();s=new Glodon.Bimface.Application.UI.Panel.PickSectionPlanePanel(e),s.addEventListener("Hide",function(){n.enableSnap(!1),d.setCheckedState(!1),t.removeAttribute("style")}),t.style.cursor="default",o.appendChild(s.element),s.bringToFront(),e.addPanel(s),s.initPosition()};return d.addEventListener(i.StateChange,function(t){if(n.getEventManager().fireEvent(r.ButtonOnToolbarClicked,{id:l.id,isChecked:d.isChecked()}),t){c(),u();var o=new Glodon.Bimface.Viewer.SnapMode,a=Glodon.Bimface.Viewer.SnapObject.Face;o.setSnap3DList([a]),n.setSnapMode(o),n.enableSnap(!0)}else{var i=e.getPlugin("SectionPlane");i&&i.hidePlane(),s&&(e.removePanel(s.id),s.close(),n.render()),n.enableSnap(!1)}}),n.addEventListener(r.MouseClicked,function(t){var o=t.normal,a=t.worldPosition,i=t.objectId,r=t.snapPoint,l=n.snap&&n.snap.isOpen,s=r&&"Plane"==r.type,c=d._checked;if(l&&c&&n.removeSelectedId([i]),c&&l&&s){n.enableSnap(!1),a.addScalar(2);var u=e.getPlugin("sectionPlane");if(u&&u._sectionTool)u.setPositionByPlane(a,o,0),u.showPlane();else{e.removePlugin("SectionPlane");var p=new Glodon.Bimface.Plugins.Section.SectionPlaneConfig;p.viewer=n,p.id="SectionPlane",p.exitSectionBox=!1,u=new Glodon.Bimface.Plugins.Section.SectionPlane(p),u.setPositionByPlane(a,o,0),e.addPlugin(u)}n.render()}}),d};e.PickSectionPlane=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=n instanceof Glodon.Bimface.Viewer.Viewer3D,a=Glodon.Bimface.UI.Control.ControlEvent;if(!o)return void console.log("The API is not supported on this viewer.");var i=new Glodon.Bimface.UI.Button.ButtonConfig;i.id="SectionBoxVisiable",i.title=BimfaceLanguage.bf_tip_section_hide,i.className="bf-button gld-bf-box-hide";var r=new Glodon.Bimface.UI.Button.ToggleButton(i);return r.addEventListener(a.StateChange,function(t){var o=e.getPlugin("SectionBox");o&&(t?o.hideBox():o.showBox()),n.render()}),r};e.SectionBoxVisiable=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=n instanceof Glodon.Bimface.Viewer.Viewer3D,a=Glodon.Bimface.UI.Control.ControlEvent;if(!o)return void console.log("The API is not supported on this viewer.");var i=new Glodon.Bimface.UI.Button.ButtonConfig;i.id="SectionPlaneVisiable",i.title=BimfaceLanguage.bf_tip_section_hide,i.className="bf-button gld-bf-hide-slice";var r=new Glodon.Bimface.UI.Button.ToggleButton(i);return r.addEventListener(a.StateChange,function(t){var o=e.getPlugin("SectionPlane");o?t?o.hidePlane():o.showPlane():r.setCheckedState(!1),n.render()}),r};e.SectionPlaneVisiable=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=n instanceof Glodon.Bimface.Viewer.Viewer3D,a=Glodon.Bimface.UI.Control.ControlEvent;if(!o)return void console.log("The API is not supported on this viewer.");var i=new Glodon.Bimface.UI.Button.ButtonConfig;i.id="SectionRotate",i.title="旋转",i.className="bf-button gld-bf-rotate-box";var r=new Glodon.Bimface.UI.Button.ToggleButton(i);return r.addEventListener(a.Click,function(){var e=Glodon.Bimface.Viewer.SectionBoxMode;r.isChecked()?n.setSectionBoxMode(e.Rotate):n.setSectionBoxMode(e.Default)}),r};e.SectionRotate=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=n instanceof Glodon.Bimface.Viewer.Viewer3D,a=Glodon.Bimface.UI.Control.ControlEvent;if(!o)return void console.log("The API is not supported on this viewer.");var i=new Glodon.Bimface.UI.Button.ButtonConfig;i.id="SectionReset",i.title=BimfaceLanguage.bf_tip_section_resetBox,i.className="bf-button gld-bf-reset-box";var r=new Glodon.Bimface.UI.Button.Button(i);return r.addEventListener(a.Click,function(){var t=e.getPlugin("SectionBox");t&&t.reset(),n.render()}),r};e.SectionReset=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=n instanceof Glodon.Bimface.Viewer.Viewer3D,a=Glodon.Bimface.UI.Control.ControlEvent;if(!o)return void console.log("The API is not supported on this viewer.");var i=new Glodon.Bimface.UI.Button.ButtonConfig;i.id="PickSectionPlaneReset",i.title=BimfaceLanguage.bf_tip_section_resetBox,i.className="bf-button gld-bf-reset-box";var r=new Glodon.Bimface.UI.Button.Button(i);return r.addEventListener(a.Click,function(){var t=e.getPlugin("SectionPlane");t&&(e.removePlugin(t.id),t.exit()),n.enableSnap(!0),n.render()}),r};e.PickSectionPlaneReset=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),t=function(e){var t=new Glodon.Bimface.UI.Panel.PanelConfig;t.title=BimfaceLanguage.bf_btn_info,t.css={left:"50%",top:"50%",width:"300px",height:"210px",transform:"translate(-50%,-50%)"},t.enableSizable=!1,t.className="bf-panel bf-basicInfo-panel";var n=e.getInformation(),o=new Glodon.Bimface.UI.Panel.Panel(t),a='<div class="bf-info">\n                  <ul class="bf-info-list">\n                    <li>'+BimfaceLanguage.bf_panel_info_component+'<span class="bf-info-value">'+n.elements+"</span></li>\n                    <li>"+BimfaceLanguage.bf_panel_info_mesh+'<span class="bf-info-value">'+n.triangles+"</span></li>\n                    <li>"+BimfaceLanguage.bf_panel_info_vertex+'<span class="bf-info-value">'+n.vertices+'</span></li>\n                  </ul>\n                  <div class="bf-info-power">Powered by <a target="_blank" href="http://bimface.com/">bimface.com</a></div>\n                </div>';return o.setHtml(a),o};e.InformationPanel=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=e.getRootElement(),a=n instanceof Glodon.Bimface.Viewer.Viewer3D,i=Glodon.Bimface.UI.Control.ControlEvent,r=Glodon.Bimface.Viewer.Viewer3DEvent;if(!a)return void console.log("The API is not supported on this viewer.");var l=new Glodon.Bimface.UI.Button.ButtonConfig;l.id="Information",l.title=BimfaceLanguage.bf_btn_info,l.className="bf-button gld-bf-information";var s,d=new Glodon.Bimface.UI.Button.ToggleButton(l);return d.addEventListener(i.StateChange,function(t){t?s?s.show():(s=new Glodon.Bimface.Application.UI.Panel.InformationPanel(n),s.addEventListener("Hide",function(){d.setCheckedState(!1)}),o.appendChild(s.element),s.bringToFront(),e.addPanel(s)):s.hide(),n.getEventManager().fireEvent(r.ButtonOnToolbarClicked,{id:l.id,isChecked:t})}),d};e.Information=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=Glodon.Bimface.UI.Control.ControlEvent,a=new Glodon.Bimface.UI.Button.ButtonConfig;a.id="FullScreen",a.title=BimfaceLanguage.bf_btn_fullScreen,a.className="bf-button gld-bf-maximize";var i=new Glodon.Bimface.UI.Button.ChangeButton(a);return i.addEventListener(o.Click,function(){var e=this.hasClass("gld-bf-maximize");n.enableFullScreen(e)}),Glodon.Web.Lang.Utility.FullScreen.onFullScreenChanged(function(){var e=i.getTitle();i.toggleClassName("gld-bf-maximize"),i.toggleClassName("gld-bf-minimize"),e==BimfaceLanguage.bf_btn_fullScreen_exit?i.setTitle(BimfaceLanguage.bf_btn_fullScreen):i.setTitle(BimfaceLanguage.bf_btn_fullScreen_exit)}),i};e.FullScreen=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=(Glodon.Bimface.Viewer.Viewer3D,Glodon.Bimface.UI.Control.ControlEvent),a=new Glodon.Bimface.UI.Button.ButtonConfig;a.id="FamilyList",a.title="FamilyList",a.className="bf-combobox bf-family";var i=new Glodon.Bimface.UI.Button.ComboBox(a);return n.getFamilyTypes(function(e){for(var t=0,n=e.length;t<n;t++){var o=e[t],a=new Glodon.Bimface.UI.Button.ButtonConfig;a.id=o.id,a.title=o.name;var r=new Glodon.Bimface.UI.Button.ComboBoxOptionButton(a);r.setHtml('<span class="bf-button-name">'+o.name+"</span>"),i.addControl(r)}}),i.addEventListener(o.Change,function(e){n.getDefaultModel().showFamilyTypeById(e.id),n.render()}),i};e.FamilyList=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=Glodon.Bimface.UI.Control.ControlEvent,a=new Glodon.Bimface.UI.Button.ButtonConfig;a.id="LayoutList",a.title="LayoutList",a.className="bf-combobox bf-family";for(var i=new Glodon.Bimface.UI.Button.ComboBox(a),r=n.getViewer().getLayouts(),l=Glodon.Bimface.Viewer.ViewerDrawingEvent,s=0,d=r.length;s<d;s++){var c=r[s],u=new Glodon.Bimface.UI.Button.ButtonConfig;u.id=c.id||"Model",u.title=c.name;var p=new Glodon.Bimface.UI.Button.ComboBoxOptionButton(u);p.setHtml('<span class="bf-button-name">'+c.name+"</span>"),i.addControl(p)}var f={},h={};return i.addEventListener(o.Change,function(t){var o=e.getPanel("MeaurePanel"),a=e.getToolbar("MainToolbar"),i=a.getControl("Annotation"),r=n.getCurrentViewId();i&&i._enabled&&(f[r]=i._annotationManager.getAnnotationList()),o&&o.hide(),h[r]=n.getCurrentState();var s=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop();"Model"==t.id?(s||document.querySelector(".gld-bf-measure").setCss({display:"block"}),n.showViewById(0)):(s||document.querySelector(".gld-bf-measure").setCss({display:"none"}),n.showViewById(t.id)),setTimeout(function(){n.update(!0)},100),i&&i._enabled&&f[t.id]&&i._annotationManager.setAnnotationList(f[t.id]);var d="Model"==t.id&&"0"||t.id;h[d]&&n.setState(h[d]);var c=a.getControl("Map");"Model"!=t.id?c&&(c.element.style.display="none"):c&&(c.element.style.display="inline-block");var u="Model"===t.id?0:t.id;n.getEventManager().fireEvent(l.ButtonOnToolbarClicked,{id:"LeftSubToolbar",viewId:u})}),i};e.LayoutList=t}();var FAMILY_INSTANCE,createTreeNode=function e(t,n,o){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"default";if(t){var r=new Glodon.Bimface.UI.Tree.TreeNodeConfig,l=new Glodon.Bimface.UI.Button.ButtonConfig;l.className="bf-tree-icon",l.defaultClass="gld-bf-untransparent",l.changeClass="gld-bf-transparent",l.title=BimfaceLanguage.bf_panel_modelTree_transparent,r.selection=!0;var s=new Glodon.Bimface.UI.Button.ChangeButton(l);switch(t.type){case"floor":t.type="levelName",r.isChecked=!0,r.hasCheckbox=!0,r.icon=s;break;case"category":t.type="categoryId",r.isChecked=!0,r.hasCheckbox=!0,r.icon=s;break;case"specialty":r.selection=!1;case"root":r.isChecked=!0,r.hasCheckbox=!0,r.selection=!1,r.icon=s;break;case"family":case"familyType":default:r.isChecked=!0,r.hasCheckbox=!0,r.icon=s}t.elementIds&&(t.type="fileId",r.isChecked=!0,r.hasCheckbox=!0,r.icon=s),t.type||(r.isChecked=!0,r.hasCheckbox=!0,r.icon=s),t.items&&t.items.length>0?r.hasExpand=!0:r.hasExpand=!1,r.datas=t;var d=new Glodon.Bimface.UI.Tree.TreeNode(r);if(d.filter=t.type,d.modelId=o,"old"!=n.treeType&&"integrateModel"===n.modelType&&t.items&&t.items[0].fileId&&(d.fileId=t.items[0].fileId),"model"==t.type&&(d.fileId=t.fileIds),"categoryId"==t.type||"root"==t.type||"model"==t.type)d.setData(t.id,t.name);else if(t.elementIds||t.type)t.fileId?d.setData(t.fileId,t.fileId):"specialty"==t.type&&""==t.name?d.setData("",BimfaceLanguage.bf_panel_modelTree_specialtyUndefined):t.name==BimfaceLanguage.bf_panel_modelTree_specialtyUndefined?d.setData("",t.name):d.setData(t.actualName,t.name);else{var c=FAMILY_INSTANCE+"["+t+"]";d.setData(t,c)}return d.setCheckedState(a),d.setIconState(i),d.addEventListener("ExpandChanged",function(a,i){var r=a.getChildNode();if(t.items&&t.items.length>0&&!r){var l="checked"===a.getCheckedState(),s=a.getIconState()?"default":"change";if("family"==t.type&&(FAMILY_INSTANCE=t.name),t.items[0].elementIds&&t.items[0].elementIds.length>0){var d=t.items[0].elementIds.length;"familyType"!==t.type&&(FAMILY_INSTANCE="");for(var c=0,u=d;c<u;c++){var p=t.items[0].elementIds[c];a.addChildNode(e(p,n,o,l,s))}}else for(var c=0,u=t.items.length;c<u;c++)a.addChildNode(e(t.items[c],n,o,l,s))}}),d}},createComponentsInstanceTree=function(e,t,n){var o=n.data,a=n.modelType,i=n.treeType,r="all"!==e.id?e.id:void 0;if(o&&0!=o.length)if("singleModel"==a)for(var l=o,s=0,d=l.length;s<d;s++)if(1==d&&"floor"==l[s].type)for(var c=l[0].items,u=0;u<c.length;u++){var p=createTreeNode(c[u],n,r);p.addEventListener("SelectionChanged",function(e,n){selectComponent(t,e,n)}),e.addChildNode(p)}else{var p=createTreeNode(l[s],n,r);p.addEventListener("SelectionChanged",function(e,n){selectComponent(t,e,n)}),e.addChildNode(p)}else{var l;l="old"==i?o.items:o;for(var s=0,d=l.length;s<d;s++){var p=createTreeNode(l[s],n,r);p.addEventListener("SelectionChanged",function(e,n){selectComponent(t,e,n)}),e.addChildNode(p)}}},getConditions=function(e){if(e.filter){var t={};t[e.filter]=e.id,function e(n){if(n._parent){var o=n._parent;"model"===o.filter?t.fileId=o.fileId:"root"!=o.filter&&(t[o.filter]=o.id,e(o))}}(e)}else{var n=e._parent.fileId;t=n?n+"."+e.id:e.id}return[t]},getFolderConditions=function e(t,n){if("group"===t.type)for(var o=0;o<t.items.length;o++)e(t.items[o],n);else if("model"===t.type)n.push({fileId:t.fileIds});else{var a=void 0,i=void 0;switch(t.type){case"floor":a="levelName";break;case"category":a="categoryId";break;default:a=t.type}i="categoryId"==t.type||"root"==t.type||"model"==t.type?t.id:t.elementIds||t.type?t.fileId?t.fileId:"specialty"==t.type&&""==t.name?"":t.name==BimfaceLanguage.bf_panel_modelTree_specialtyUndefined?"":t.actualName:t,n.push(_defineProperty({},a,i))}return n},selectComponent=function(e,t,n){var o=void 0;if("group"===t.filter||"model"===t.filter&&!t.id){var a=t.getConfig(),i=a.datas;o=getFolderConditions(i,[])}else o=getConditions(t);var r;if(r=t.filter?e.getViewer().getFilter().getMatchIds(o):o,n){e.getModels().forEach(function(e){e.clearSelectedComponents()});var l=e.getModel(t.modelId);l&&(l.addSelectedComponentsById(r),l.zoomToSelectedComponents(1))}else e.getModels().forEach(function(e){e.clearSelectedComponents()});e.render()},workerType,createTreeNode$1=function e(t,n){if(t){var o=new Glodon.Bimface.UI.Tree.TreeNodeConfig,a=new Glodon.Bimface.UI.Button.ButtonConfig;a.className="bf-tree-icon",a.defaultClass="gld-bf-untransparent",a.changeClass="gld-bf-transparent",a.title=BimfaceLanguage.bf_panel_modelTree_transparent,o.selection=!1;var i=new Glodon.Bimface.UI.Button.ChangeButton(a);switch(t.type){case"floor":t.type="levelName",o.isChecked=!0,o.hasCheckbox=!0,o.icon=i;break;case"category":t.type="categoryId",o.isChecked=!0,o.hasCheckbox=!0,o.icon=i;break;case"specialty":case"root":o.isChecked=!0,o.hasCheckbox=!0,o.icon=i;break;case"family":case"familyType":default:o.isChecked=!1,o.hasCheckbox=!1}var r=new Glodon.Bimface.UI.Tree.TreeNode(o);if(r.filter=t.type,r.modelId=n,"categoryId"==t.type||"root"==t.type?r.setData(t.id,t.name):t.name==BimfaceLanguage.bf_panel_modelTree_specialtyUndefined?r.setData("",t.name):r.setData(t.actualName,t.name),t.items&&t.items.length>0)for(var l=0,s=t.items.length;l<s;l++)r.addChildNode(e(t.items[l],n));return r}},createComponentsTree=function(e,t,n){var o=n.data,a=n.modelType,i="all"!==e.id?e.id:void 0;if(workerType=n.meta.workerType,o&&0!=o.length)if("singleModel"==a)for(var r=0,l=o.length;r<l;r++)if(1==l&&"floor"==o[r].type)for(var s=o[r].items,d=0;d<s.length;d++)e.addChildNode(createTreeNode$1(s[d],i));else if("specialty"==o[0].type&&"floor"==o[0].items[0].type&&1==o[0].items.length)for(var s=o[0].items[0].items,d=0;d<s.length;d++)e.addChildNode(createTreeNode$1(s[d],i));else e.addChildNode(createTreeNode$1(o[r],i));else for(var r=0,l=o.items.length;r<l;r++)e.addChildNode(createTreeNode$1(o.items[r],i))},createTreeNode$2=function(e){if(e){var t=new Glodon.Bimface.UI.Tree.TreeNodeConfig,n=new Glodon.Bimface.UI.Button.ButtonConfig;n.className="bf-tree-icon",n.defaultClass="gld-bf-untransparent",n.changeClass="gld-bf-transparent",n.title=BimfaceLanguage.bf_panel_modelTree_transparent,t.selection=!0;var o=new Glodon.Bimface.UI.Button.ChangeButton(n);switch(e.type){case"root":case"modelId":t.isChecked=!0,t.hasCheckbox=!0,t.selection=!1,t.icon=o;break;default:t.isChecked=!1,t.hasCheckbox=!1}var a=new Glodon.Bimface.UI.Tree.TreeNode(t);return a.filter=e.type,a.setData(e.id,e.name),a}},createCombinedTree=function(e,t){if(t&&0!=t.length){var n=createTreeNode$2({type:"root",id:"all",name:BimfaceLanguage.bf_panel_modelTree_allComponents});n.expand(),n.setAttribute("id","treeRootNode");var o=new Glodon.Bimface.UI.Tree.Tree(n),a=function(t,n){var o=(t.meta,!0)
;t.data&&t.data.length>0&&function e(t){"familyType"===t.type?t.items&&0!==t.items.length||(o=!1):t.items&&t.items.length>0&&e(t.items[0])}(t.data[0]),o?createComponentsInstanceTree(n,e,t):createComponentsTree(n,e,t)};if(1===t.length)a(t[0],n);else if(t.length>1)for(var i=0;i<t.length;i++){var r=t[i].meta,l=createTreeNode$2({type:"modelId",id:r.modelId,name:r.name});n.addChildNode(l),t[i].data&&a(t[i],l)}return o.addEventListener("CheckedChanged",getTreeNodeCheckedChangedHandler(e)),o.addEventListener("IconChanged",getTreeNodeIconChangedHandler(e)),o}},getTreeNodeCheckedChangedHandler=function(e){return function(t,n){var o;if("group"===n.filter||"model"===n.filter&&!n.id){var a=n.getConfig(),i=a.datas;o=getFolderConditions$1(i,[])}else o=getConditions$1(n);var r=n.modelId,l=n.getCheckedState(),s=n.id;"unchecked"==l?"all"==s?e.getModels().forEach(function(e){e.hideAllComponents()}):n.filter?"modelId"===n.filter?e.getModel(s).hideAllComponents():e.getModel(r).hideComponentsByObjectData(o):e.getModel(r).hideComponentsById(o):"checked"==l&&("all"==s?e.getModels().forEach(function(e){e.showAllComponents()}):n.filter?"modelId"===n.filter?e.getModel(s).showAllComponents():e.getModel(r).showComponentsByObjectData(o):e.getModel(r).showComponentsById(o)),e.render()}},getTreeNodeIconChangedHandler=function(e){return function(t,n){var o;if("group"===t.filter||"model"===t.filter&&!t.id){var a=t.getConfig(),i=a.datas;o=getFolderConditions$1(i,[])}else o=getConditions$1(t);var r=t.modelId,l=t.id;"change"==n?"all"==l?e.getModels().forEach(function(e){e.transparentAllComponents()}):t.filter?"modelId"===t.filter?e.getModel(l).transparentAllComponents():e.getModel(r).transparentComponentsByObjectData(o):e.getModel(r).transparentComponentsById(o):"all"==l?e.getModels().forEach(function(e){e.opaqueAllComponents()}):t.filter?"modelId"===t.filter?e.getModel(l).opaqueAllComponents():e.getModel(r).opaqueComponentsByObjectData(o):e.getModel(r).opaqueComponentsById(o),e.render()}},getConditions$1=function(e){if(e.filter){var t={};t[e.filter]=e.id,function e(n){if(n._parent){var o=n._parent;"model"===o.filter?t.fileId=o.fileId:"root"!=o.filter&&(t[o.filter]=o.id,e(o))}}(e)}else{var n=e._parent.fileId;t=n?n+"."+e.id:e.id}return[t]},getFolderConditions$1=function e(t,n){if("group"===t.type)for(var o=0;o<t.items.length;o++)e(t.items[o],n);else if("model"===t.type)n.push({fileId:t.fileIds});else{var a=void 0,i=void 0;switch(t.type){case"floor":a="levelName";break;case"category":a="categoryId";break;default:a=t.type}i="categoryId"==t.type||"root"==t.type||"model"==t.type?t.id:t.elementIds||t.type?t.fileId?t.fileId:"specialty"==t.type&&""==t.name?"":t.name==BimfaceLanguage.bf_panel_modelTree_specialtyUndefined?"":t.actualName:t,n.push(_defineProperty({},a,i))}return n},getCombinedComponentsTree=function(e,t){var n=[];e.getModels().forEach(function(o){var a=o.getMetaData();if(o._manifest.Features.HasComponentStructure)o.getModelTree(function(o,i,r){if(n.push({data:o,modelType:i,treeType:r,meta:a}),n.length===e.getModelCount()&&"[object Function]"===Object.prototype.toString.call(t)){var l=createCombinedTree(e,n);t(l)}});else if(n.push({meta:a}),n.length===e.getModelCount()&&"[object Function]"===Object.prototype.toString.call(t)){var i=createCombinedTree(e,n);t(i)}})},showAreaProperty=function(e,t,n,o){"area"==n?e.getDefaultModel().getAreaProperty(o.id,function(e){e&&e.properties?t.setData(e.properties):t.setData({})}):e.getDefaultModel().getRoomProperty(o.id,function(e){e&&e.properties?t.setData(e.properties):t.setData({})})},tips={property:"请选择一个构件，以查看对应属性",material:"暂无对应材质属性",drawing:"暂无对应图纸",area:"暂无对应空间",file:"暂无对应文件",links:"暂无对应文件",component:"暂无对应构件信息",loading:"加载中...",empty:"暂无对应数据",notFined:"找不到对应的三维构件"};!function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),t=function(e){var t=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),n=(e.getViewer(),Glodon.Bimface.Viewer.Viewer3DEvent,new Glodon.Bimface.UI.Panel.PanelConfig);n.title=BimfaceLanguage.bf_tip_props_rooms,n.className="bf-panel area-panel",n.id="AreaPropertyPanel",n.css=t?{right:"10px",top:"10px",width:"300px",height:"416px"}:{left:"0",top:"0",width:"100%",height:"100%"};var o=new Glodon.Bimface.UI.Panel.Panel(n);return o.setTips(tips.area),e.areaPanel=o,o};e.AreaPanel=t}();var zoomToArea=function(e,t,n,o){var a=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),i=e.getViewer();e._objectTypes[t.id]=t.type,a||o||e.getPanel("ModelTree").hide();var r=e.getPanel("AreaPropertyPanel");if(n){r&&showAreaProperty(i,r,t.type,{id:t.id,modelId:t.modelId});var l=t.elevation,s=t.height,d=t.maxPt,c=t.minPt,u=1600,p=10;"m"===i._defaultUnit&&(u/=1e3,p/=1e3);var f={min:c,max:{x:d.x,y:d.y,z:d.z+s}},h=l+u+p,m=t.boundary,g=CLOUD.ExtrudeBodyManager.getInstance(i.getViewer()).getNode(t.id);if(m)if(i.hideAllRooms(),g){i.showRoomsById([t.id]),g.geometry.computeBoundingBox();var v=g.geometry.boundingBox.max.z-g.geometry.boundingBox.min.z;h=l+v+p}else i.createRoom(m,u,t.id),t.modelId&&i.bindRoomByModelId(t.id,t.modelId);g=g||CLOUD.ExtrudeBodyManager.getInstance(i.getViewer()).getNode(t.id);var b=g.explodedDirection.clone().multiplyScalar(g.explodedHeight);h+=b.z,f.min={x:f.min.x+b.x,y:f.min.y+b.y,z:f.min.z+b.z},f.max={x:f.max.x+b.x,y:f.max.y+b.y,z:f.max.z+b.z},i.setSelectedComponentsById([t.id]);var y=i.getCameraAnimation();i.setCameraAnimation(!1),i.setView(Glodon.Bimface.Viewer.ViewOption.Top),i.zoomToBoundingBox(f),i.setCameraAnimation(y);var w=e.getPlugin("SectionPlane"),C=e.getPanel("PickSectionPlanePanel");C&&(w&&(w.exit(),e.removePlugin("SectionPlane"),w=e.getPlugin("SectionPlane")),C.hide());var M=w||makeSectionPlane(i);!1===w&&e.addPlugin(M);var B=e.getPanel("SectionPlanePanel"),k=B&&B.toggleButton;k&&k.setCheckedState(!0);var T=B&&B.select;T&&T.setCurrentOption("Z");var L=e.getPanel("SectionBoxPanel");L&&L.hide();var x=i.getViewer().getBoundingBoxWorld(),P=i.getViewer().getScene().getExpandScalar(),S=(new THREE.Box3).setFromCenterAndSize(x.getCenter(),x.getSize().multiplyScalar(P)),_=S.min.z,I=S.max.z,G=100-(h-_)/(I-_)*100;M.setPlane("Z"),M.setDirection("Forward"),M.setProgress(G),M.hidePlane(),CLOUD.GlobalData.ClippingCaps=!0,i.render()}else r&&r.clear(),i.hideAllRooms(),i.getModels().forEach(function(e){e.clearIsolation()}),a||clearSection(e),i.render()},makeSectionPlane=function(e){var t=new Glodon.Bimface.Plugins.Section.SectionPlaneConfig;return t.viewer=e,t.id="SectionPlane",t.plane=Glodon.Bimface.Plugins.Section.SectionPlanePlane.Z,t.direction=Glodon.Bimface.Plugins.Section.SectionPlaneDirection.Forward,t.exitSectionBox=!1,new Glodon.Bimface.Plugins.Section.SectionPlane(t)},createTreeNode$3=function e(t,n,o,a,i){var r=t.getViewer(),l=t.getRootElement();if(n){var s=new Glodon.Bimface.UI.Tree.TreeNodeConfig;s.isChecked=!1,s.hasCheckbox=!1,s.selection=!1,s.className="bf-tree bf-tree-area","area"!=o&&"room"!=o||(s.selection=!0);var d=new Glodon.Bimface.UI.Tree.TreeNode(s);if(d.type=o,d.modelId=n.modelId,d.setData(n.id,n.name),"area"==o||"room"==o){d.elevation=a,d.height=i,d.boundary=n.boundary,d.maxPt=n.maxPt,d.minPt=n.minPt;var c=new Glodon.Bimface.UI.Button.ButtonConfig;c.className="bf-property-icon",c.title=BimfaceLanguage.bf_tip_props_rooms;var u=new Glodon.Bimface.UI.Button.Button(c);d.addNode(u.element),u.addEventListener("Click",function(){var e=t.getPanel("AreaPropertyPanel");e||(e=new Glodon.Bimface.Application.UI.Panel.AreaPanel(t),e.addEventListener("Close",function(){t.removePanel(e.id)}),e.addEventListener("Hide",function(){e.close()}),showAreaProperty(r,e,d.type,{id:d.id,modelId:d.modelId}),l.appendChild(e.element),e.initPosition(),t.addPanel(e))})}var p,f,a,i;if("areas"==o&&n.areas&&n.areas.length>0&&(p=n.areas,f="area",a=n.elevation,i=n.height),"rooms"==o&&n.rooms&&n.rooms.length>0&&(p=n.rooms,f="room",a=n.elevation,i=n.height),p)for(var h=0;h<p.length;h++){p[h].modelId=d.modelId;var m=e(t,p[h],f,a,i);m.addEventListener("SelectionChanged",function(e,n,o){zoomToArea(t,e,n,o)}),d.addChildNode(m)}return"rooms"!=o&&"areas"!=o||p||d.disabled(),d}},createTree=function(e,t,n,o){e.getViewer();if(t&&0!=t.length){var a=new Glodon.Bimface.UI.Tree.TreeNodeConfig;a.isChecked=!1,a.hasCheckbox=!1,a.selection=!1,a.className="bf-tree bf-tree-empty";var i=new Glodon.Bimface.UI.Tree.TreeNode(a);i.expand();var r=new Glodon.Bimface.UI.Tree.Tree(i);return createSubTree(e,t,i,n,o,!0),r}},createCombinedTree$1=function(e,t){var n=new Glodon.Bimface.UI.Tree.TreeNodeConfig;n.isChecked=!1,n.hasCheckbox=!1,n.selection=!1,n.className="bf-tree bf-tree-empty";var o=new Glodon.Bimface.UI.Tree.TreeNode(n);o.expand();for(var a=new Glodon.Bimface.UI.Tree.Tree(o),i=0;i<t.length;i++){var r=t[i].data,n=new Glodon.Bimface.UI.Tree.TreeNodeConfig;n.isChecked=!1,n.hasCheckbox=!1,n.selection=!1,n.className="bf-tree";var l=new Glodon.Bimface.UI.Tree.TreeNode(n);l.setData(t[i].meta.modelId,t[i].meta.name),l.type="model",o.addChildNode(l),r?(l.expand(),r.modelId=t[i].meta.modelId,createSubTree(e,r,l,t[i].HasArea,t[i].HasRoom,!1)):l.disabled()}return a},createSubTree=function(e,t,n,o,a,i){var r=new Glodon.Bimface.UI.Tree.TreeNodeConfig;r.isChecked=!1,r.hasCheckbox=!1,r.selection=!1,r.className="bf-tree bf-tree-empty";var l=new Glodon.Bimface.UI.Tree.TreeNode(r);l.setData("room",BimfaceLanguage.bf_panel_modelTree_rooms2),i&&l.expand();var s=new Glodon.Bimface.UI.Tree.TreeNode(r);s.setData("area",BimfaceLanguage.bf_panel_modelTree_areas),i&&s.expand();for(var d=!1,c=!1,u=t.modelId,p=0,f=t.length;p<f;p++)t[p].rooms&&t[p].rooms.length>0&&(t[p].modelId=u,l.addChildNode(createTreeNode$3(e,t[p],"rooms")),d=!0),t[p].areas&&t[p].areas.length>0&&(t[p].modelId=u,s.addChildNode(createTreeNode$3(e,t[p],"areas")),c=!0);a&&d&&n.addChildNode(l),o&&c&&n.addChildNode(s)},getAreaTree=function(e,t){var n=e.getViewer();if(1===n.getModelCount())n.getDefaultModel().getAreas(function(o){if(o&&o.length>0){var a=n._manifest.Features.HasArea,i=n._manifest.Features.HasRoom,r=createTree(e,o,a,i);t&&t(r)}else t&&t()});else if(n.getModelCount()>1){var o=[],a=function(){if(o.length===n.getModelCount()&&"[object Function]"===Object.prototype.toString.call(t)){var a=createCombinedTree$1(e,o);t(a)}};n.getModels().forEach(function(e){var t=e.getMetaData(),n=e._manifest,i=n.Features.HasArea,r=n.Features.HasRoom;i||r?e.getAreas(function(e){o.push({data:e,meta:t,HasArea:i,HasRoom:r}),a()},function(e){o.push({error:e,meta:t}),a()}):(o.push({meta:t}),a())})}},createTreeNode$4=function(e){if(e){var t=new Glodon.Bimface.UI.Tree.TreeNodeConfig;t.isChecked=!0,t.hasCheckbox=!0,t.selection=!1;var n=new Glodon.Bimface.UI.Button.ButtonConfig;n.className="bf-tree-icon",n.defaultClass="gld-bf-untransparent",n.changeClass="gld-bf-transparent",n.title=BimfaceLanguage.bf_panel_modelTree_transparent;var o=new Glodon.Bimface.UI.Button.ChangeButton(n);t.icon=o;var a=new Glodon.Bimface.UI.Tree.TreeNode(t);return a.filter=e.type,a.setData(""+e.fileId,e.fileName),a.linkedId=e.linkedBy,a.databagId=e.databagId,a}},createTree$1=function(e,t){if(t&&0!=t.length){var n=createTreeNode$4({type:"root",fileId:"all",fileName:BimfaceLanguage.bf_panel_modelTree_allFiles});n.expand();var o=new Glodon.Bimface.UI.Tree.Tree(n);if(1===e.getModelCount()){t=Glodon.Web.Lang.Utility.ClientHelper.sortByName(t,"fileName");for(var a=0,i=t.length;a<i;a++)t[a].type="fileId",n.addChildNode(createTreeNode$4(t[a]))}else if(e.getModelCount()>1)for(var a=0,i=t.length;a<i;a++)if("integrateModel"===t[a].modelType){var r=createTreeNode$4({type:t[a].modelType,fileId:t[a].modelId,fileName:t[a].modelName});r.expand(),n.addChildNode(r);for(var l=Glodon.Web.Lang.Utility.ClientHelper.sortByName(t[a].fileList,"fileName"),s=0;s<l.length;s++)l[s].type="fileId",r.addChildNode(createTreeNode$4(l[s]))}else t[a].type=t[a].modelType,n.addChildNode(createTreeNode$4(t[a]));return o.addEventListener("CheckedChanged",function(t,n){var o=n.filter,a=n.id,i=n.getCheckedState();if("root"===o)"unchecked"==i?e.getModels().forEach(function(e){e.hideAllComponents()}):e.getModels().forEach(function(e){e.showAllComponents()});else if("integrateModel"===o||"singleModel"===o)"unchecked"==i?e.getModel(a).hideAllComponents():e.getModel(a).showAllComponents();else{var r="all"!==n._parent.id?n._parent.id:void 0,l=n.linkedId,s=[{sceneId:n.databagId+"."+a}];r&&(s[0].modelId=r);for(var d=[],c=0;c<l.length;c++){var u={};u[o]=l[c],r&&(u.modelId=r),d.push(u)}"unchecked"==i?(e.getModel(r).hideComponentsByObjectData(d),e.getModel(r).hideComponentsByObjectData(s)):(e.getModel(r).showComponentsByObjectData(d),e.getModel(r).showComponentsByObjectData(s))}e.render()}),o.addEventListener("IconChanged",function(t,n){var o=t.filter,a=t.id;if("root"===o)"change"==n?e.getModels().forEach(function(e){e.transparentAllComponents()}):e.getModels().forEach(function(e){e.opaqueAllComponents()});else if("integrateModel"===o||"singleModel"===o)"change"==n?e.getModel(a).transparentAllComponents():e.getModel(a).opaqueAllComponents();else{for(var i="all"!==t._parent.id?t._parent.id:void 0,r=t.linkedId,l=[],s=0;s<r.length;s++){var d={};d[o]=r[s],i&&(d.modelId=i),l.push(d)}"change"==n?e.getModel(i).transparentComponentsByObjectData(l):e.getModel(i).opaqueComponentsByObjectData(l)}e.render()}),o}},getFileTree=function(e,t){if(1===e.getModelCount()&&"integrateModel"===e.getDefaultModel().getMetaData().modelType)e.getDefaultModel().getFiles(function(n){var o=createTree$1(e,n);t&&t(o)});else if(e.getModelCount()>1){var n=[],o=0,a=0;if(e.getModels().forEach(function(i){var r={viewToken:i.viewToken};n.push(r);var l=i.getMetaData();if(r.modelType=l.modelType,r.databagId=l.databagId,"singleModel"===l.modelType){var s=i.modelId.toString();r.fileId=s,r.fileName=l.name,r.fileType=l.fileType}else"integrateModel"===l.modelType&&(r.modelId=i.modelId.toString(),r.modelName=l.name,r.fileList=[],o++,i.getFiles(function(i){if(r.fileList=i,a++,o===a){var l=createTree$1(e,n);t&&t(l)}}))}),0===o){var i=createTree$1(e,n);t&&t(i)}}},createTreeNode$5=function e(t,n){if(t){var o=new Glodon.Bimface.UI.Tree.TreeNodeConfig;o.isChecked=!0,o.selection=!1,o.propagation=!1,o.hasCheckbox=!0;var a=new Glodon.Bimface.UI.Button.ButtonConfig;a.className="bf-tree-icon",a.defaultClass="gld-bf-untransparent",a.changeClass="gld-bf-transparent",a.title=BimfaceLanguage.bf_panel_modelTree_transparent;var i=new Glodon.Bimface.UI.Button.ChangeButton(a);o.icon=i;var r=new Glodon.Bimface.UI.Tree.TreeNode(o);if(r.filter="fileId",r.setData(""+t.fileId,t.name),r.linked=[t.linkPathHash],r.databagId=t.databagId,r.modelId=n,t.links&&t.links.length>0)for(var l=0,s=t.links.length;l<s;l++){var d=e(t.links[l],n);r.linked=r.linked.concat(d.linked),r.addChildNode(e(t.links[l],n))}return r}},createModelNode=function(e){var t=new Glodon.Bimface.UI.Tree.TreeNodeConfig;t.isChecked=!0,t.selection=!1,t.propagation=!1,t.hasCheckbox=!0;var n=new Glodon.Bimface.UI.Button.ButtonConfig;n.className="bf-tree-icon",n.defaultClass="gld-bf-untransparent",n.changeClass="gld-bf-transparent",n.title=BimfaceLanguage.bf_panel_modelTree_transparent;var o=new Glodon.Bimface.UI.Button.ChangeButton(n);t.icon=o;var a=new Glodon.Bimface.UI.Tree.TreeNode(t);if(a.setData(e.meta.modelId,e.meta.name),a.filter="integrateModel",a.expand(),e.data&&e.data.length>0)for(var i=0,r=e.data.length;i<r;i++)a.addChildNode(createTreeNode$5(e.data[i],e.meta.modelId));return a},createTree$2=function(e,t,n){if(t&&0!=t.length){var o=createTreeNode$5({type:"root",fileId:"all",name:BimfaceLanguage.bf_panel_modelTree_allFiles});o.expand();var a=new Glodon.Bimface.UI.Tree.Tree(o);if(1===e.getModelCount())for(var i=0,r=t.length;i<r;i++)o.addChildNode(createTreeNode$5(t[i]));else if(e.getModelCount()>1)for(var i=0;i<t.length;i++)o.addChildNode(createModelNode(t[i]));return a.addEventListener("CheckedChanged",function(t,n){var o=n.filter,a=n.id,i=n.getCheckedState();if("all"==a)"unchecked"==i?e.getModels().forEach(function(e){e.hideAllComponents()}):e.getModels().forEach(function(e){e.showAllComponents()});else if("integrateModel"===o)"unchecked"==i?e.getModel(a).hideAllComponents():e.getModel(a).showAllComponents();else{for(var r=n.modelId,l=n.linked,s=[],d=0;d<l.length;d++){var c={};c[o]=l[d]||n.id,n.modelId&&(c.modelId=n.modelId),s.push(c)}"unchecked"==i?e.getModel(r).hideComponentsByObjectData(s):e.getModel(r).showComponentsByObjectData(s)}e.render()}),a.addEventListener("IconChanged",function(t,n){var o=t.filter,a=t.id;if("change"==n)if("all"==a)e.getModels().forEach(function(e){e.transparentAllComponents()});else if("integrateModel"===o)e.getModel(a).transparentAllComponents();else{for(var i=t.modelId,r=t.linked,l=[],s=0;s<r.length;s++){var d={};d[o]=r[s]||t.id,t.modelId&&(d.modelId=t.modelId),l.push(d)}e.getModel(i).transparentComponentsByObjectData(l)}else if("all"==a)e.getModels().forEach(function(e){e.opaqueAllComponents()});else if("integrateModel"===o)e.getModel(a).opaqueAllComponents();else{for(var i=t.modelId,r=t.linked,l=[],s=0;s<r.length;s++){var d={};d[o]=r[s]||t.id,t.modelId&&(d.modelId=t.modelId),l.push(d)}e.getModel(i).opaqueComponentsByObjectData(l)}e.render()}),a}},getLinkedTree=function(e,t){if(1===e.getModelCount())e.getDefaultModel().getLinkGraph(function(n){var o=createTree$2(e,n);t&&t(o)});else if(e.getModelCount()>1){var n=[],o=function(){if(n.length===e.getModelCount()&&"[object Function]"===Object.prototype.toString.call(t)){var o=createTree$2(e,n);t(o)}};e.getModels().forEach(function(e){var t=e.getMetaData();e._manifest.Features.HasLinkRelation?e.getLinkGraph(function(e){n.push({data:e,meta:t}),o()}):"integrateModel"===t.modelType?e.getFiles(function(e){e.forEach(function(e){return e.name=e.fileName}),n.push({data:e,meta:t}),o()}):(n.push({meta:t}),o())})}},createTreeNode$6=function(e,t,n,o,a){if(e){var i=new Glodon.Bimface.UI.Tree.TreeNodeConfig;i.isChecked=!1,i.hasCheckbox=!1,i.selection=!0;var r=new Glodon.Bimface.UI.Tree.TreeNode(i);return r.modelId=a,r.viewToken=t,r.isIntegrateModel=n,n&&(r.fileId=o),r.setData(e.id,e.name),r}},createFileNode=function(e,t,n,o){var a=new Glodon.Bimface.UI.Tree.TreeNodeConfig;a.isChecked=!1,a.hasCheckbox=!1,a.selection=!1;var i=new Glodon.Bimface.UI.Tree.TreeNode(a);if(i.setData(e.fileId,e.fileName),i.modelId=o,e.drawingSheets&&e.drawingSheets.length>0)for(var r=0;r<e.drawingSheets.length;r++)i.addChildNode(createTreeNode$6(e.drawingSheets[r].viewInfo,t,n,e.fileId,o));else i.disabled();return i},createModelNode$1=function(e){var t=new Glodon.Bimface.UI.Tree.TreeNodeConfig;t.isChecked=!1,t.hasCheckbox=!1,t.selection=!1;var n=new Glodon.Bimface.UI.Tree.TreeNode(t);if(n.setData(e.modelId,e.modelName),e.fileList&&e.fileList.length>0)for(var o=0;o<e.fileList.length;o++)n.addChildNode(createFileNode(e.fileList[o],e.viewToken,!0,e.modelId));return n.expand(),n},createRootNode=function(){var e=new Glodon.Bimface.UI.Tree.TreeNodeConfig;return e.isChecked=!1,e.hasCheckbox=!1,e.selection=!1,e.className="bf-tree bf-tree-empty",new Glodon.Bimface.UI.Tree.TreeNode(e)},createTree$3=function(e,t,n,o){if(t&&0!=t.length){for(var a=createRootNode(),i=new Glodon.Bimface.UI.Tree.Tree(a),r=0,l=t.length;r<l;r++){var s="integrateModel"===e._data.modelType?createFileNode(t[r],t[r].viewToken,!0):createTreeNode$6(t[r].viewInfo,e._data.viewToken);a.addChildNode(s)}return i}},createCombinedTree$2=function(e,t){if(t&&0!=t.length){for(var n=createRootNode(),o=new Glodon.Bimface.UI.Tree.Tree(n),a=0;a<t.length;a++)"integrateModel"===t[a].modelType?n.addChildNode(createModelNode$1(t[a])):n.addChildNode(createFileNode(t[a],t[a].viewToken,!1));return o}},getDrawingTree=function(e,t){if(1===e.getModelCount()&&"integrateModel"!==e.getDefaultModel().getMetaData().modelType)e.getDefaultModel().getAllDrawingsheets(function(n){if((n=n.drawingList||n)&&n.length>0){n=Glodon.Web.Lang.Utility.ClientHelper.sortByName(n,"viewInfo.name");var o=createTree$3(e,n);t&&t(o)}else t&&t()});else if(1===e.getModelCount()&&"integrateModel"===e.getDefaultModel().getMetaData().modelType)e.getDefaultModel().getFiles(function(n){var o=0,a=0;n.forEach(function(i){var r=i.fileId.toString();o++,e.getDefaultModel().getDrawingsheets(r,function(r){if(a++,r=r.drawingList||r,r&&(r=Glodon.Web.Lang.Utility.ClientHelper.sortByName(r,"viewInfo.name"),i.drawingSheets=r),a==o){var l=createTree$3(e,n);t&&t(l)}})})});else if(e.getModelCount()>1){var n=[],o=0,a=0;e.getModels().forEach(function(i){var r={viewToken:i.viewToken};n.push(r);var l=i.getMetaData();if(r.modelType=l.modelType,r.databagId=l.databagId,"singleModel"===l.modelType){var s=i.modelId.toString();r.fileId=s,r.fileName=l.name,r.fileType=l.fileType;i._manifest.Features.HasDrawing&&(o++,i.getDrawingsheets(s,function(i){if(a++,i=i.drawingList||i,i&&(i=Glodon.Web.Lang.Utility.ClientHelper.sortByName(i,"viewInfo.name"),r.drawingSheets=i),a==o){var l=createCombinedTree$2(e,n);t&&t(l)}}))}else if("integrateModel"===l.modelType){r.modelId=i.modelId.toString(),r.modelName=l.name,r.fileList=[];var d=i._manifest;d.Features.HasDrawing&&i.getFiles(function(l){r.fileList=l,l.forEach(function(r){var l=r.fileId.toString();o++,i.getDrawingsheets(l,function(i){if(a++,i=i.drawingList||i,i&&(i=Glodon.Web.Lang.Utility.ClientHelper.sortByName(i,"viewInfo.name"),r.drawingSheets=i),a==o){var l=createCombinedTree$2(e,n);t&&t(l)}})})})}})}},selectComponent$1=function(e,t,n,o){var a=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),i=e.getViewer();if(a||o||e.getPanel("ModelTree").hide(),n){i.getModels().forEach(function(e){e.clearSelectedComponents()});var r=i.getModel(t.modelId);r.addSelectedComponentsById(t.selectData),r.zoomToSelectedComponents(),i.render()}else i.getModels().forEach(function(e){e.clearSelectedComponents()}),a||clearSection(e),i.render()},createTreeNode$7=function e(t,n,o,a){if(n){var i=new Glodon.Bimface.UI.Tree.TreeNodeConfig;i.isChecked=!1,i.hasCheckbox=!1,i.selection=!1,i.className="bf-tree","assembly"!=o&&"group"!=o&&"instances"!=o||(i.selection=!0);var r=new Glodon.Bimface.UI.Tree.TreeNode(i);if(r.type=o,r.modelId=a,"instances"==o)r.setData(n.id,n.id),r.selectData=n.elements;else if(r.setData(n.id,n.name),n.instances){var l=[];n.instances.forEach(function(e){l.push.apply(l,e.elements)}),r.selectData=l}var s,d,c,u;if(n.types&&n.types.length>0&&(s=n.types),d="assemblys"==o?"assembly":"group",n.instances&&n.instances.length>0&&(c=n.instances,u="instances"),s)for(var p=0;p<s.length;p++){var f=e(t,s[p],d,a);f.addEventListener("SelectionChanged",function(e,n,o){selectComponent$1(t,e,n,o)}),r.addChildNode(f)}if(c)for(var p=0;p<c.length;p++){var h=e(t,c[p],u,a);h.addEventListener("SelectionChanged",function(e,n,o){selectComponent$1(t,e,n,o)}),r.addChildNode(h)}return"groups"!=o&&"assemblys"!=o||s||r.disabled(),"group"!=o&&"assembly"!=o||c||r.disabled(),r}},createTree$4=function(e,t,n){e.getViewer();if(t&&0!=t.length){var o=new Glodon.Bimface.UI.Tree.TreeNodeConfig;o.isChecked=!1,o.hasCheckbox=!1,o.selection=!1,o.className="bf-tree bf-tree-empty";var a=new Glodon.Bimface.UI.Tree.TreeNode(o);a.expand();var i=new Glodon.Bimface.UI.Tree.Tree(a);return createSubTree$1(e,t,a,!0),i}},createCombinedTree$3=function(e,t){var n=new Glodon.Bimface.UI.Tree.TreeNodeConfig;n.isChecked=!1,n.hasCheckbox=!1,n.selection=!1,n.className="bf-tree bf-tree-empty";var o=new Glodon.Bimface.UI.Tree.TreeNode(n);o.expand();for(var a=new Glodon.Bimface.UI.Tree.Tree(o),i=0;i<t.length;i++){var r=t[i].data,n=new Glodon.Bimface.UI.Tree.TreeNodeConfig;n.isChecked=!1,n.hasCheckbox=!1,n.selection=!1,n.className="bf-tree";var l=new Glodon.Bimface.UI.Tree.TreeNode(n);l.setData(t[i].meta.modelId,t[i].meta.name),l.type="model",o.addChildNode(l),r&&0!=r.length?(l.expand(),createSubTree$1(e,r,l,!1,t[i].meta.modelId)):l.disabled()}return a},createSubTree$1=function(e,t,n,o,a){var i=new Glodon.Bimface.UI.Tree.TreeNodeConfig;if(i.isChecked=!1,i.hasCheckbox=!1,i.selection=!1,i.className="bf-tree",t.groups&&t.groups.length>0){var r=new Glodon.Bimface.UI.Tree.TreeNode(i);r.setData("group",BimfaceLanguage.bf_panel_modelTree_group),o&&r.expand(),n.addChildNode(r);for(var l=0,s=t.groups.length;l<s;l++)r.addChildNode(createTreeNode$7(e,t.groups[l],"groups",a))}if(t.assemblies&&t.assemblies.length>0){i.selection=!1;var d=new Glodon.Bimface.UI.Tree.TreeNode(i);d.setData("assembly",BimfaceLanguage.bf_panel_modelTree_assembly),o&&d.expand(),n.addChildNode(d);for(var l=0,s=t.assemblies.length;l<s;l++)d.addChildNode(createTreeNode$7(e,t.assemblies[l],"assemblys",a))}},getModelGroupTree=function(e,t){var n=e.getViewer();if(1===n.getModelCount())n.getDefaultModel().getModelSet(function(n){if(n){var o=createTree$4(e,n);t&&t(o)}else t&&t()});else if(n.getModelCount()>1){var o=[],a=function(){if(o.length===n.getModelCount()&&"[object Function]"===Object.prototype.toString.call(t)){var a=createCombinedTree$3(e,o);t(a)}};n.getModels().forEach(function(e){var t=e.getMetaData();e._manifest.Features.HasGroup?e.getModelSet(function(e){o.push({data:e,meta:t}),a()},function(e){o.push({error:e,meta:t}),a()}):(o.push({meta:t}),a())})}},MEP_SYSTEM_LENGTH=0,LINK_PATH=[],FILE_ID,createTreeNode$8=function e(t,n){if(t){var o=new Glodon.Bimface.UI.Tree.TreeNodeConfig;o.isChecked=!1,o.hasCheckbox=!1,o.selection=!1,t.type||(o.selection=!0);var a=new Glodon.Bimface.UI.Tree.TreeNode(o);if(a.setData(t.name,t.name),t.type||(a.network=t.network,a.fileId=FILE_ID),a.modelId=n,t.items&&t.items.length>0)for(var i=0,r=t.items.length;i<r;i++)a.addChildNode(e(t.items[i],n));else"fileId"===t.type&&a.disabled();return a}},createTree$5=function(e,t,n){if(n&&0!=n.length){var o=new Glodon.Bimface.UI.Tree.TreeNodeConfig;o.isChecked=!1,o.hasCheckbox=!1,o.selection=!1;var a;a=new Glodon.Bimface.UI.Tree.TreeNode(o),a.expand();var i=new Glodon.Bimface.UI.Tree.Tree(a);if(1===t.getModelCount())for(var r=0,l=n.length;r<l;r++){FILE_ID=n[r].id;var s=createTreeNode$8(n[r]);s.addEventListener("SelectionChanged",function(n,o,a){selectComponent$2(e,t,n,n,o,a)}),a.addChildNode(s)}else if(t.getModelCount()>1)for(var r=0;r<n.length;r++)if("integrateModel"===n[r].modelType){var o=new Glodon.Bimface.UI.Tree.TreeNodeConfig;o.isChecked=!1,o.hasCheckbox=!1,o.selection=!1;var d=new Glodon.Bimface.UI.Tree.TreeNode(o);d.setData(n[r].modelId,n[r].modelName),a.addChildNode(d);for(var c=Glodon.Web.Lang.Utility.ClientHelper.sortByName(n[r].fileList,"fileName"),u=0;u<c.length;u++){var p=c[u].mepData;if(p){FILE_ID=p.id;var s=createTreeNode$8(p,n[r].modelId);s.addEventListener("SelectionChanged",function(n,o,a){selectComponent$2(e,t,n,n,o,a)}),d.addChildNode(s)}else{var s=new Glodon.Bimface.UI.Tree.TreeNode(o);s.setData(c[u].fileName,c[u].fileName),s.disabled(),d.addChildNode(s)}}}else{var p=n[r].mepData;if(p){FILE_ID=void 0;var s=createTreeNode$8(p,n[r].fileId);s.addEventListener("SelectionChanged",function(n,o,a){selectComponent$2(e,t,n,n,o,a)}),a.addChildNode(s)}else{var s=new Glodon.Bimface.UI.Tree.TreeNode(o);s.setData(n[r].fileName,n[r].fileName),s.disabled(),a.addChildNode(s)}}return i}},selectComponent$2=function(e,t,n,o,a){var i=[],r=n.modelId;if(n.fileId){var l=t.getModel(r).getMetaData().config;if(l&&l["integrate-with-links"]){var s=void 0;LINK_PATH.map(function(e){if(e.fileId==n.fileId)return void(s=e.linkedBy)}),s.map(function(e){n.network.map(function(t){var n=e+"."+t;i.push(n)})})}else n.network.map(function(e){var t=n.fileId+"."+e;i.push(t)})}else i=n.network;if(Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop()||a||e.getPanel("ModelTree").hide(),o){t.getModels().forEach(function(e){e.clearSelectedComponents()});var d=t.getModel(r);d.addSelectedComponentsById(i),d.zoomToSelectedComponents(1)}else t.getModels().forEach(function(e){e.clearSelectedComponents()});t.render()},formatSystemData=function(e,t,n,o){var a=e.reduce(function(e,t,n){return e[t.systemCategory]=e[t.systemCategory]||{},e[t.systemCategory][t.systemType]=e[t.systemCategory][t.systemType]||[],e[t.systemCategory][t.systemType].push({name:t.name,network:Object.keys(t.network)}),e},{}),i=[];for(var r in a){i.push({type:"systemCategory",name:r,items:[]});for(var l in a[r])i[i.length-1].items.push({type:"systemType",name:l,items:a[r][l]})}var s=[];t?s.push({type:"fileId",id:t,name:n,items:i}):s=i,o&&o(s)},sortMepName=function e(t){return t=Glodon.Web.Lang.Utility.ClientHelper.sortByName(t,"name"),t.map(function(n){n.items&&n.items.length>0&&("systemType"==n.type?t=Glodon.Web.Lang.Utility.ClientHelper.sortByRules(n.items,"name"):e(n.items))}),t},getMepData=function(e,t,n,o){var a=[];e.getMepSystem(t,function(e){e.systems?formatSystemData(e.systems,t,n,function(e){o&&o(e)}):(MEP_SYSTEM_LENGTH--,o&&o(a))},function(){MEP_SYSTEM_LENGTH--,o&&o(a)})},getMepTree=function(e,t,n,o){if(1===t.getModelCount()){var a=t.getDefaultModel();if("integrateModel"==n){var i=[];a.getFiles(function(n){MEP_SYSTEM_LENGTH=n.length,n.forEach(function(n){var r=n.fileId.toString(),l=n.fileName.toString();LINK_PATH.push({fileId:r,linkedBy:n.linkedBy}),getMepData(a,r,l,function(n){if(0!=n.length&&i.push(n[0]),i.length==MEP_SYSTEM_LENGTH){var a=sortMepName(i),r=createTree$5(e,t,a);o&&o(r)}})})})}else getMepData(a,"","",function(n){var a=sortMepName(n),i=createTree$5(e,t,a);o&&o(i)})}else if(t.getModelCount()>1){var r=[];MEP_SYSTEM_LENGTH=0;var l=0;t.getModels().forEach(function(n){var a={viewToken:n.viewToken};r.push(a);var i=n.getMetaData();if(a.modelType=i.modelType,a.databagId=i.databagId,"singleModel"===i.modelType){var s=n.modelId.toString();a.fileId=s,a.fileName=i.name,a.fileType=i.fileType;n._manifest.Features.HasMEPSystem&&(MEP_SYSTEM_LENGTH++,getMepData(n,s,i.name,function(n){if(0!=n.length&&(l++,a.mepData=n[0]),l==MEP_SYSTEM_LENGTH){var i=createTree$5(e,t,r);o&&o(i)}}))}else if("integrateModel"===i.modelType){a.modelId=n.modelId.toString(),a.modelName=i.name,a.fileList=[];var d=n._manifest;d.Features.HasDrawing&&n.getFiles(function(i){a.fileList=i,i.forEach(function(a){var i=a.fileId.toString(),s=a.fileName.toString();MEP_SYSTEM_LENGTH++,getMepData(n,i,s,function(n){if(0!=n.length&&(l++,a.mepData=n[0]),l==MEP_SYSTEM_LENGTH){var i=createTree$5(e,t,r);o&&o(i)}})})})}})}};!function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),t=function(e,t){var n=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),o=(e.getViewer(),e.getRootElement(),new Glodon.Bimface.UI.Panel.PanelConfig);o.title="楼层平面图",o.id="DrawingPanel",o.css=n?{right:"10px",top:"10px",width:"400px",height:"420px"}:{left:"0",top:"2.68em",width:"100%",bottom:0,paddingTop:0};var a=new Glodon.Bimface.UI.Panel.Panel(o);return n||a.element.addClass("view-panel"),a.setHeader(t.name),a};e.DrawingPanel=t}();var clearState=function(e){var t=e.getViewer(),n=e.getPanel("AreaPanel"),o=e.getPanel("DrawingPanel");clearSection(e),n&&(n.close(),e.removePanel("AreaPanel")),o&&o.hide(),t.hideAllRooms(),t.getModels().forEach(function(e){e.clearIsolation(),e.opaqueAllComponents(),e.clearSelectedComponents()})},showDrawingPanel=function(e,t,n){var o=e.getViewer(),a=n.viewToken||o._data.viewToken,i=e.getRootElement(),r=n.isIntegrateModel;e.fileId=n.fileId;var l=n.modelId;e.subViewer?"Local"==BimfaceLoaderConfig.dataEnvType?e.subViewer.addModel(BimfaceLoaderConfig.MetaData,n.id,r&&n.fileId):(e.getPanel("DrawingPanel").setTitleContent(n.name),e.subViewer.load(a,n.id,n.fileId)):(BimfaceLoaderConfig.viewToken=a,BimfaceLoaderConfig.viewType=BimfaceViewTypeOption.DrawingView,BimfaceSDKLoader.load(BimfaceLoaderConfig,function(s){var d,c,u=function(e,t){var n,a=function(n){if(0!=n.length){for(var o=0;o<n.length;o++){var a=n[o].areas,i=n[o].height,r=n[o].elevation;if(a&&a.length>0)for(var l=0;l<a.length;l++)if(e==a[l].id)return void t(a[l],r,i);var s=n[o].rooms;if(s&&s.length>0)for(var d=0;d<s.length;d++)if(e==s[d].id)return void t(s[d],r,i)}t()}};n?a(n):o.getModel(l).getAreas(function(e){n=e,a(n)})},p=o.getViewer(),f=!0,h=function(){if(d)d.show();else{var e=new Glodon.Bimface.UI.Tips.TipsConfig;e.element=i,e.timeOut=3e3,e.html=BimfaceLanguage.bf_panel_modelTree_componentNotFound,d=new Glodon.Bimface.UI.Tips.Tips(e)}f=!1}
;p.registerEventListener(CLOUD.EVENTS.ON_SELECTION_FAILED,h);var m=Glodon.Bimface.Viewer.Viewer3DEvent;o.addEventListener(m.MissingDrawingElement,function(){if(c)c.show();else{var e=new Glodon.Bimface.UI.Tips.TipsConfig;e.element=i,e.timeOut=3e3,e.html=BimfaceLanguage.bf_panel_modelTree_entityNotFound,c=new Glodon.Bimface.UI.Tips.Tips(e)}});var g=new Glodon.Bimface.Viewer.ViewerDrawingConfig;g.domElement=t.container;var v=new Glodon.Bimface.Viewer.ViewerDrawing(g);"Local"==BimfaceLoaderConfig.dataEnvType?(s.fileId=n.fileId||"",BimfaceLoaderConfig.MetaData=s,v.addModel(s,n.id,r&&s.fileId)):v.load(a,n.id,n.fileId),v.addEventListener("ComponentsSelectionChanged",function(t){if(t&&t.length>0){var n=t[0],a=v.toModelId(n);if(2==t.length){var i=v.toLinkRevitId(t[0],t[1]),s=i instanceof Object?i.fileId:e.fileId,d=i instanceof Object?i.revitId:a;a=s+"_"+d}else r&&(a=e.fileId+"_"+a);var c=e.getPlugin("SectionBox"),p=e.getPanel("SectionPanel");u(a,function(t,n,i){if(o.getModels().forEach(function(e){e.showAllComponents()}),t){t.boundary&&o.setArea(t.boundary,n);var s=o.getWorldBox(n-20,n+1500);if(c)p&&p.hideBox();else{var d=new Glodon.Bimface.Plugins.Section.SectionBoxConfig;d.viewer=o,d.id="SectionBox",c=new Glodon.Bimface.Plugins.Section.SectionBox(d),e.addPlugin(c)}c.setBox(s),c.hideBox(),o.setView(Glodon.Bimface.Viewer.ViewOption.Top)}else r&&(a=a.replace("_",".")),c&&(c.reset(),c.hideBox()),p&&p.hideBox(),o.clearAllRooms(),o.getModel(l).setSelectedComponentsById([a]),f?(o.getModel(l).isolateComponentsById([a],Glodon.Bimface.Viewer.IsolateOption.MakeOthersTranslucent),o.getModel(l).zoomToSelectedComponents()):(o.getModels().forEach(function(e){e.clearIsolation()}),f=!0);o.render()})}});var b=function(e){if(e.elementId){var t=e.elementId,n=v.fromRevitId(t),a=v.fromLinkRevitId(e.fileId,t);if(!(n||a&&a.ids)){var i=Glodon.Bimface.Viewer.Viewer3DEvent;return void o.getEventManager().fireEvent(i.MissingDrawingElement)}a instanceof Object?v.zoomToObjectWithBlock(a.blockId,a.ids):n&&v.zoomToObject(n)}};t.addEventListener("Sizable",function(){v.resize()}),t.addEventListener("Hide",function(){p.unregisterEventListener(CLOUD.EVENTS.ON_SELECTION_FAILED,h),o.removeEventListener("ComponentsSelectionChanged",b),t.close(),e.removePanel("DrawingPanel"),delete e.subViewer}),o.addEventListener("ComponentsSelectionChanged",b),e.subViewer=v}))},createDrawingPanel=function(e,t){var n=e.getRootElement(),o=e.getPanel("DrawingPanel");if(o)o.show();else{var o=new Glodon.Bimface.Application.UI.Panel.DrawingPanel(e,t);n.appendChild(o.element),o.bringToFront(),e.addPanel(o)}showDrawingPanel(e,o,t)};!function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),n=function(t,n){var o="component",a=t.getViewer(),i=(t.getRootElement(),a._manifest),r=a._data.modelType,l=e.create("div","bf-tree-header"),s=e.create("div","bf-tree-footer"),d=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),c=[],u=void 0,p=void 0,f=void 0,h=(a._data.workerType,void 0);if(d&&(h={component:{panel:!1,tree:null},modelGroup:{panel:!1,tree:null},mepSystem:{panel:!1,tree:null},file:{panel:!1,tree:null},links:{panel:!1,tree:null},area:{panel:!1,tree:null},drawing:{panel:!1,tree:null}}),i.Features.HasComponentStructure&&c.push({id:"component",name:BimfaceLanguage.bf_panel_modelTree_components}),(i.Features.HasGroup||i.Features.HasAssemble)&&c.push({id:"modelGroup",name:BimfaceLanguage.bf_panel_modelTree_modelGroup}),i.Features.HasMEPSystem&&c.push({id:"mepSystem",name:BimfaceLanguage.bf_panel_modelTree_mep}),i.Features.HasFileList&&c.push({id:"file",name:BimfaceLanguage.bf_panel_modelTree_files}),(i.Features.HasRoom||i.Features.HasArea)&&c.push({id:"area",name:BimfaceLanguage.bf_panel_modelTree_rooms1}),i.Features.HasDrawing&&c.push({id:"drawing",name:BimfaceLanguage.bf_panel_modelTree_drawings}),d){var m,g,v=e.create("div","bf-tree-tab");if(l.appendChild(v),c.length<5)m=c;else{var b=e.create("div","bf-tree-select"),y=e.create("div","bf-tree-slot");l.appendChild(y),l.appendChild(b),m=c.slice(0,3),g=c.slice(3);var w=new Glodon.Bimface.UI.Select.SelectConfig;w.className="bf-select bf-select-tree",w.options=g,w.element=b,p=new Glodon.Bimface.UI.Select.Select(w),y.innerHTML=g[0].name,y.setAttribute("id",g[0].id),y.setAttribute("title",g[0].name),l.querySelectorAll(".bf-select-option")[0].style.display="none";var C=l.querySelector(".bf-select-current"),M=e.create("i","gld-bf-arrow-right");C.appendChild(M)}var B=new Glodon.Bimface.UI.Tabs.TabsConfig,k=["oneTab","twoTabs","threeTabs","fourTabs","fiveTabs","sixTabs","sevenTabs"],T=m.length>7?6:m.length-1;B.className="bf-tabs bf-tabs-tree "+k[T],B.options=m,B.element=v,u=new Glodon.Bimface.UI.Tabs.Tabs(B),f=new Glodon.Bimface.UI.Panel.PanelConfig,f.title=BimfaceLanguage.bf_btn_modelTree,f.id="ModelTree",f.css={left:"10px",top:"10px",height:"430px",minWidth:"300px",minHeight:"140px"},f.className="bf-panel bf-modelTree-panel"}else{var B=new Glodon.Bimface.UI.Tabs.TabsConfig,k=["oneTab","twoTabs","threeTabs","fourTabs","fiveTabs","sixTabs","sevenTabs"],T=c.length>7?6:c.length-1;B.className="bf-tabs bf-tabs-tree-mobile "+k[T],B.options=c,B.element=l,u=new Glodon.Bimface.UI.Tabs.Tabs(B),f=new Glodon.Bimface.UI.Panel.PanelConfig,f.title=BimfaceLanguage.bf_btn_modelTree,f.id="ModelTree",f.css={left:0,top:0,width:"100%",height:"100%"}}var L;i.Features.HasLinkRelation&&(L=e.create("label","bf-tree-label bf-checkbox"),L.innerHTML='\n        <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_modelTree_fileLink+'</span>\n        <input type="checkbox" class="bf-checkbox-input" name="hover" id="linksModeInput">\n        <span class="bf-checkbox-display"></span>',s.appendChild(L),L.addEventListener("change",function(){x.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading");t.getToolbar("MainToolbar");clearSection(t),clearState(t),a.getModels().forEach(function(e){e.showAllComponents()}),a.render();var e=document.querySelector("#linksModeInput");S(e&&e.checked?"links":"file")}));var x=new Glodon.Bimface.UI.Panel.Panel(f);x.setContainerHeader(l),x.setContainerFooter(s);var P=x.container;x.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),d||x.addClass("tree-panel"),x.addEventListener("Hide",function(){n.show(),d||"area"!=o&&"component"!=o&&clearState(t);var e=t.getPanel("AreaPropertyPanel");e&&e.hide(),a.render()}),d?h.component.panel||getCombinedComponentsTree(a,function(e){"component"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noComponent),h.component.tree=e,t.tree=h.component.tree,h.component.panel=!0,e.element.setAttribute("id","componentPanel"),e.element.addClass("tree-panel"),P.appendChild(e.element))}):getCombinedComponentsTree(a,function(e){"component"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noComponent),P.innerHTML="",t.tree=e,P.appendChild(e.element))});var S=function(e){o=e;var n=document.querySelectorAll(".tree-panel");switch(d&&(n.forEach(function(e){e.style.display="none"}),x.hideTips(),a.getModels().forEach(function(e){e.showAllComponents()})),e){case"component":d?h.component.panel?(document.querySelector("#componentPanel").style.display="block",t.tree=h.component.tree,G("componentPanel")):(x.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),getCombinedComponentsTree(a,function(e){"component"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noComponent),e&&(h.component.panel=!0,e.element.setAttribute("id","componentPanel"),e.element.addClass("tree-panel"),h.component.tree=e,t.tree=h.component.tree,P.appendChild(e.element)))})):getCombinedComponentsTree(a,function(e){"component"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noComponent),t.tree=e,e&&(P.innerHTML="",P.appendChild(e.element)))});break;case"modelGroup":d?h.modelGroup.panel?(document.querySelector("#modelGroupPanel").style.display="block",t.tree=h.modelGroup.tree,G("modelGroupPanel")):(x.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),getModelGroupTree(t,function(e){"modelGroup"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noData),e&&(h.modelGroup.panel=!0,e.element.setAttribute("id","modelGroupPanel"),e.element.addClass("tree-panel"),h.modelGroup.tree=e,t.tree=h.modelGroup.tree,P.appendChild(e.element)))})):getModelGroupTree(t,function(e){"modelGroup"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noData),t.tree=e,e&&P.appendChild(e.element))});break;case"mepSystem":d?h.mepSystem.panel?(document.querySelector("#mepSystemPanel").style.display="block",t.tree=h.mepSystem.tree,G("mepSystemPanel")):(x.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),getMepTree(t,a,r,function(e){"mepSystem"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noSystem),e&&(h.mepSystem.panel=!0,e.element.setAttribute("id","mepSystemPanel"),e.element.addClass("tree-panel"),h.mepSystem.tree=e,t.tree=h.mepSystem.tree,P.appendChild(e.element)))})):getMepTree(t,a,r,function(e){"mepSystem"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noSystem),t.tree=e,e&&P.appendChild(e.element))});break;case"area":d?h.area.panel?(document.querySelector("#areaPanel").style.display="block",t.tree=h.area.tree,G("areaPanel")):(x.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),getAreaTree(t,function(e){"area"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noRoom),e&&(h.area.panel=!0,e.element.setAttribute("id","areaPanel"),e.element.addClass("tree-panel"),h.area.tree=e,t.tree=h.area.tree,P.appendChild(e.element)))})):getAreaTree(t,function(e){"area"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noRoom),e&&(t.tree=e,P.appendChild(e.element)))});break;case"file":var i=document.querySelector("#linksModeInput");d?h.file.panel?i&&i.checked&&h.links.panel?(document.querySelector("#linksPanel").style.display="block",t.tree=h.links.tree,G("linksPanel")):(document.querySelector("#filePanel").style.display="block",t.tree=h.file.tree,G("filePanel")):(x.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),getFileTree(a,function(e){"file"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noFile),e&&(h.file.panel=!0,e.element.setAttribute("id","filePanel"),e.element.addClass("tree-panel"),h.file.tree=e,t.tree=h.file.tree,P.appendChild(e.element)))})):getFileTree(a,function(e){"file"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noFile),t.tree=e,e&&P.appendChild(e.element))});break;case"links":d?h.links.panel?(document.querySelector("#linksPanel").style.display="block",t.tree=h.links.tree,G("linksPanel")):(x.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),getLinkedTree(a,function(e){"links"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noFile),e&&(h.links.panel=!0,e.element.setAttribute("id","linksPanel"),e.element.addClass("tree-panel"),h.links.tree=e,t.tree=h.links.tree,P.appendChild(e.element)))})):getLinkedTree(a,function(e){"links"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noFile),t.tree=e,e&&P.appendChild(e.element))});break;case"drawing":d?h.drawing.panel?(document.querySelector("#drawingPanel").style.display="block",t.tree=h.drawing.tree,G("drawingPanel")):(x.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),getDrawingTree(a,function(e){"drawing"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noDrawing),e&&(h.drawing.panel=!0,e.element.setAttribute("id","drawingPanel"),e.element.addClass("tree-panel"),h.drawing.tree=e,t.tree=h.drawing.tree,P.appendChild(e.element),e.addEventListener("SelectionChanged",function(e,n){if(n)createDrawingPanel(t,e);else{var o=t.getPanel("DrawingPanel");o&&t.subViewer&&t.subViewer.isInitialized&&o.hide()}})))})):getDrawingTree(a,function(e){"drawing"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noDrawing),t.tree=e,e&&(P.appendChild(e.element),e.addEventListener("SelectionChanged",function(e,n){if(n)createDrawingPanel(t,e);else{var o=t.getPanel("DrawingPanel");o&&t.subViewer&&t.subViewer.isInitialized&&o.hide()}})))})}a.render()};u.addEventListener("Change",function(e){y&&y.removeClass("active"),I(e)}),p&&p.addEventListener("Change",function(e){_(e)}),y&&y.addEventListener("click",function(e){u.setCurrentOption(""),I(e.target),y.addClass("active")});var _=function(t){u.setCurrentOption(""),y.innerHTML=t.name,y.setAttribute("id",t.id),y.setAttribute("title",t.name),y.addClass("active");var n=l.querySelectorAll(".bf-select-option");n[0].style.display="block",n.forEach(function(e){e.id==t.id?e.style.display="none":e.style.display="block"});var o=l.querySelector(".bf-select-current"),a=e.create("i","gld-bf-arrow-right");o.appendChild(a),I(t)},I=function(e){d||(x.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),x.clear()),clearSection(t),clearState(t);var n=t.getPanel("AreaPropertyPanel");n&&("area"!=e.id?n.element.style.display="none":n.element.style.display="block"),L&&("file"==e.id?(L.style.display="block",x.container.style.height="calc(100% - 30px)"):(L.style.display="none",x.container.style.height="100%")),S(e.id)},G=function(e){var t=[],n=document.querySelectorAll("#"+e+" .bf-unchecked"),o=document.querySelectorAll("#"+e+" .gld-bf-transparent"),i=document.querySelectorAll("#"+e+" .bf-selected"),r=document.querySelector("#treeRootNode .bf-unchecked"),l=document.querySelector("#treeRootNode .gld-bf-transparent");if("componentPanel"==e)r?a.hideAllComponents():n.forEach(function(e){e.closest(".bf-sub-tree").previousSibling.querySelector(".bf-unchecked")||t.push(e)}),l?a.transparentAllComponents():o.forEach(function(e){e.closest(".bf-sub-tree").previousSibling.querySelector(".gld-bf-transparent")||t.push(e)}),i.forEach(function(e){e.closest(".bf-sub-tree").previousSibling.querySelector(".bf-selected")||t.push(e)});else var t=[].concat(_toConsumableArray(i),_toConsumableArray(n),_toConsumableArray(o));t.forEach(function(e){e.click(),e.click()})};return x.addEventListener("Show",function(){if(t.tree&&t.tree._selectionNode&&"area"==o){var e=t.tree._selectionNode;e.eventManager.fireEvent("SelectionChanged",e,!0,!0)}G(o+"Panel")}),x};t.ModelTreePanel=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=e.getRootElement(),a=(Glodon.Bimface.Viewer.Viewer3D,Glodon.Bimface.UI.Control.ControlEvent),i=new Glodon.Bimface.UI.Button.ButtonConfig;i.id="ModelTree",i.title=BimfaceLanguage.bf_btn_modelTree,i.className="bf-button gld-bf-tree";var r=new Glodon.Bimface.UI.Button.Button(i);return r.addEventListener(a.Click,function(){t.hide();var n=e.getPanel("ModelTree");if(n){n.show();var a=e.tree;a._selectionNode}else{var i=new Glodon.Bimface.Application.UI.Panel.ModelTreePanel(e,t);o.appendChild(i.element),e.addPanel(i)}}),r};e.ModelTree=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=e.getRootElement(),a=(Glodon.Bimface.Viewer.Viewer3D,Glodon.Bimface.UI.Control.ControlEvent),i=new Glodon.Bimface.UI.Button.ButtonConfig;i.id="MobileModelTree",i.title="构件树",i.className="bf-button gld-bf-tree";var r=new Glodon.Bimface.UI.Button.Button(i);return r.addEventListener(a.Click,function(){t.hide();var e=new Glodon.Bimface.Application.UI.Panel.ModelTreePanel(n,o,t,!0);o.appendChild(e.element)}),r};e.MobileModelTree=t}();var Environmental={dev:"dev",build:"build"},CurrentEnv=Environmental.build;CurrentEnv||(CurrentEnv=Environmental.dev);var Env=CurrentEnv;!function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),n="dev"==Env,o=function(e){var o=e.getViewer(),a=new Glodon.Bimface.UI.Panel.PanelConfig,i=this,r=e.state;n=n?o.isSupportSSAO():n,this.viewer=o;var l;l=o._data.dataEnvType==BimfaceEnvOption.Local?o._data.sdkPath:hostConfig.staticHost,a.title=BimfaceLanguage.bf_btn_settings,a.id="Setting",a.css={left:"50%",top:"50%",transform:"translate(-50%,-200px)",width:"330px",height:"auto"},a.enableSizable=!1,a.className="bf-panel bf-settings-panel";var s={1:{type:"multiple",direction:"0deg",colors:[{color:new Glodon.Web.Graphics.Color(246,250,255,1),stop:"10%"},{color:new Glodon.Web.Graphics.Color(214,224,235,1),stop:"70%"}]},2:{type:"skybox",skyBoxType:"CloudySky"},3:{type:"skybox",skyBoxType:"DarkNight"},4:{type:"single",color:new Glodon.Web.Graphics.Color(92,92,92,1)},5:{type:"single",color:new Glodon.Web.Graphics.Color(39,39,39,1)},6:{type:"single",color:new Glodon.Web.Graphics.Color(50,71,91,1)}},d=new Glodon.Bimface.UI.Panel.Panel(a),c=t.create("form","bf-setting"),u=t.create("div","bf-setting-foot"),p=[{id:"default",name:BimfaceLanguage.bf_panel_settings_interaction,title:BimfaceLanguage.bf_panel_settings_interaction},{id:"effect",name:BimfaceLanguage.bf_panel_settings_effect,title:BimfaceLanguage.bf_panel_settings_effect}],f=new Glodon.Bimface.UI.Tabs.TabsConfig;f.className="bf-setting-tabs",f.default="default",f.options=p;var h=new Glodon.Bimface.UI.Tabs.Tabs(f),m='<ul class="bf-setting-tab-default bf-show">\n        <li class="bf-setting-li">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_contextMenu+'</span>\n          <div class="bf-setting-value contextMenu">\n            <label class="bf-radio">\n              <input type="radio" class="bf-radio-input" name="menu" '+(r.menu?"checked":"")+' data-value=\'true\'>\n              <span class="bf-radio-display"></span>\n              <span class="bf-radio-value">'+BimfaceLanguage.bf_general_on+'</span>\n            </label>\n            <label class="bf-radio">\n              <input type="radio" class="bf-radio-input" name="menu" '+(r.menu?"":"checked")+' data-value=\'false\'>\n              <span class="bf-radio-display"></span>\n              <span class="bf-radio-value">'+BimfaceLanguage.bf_general_off+'</span>\n            </label>\n          </div>\n        </li>\n\n        <li class="bf-setting-li">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_orbitBtn+'</span>\n          <div class="bf-setting-value setMouseBehavior">\n            <label class="bf-radio">\n              <input type="radio" class="bf-radio-input" name="orbit" '+(r.hobby?"checked":"")+'>\n              <span class="bf-radio-display"></span>\n              <span class="bf-radio-value">'+BimfaceLanguage.bf_panel_settings_leftOrbit+'</span>\n            </label>\n            <label class="bf-radio">\n              <input type="radio" class="bf-radio-input" name="orbit" '+(r.hobby?"":"checked")+'>\n              <span class="bf-radio-display"></span>\n              <span class="bf-radio-value">'+BimfaceLanguage.bf_panel_settings_rightOrbit+'</span>\n            </label>\n          </div>\n        </li>\n\n        <li class="bf-setting-li">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_hover+'</span>\n          <div class="bf-setting-value mouseHover">\n            <label class="bf-checkbox">\n              <input type="checkbox" class="bf-checkbox-input" name="hover" '+(r.hover?"checked":"")+'>\n              <span class="bf-checkbox-display"></span>\n              <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_settings_hoverEffect+'</span>\n            </label>\n          </div>\n        </li>\n        <li class="bf-setting-li">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_zoomDir+'</span>\n          <div class="bf-setting-value mouseScroll">\n            <label class="bf-checkbox">\n              <input type="checkbox" class="bf-checkbox-input" name="scroll" '+(r.scroll?"checked":"")+'>\n              <span class="bf-checkbox-display"></span>\n              <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_settings_reverseDir+'</span>\n            </label>\n          </div>\n        </li>\n        </ul>\n\n        <ul class="bf-setting-tab-effect bf-scroll-bar">\n        <li class="bf-setting-select">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_effectPreset+'</span>\n          <div id="modeSelect"></div>\n        </li>\n        <li class="bf-setting-li checkbox">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_border+'</span>\n          <div class="bf-setting-value setBorderLine">\n            <label class="bf-checkbox">\n              <input type="checkbox" class="bf-checkbox-input" name="borderline" '+(r.borderLine?"checked":"")+'>\n              <span class="bf-checkbox-display"></span>\n              <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_settings_displayBorder+'</span>\n            </label>\n          </div>\n        </li>\n        <li class="bf-setting-li checkbox">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_shadow+'：</span>\n          <div class="bf-setting-value enableShadow">\n            <label class="bf-checkbox">\n              <input type="checkbox" class="bf-checkbox-input" name="shadow" '+(r.shadow?"checked":"")+'>\n              <span class="bf-checkbox-display"></span>\n              <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_settings_enableShadow+'</span>\n            </label>\n          </div>\n        </li>\n        <li class="bf-setting-li '+(n?"":"bf-setting-none")+'" style="display:none">\n          <span class="bf-setting-name">SSAO：</span>\n          <div class="bf-setting-value enableSSAO">\n            <label class="bf-checkbox">\n              <input type="checkbox" class="bf-checkbox-input" name="SSAO" '+(r.SSAO?"checked":"")+'>\n              <span class="bf-checkbox-display"></span>\n              <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_setting_ssao+'</span>\n            </label>\n          </div>\n        </li>\n        <li class="bf-setting-li">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_exposure+'</span>\n          <div class="bf-setting-value bf-setting-range" id="exposure"></div>\n        </li>\n\n        <li class="bf-li-more">\n          <div class="bf-panel-more">\n            <span>'+BimfaceLanguage.bf_panel_settings_moreOpt+'</span>\n            <i class="bf-arrow"></i>\n          </div>\n        </li>\n        <div class="bf-more-list">\n          <li class="bf-setting-li">\n            <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_bgColor+'</span>\n            <div class="bf-color">\n              <div class="bf-color-item '+(1==r.backgroundColor?"bf-color-select":"")+'" data-value="1">\n                <span class="bf-color-node" style="background: linear-gradient(180deg, rgb(214, 224, 235) 10%, rgb(246, 250, 255) 70%)"></span>\n              </div>\n              <div class="bf-color-item '+(2==r.backgroundColor?"bf-color-select":"")+'" data-value="2">\n                <span class="bf-color-node" style="background: linear-gradient(180deg, rgb(214, 224, 235) 10%, rgb(246, 250, 255) 70%)">\n                  <img src="'+l+'/resources/SkyBox/thumbnails/CloudySky.png"/>\n                </span>\n              </div>\n              <div class="bf-color-item '+(3==r.backgroundColor?"bf-color-select":"")+'" data-value="3">\n                <span class="bf-color-node" style="background: linear-gradient(180deg, rgb(214, 224, 235) 10%, rgb(246, 250, 255) 70%)">\n                  <img src="'+l+'/resources/SkyBox/thumbnails/DarkNight.png"/>\n                </span>\n              </div>\n              <div class="bf-color-item '+(4==r.backgroundColor?"bf-color-select":"")+'" data-value="4">\n                <span class="bf-color-node" style="background:#5c5c5c;"></span>\n              </div>\n              <div class="bf-color-item '+(5==r.backgroundColor?"bf-color-select":"")+'" data-value="5">\n                <span class="bf-color-node" style="background:#272727;"></span>\n              </div>\n              <div class="bf-color-item '+(6==r.backgroundColor?"bf-color-select":"")+'" data-value="6">\n                <span class="bf-color-node" style="background:#32475b;"></span>\n              </div>\n            </div>\n          </li>\n          <li style="display:block" class="bf-setting-li checkbox">\n            <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_ambientLight+'</span>\n            <div class="bf-setting-value ambientLight">\n              <label class="bf-checkbox">\n                <input type="checkbox" class="bf-checkbox-input" name="ambientLight" '+(r.ambientLight?"checked":"")+'>\n                <span class="bf-checkbox-display"></span>\n                <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_settings_enableAbientLight+'</span>\n              </label>\n            </div>\n          </li>\n          <li style="display:block" class="bf-thumbnail bf-setting-margin bf-enable-list '+(r.ambientLight?"":"bf-setting-disabled")+'">\n            <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_iblSel+'</span>\n            <div class="bf-thumbnail-value IBL-thumbnail">\n              <label class="'+("Gray"==r.IBLName?"bf-thumbnail-item selected":"bf-thumbnail-item")+'" id="Gray">\n                <img  src="'+l+'/resources/IBL/thumbnails/Gray.png" />\n              </label>\n              <label class="'+("HarborSunRise"==r.IBLName?"bf-thumbnail-item selected":"bf-thumbnail-item")+'" id="HarborSunRise">\n                <img src="'+l+'/resources/IBL/thumbnails/HarborSunRise.png" />\n              </label>\n              <label class="'+("ParkingLot"==r.IBLName?"bf-thumbnail-item selected":"bf-thumbnail-item")+'" id="ParkingLot">\n                <img src="'+l+'/resources/IBL/thumbnails/ParkingLot.png" />\n              </label>\n              <label class="'+("RiverSide"==r.IBLName?"bf-thumbnail-item selected":"bf-thumbnail-item")+'" id="RiverSide">\n                <img src="'+l+'/resources/IBL/thumbnails/RiverSide.png" />\n              </label>\n              <label class="'+("Sunrise"==r.IBLName?"bf-thumbnail-item selected":"bf-thumbnail-item")+'" id="Sunrise">\n                <img src="'+l+'/resources/IBL/thumbnails/Sunrise.png" />\n              </label>\n              <label class="'+("SunsetGrass"==r.IBLName?"bf-thumbnail-item selected":"bf-thumbnail-item")+'" id="SunsetGrass">\n                <img src="'+l+'/resources/IBL/thumbnails/SunsetGrass.png" />\n              </label>\n            </div>\n          </li>\n          <li style="display:block" class="bf-setting-li bf-setting-margin bf-enable-list '+(r.ambientLight?"":"bf-setting-disabled")+'">\n            <span class="bf-setting-name"></span>\n            <div class="bf-setting-value IBLBackground">\n              <label class="bf-checkbox">\n                <input type="checkbox" class="bf-checkbox-input" name="enableIBLBackground" '+(r.enableIBLBackground?"checked":"")+'>\n                <span class="bf-checkbox-display"></span>\n                <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_settings_iblBgDisplay+"</span>\n              </label>\n            </div>\n          </li>\n        </div>\n        </ul>",g='<div class="bf-reset">\n          <span class="reset">'+BimfaceLanguage.bf_panel_settings_restore+"</span>\n        </div>";c.innerHTML=m,u.innerHTML=g,h.addEventListener("Change",function(e){"default"==e.id?(d.body.querySelector(".bf-setting-tab-default").addClass("bf-show"),d.body.querySelector(".bf-setting-tab-effect").removeClass("bf-show")):(d.body.querySelector(".bf-setting-tab-default").removeClass("bf-show"),d.body.querySelector(".bf-setting-tab-effect").addClass("bf-show"))});for(var v=c.querySelectorAll(".contextMenu .bf-radio-input"),b=0,y=v.length;b<y;b++)v[b].addEventListener("change",function(){i.viewer.toggleContextMenuDisplay()});for(var w=c.querySelectorAll(".setMouseBehavior .bf-radio-input"),C=0,M=w.length;C<M;C++)!function(e,t){w[e].addEventListener("change",function(){var t=e;o.setUseLeftHandedInput(!t)})}(C);var B=c.querySelector(".mouseHover .bf-checkbox-input");B.addEventListener("change",function(){var e=o.isEnableHover();o.enableHover(!e)});var k=c.querySelector(".mouseScroll .bf-checkbox-input");k.addEventListener("change",function(){o.setReverseWheelDirection(this.checked)});var T=c.querySelector(".setBorderLine .bf-checkbox-input");T.addEventListener("change",function(){o.setBorderLineEnabled(this.checked),o.render()});var L=function(e){switch(e){case"low":T.checked=!0,o.setEffectMode("performance");break;case"high":T.checked=!1,o.setEffectMode("fluency")}o.render()},x=[{id:"low",name:BimfaceLanguage.bf_panel_settings_bestAppear},{id:"high",name:BimfaceLanguage.bf_panel_settings_bestPerform}],P=new Glodon.Bimface.UI.Select.SelectConfig;P.className="bf-select bf-select-mode",P.options=x;var S=new Glodon.Bimface.UI.Select.Select(P);c.querySelector("#modeSelect").appendChild(S.element),S.addEventListener("Change",function(e){L(e.id)}),S.setCurrentOption(r.effect);var _=c.querySelector(".enableShadow .bf-checkbox-input");_.addEventListener("change",function(){for(var e=o.lightManager.getAllDirectionalLights(),t=0;t<e.length;t++)e[t].enableShadow(this.checked);o.render()}),_.checked=4==CLOUD.GlobalData.LightPreset;var I=c.querySelector(".enableSSAO .bf-checkbox-input");I.addEventListener("change",function(){o.enableSSAO(this.checked),o.render()});var G=new Glodon.Web.Lang.Utility.Dom.range({element:c.querySelector("#exposure"),min:-1,max:1,step:.1,cur:r.exposure,change:function(e){o.setExposureShift(e),o.render()}}),E=c.querySelector(".bf-panel-more"),N=c.querySelector(".bf-more-list");E.addEventListener("click",function(){E.toggleClass("bf-show-more"),N.toggleClass("bf-show")});var U=new Glodon.Bimface.Plugins.SkyBox.SkyBoxManagerConfig;U.viewer=o;for(var A=new Glodon.Bimface.Plugins.SkyBox.SkyBoxManager(U),D=c.querySelectorAll(".bf-color .bf-color-item"),z=0,V=D.length;z<V;z++)!function(e,t){D[e].addEventListener("click",function(){for(var n=this.getAttribute("data-value"),a=s[n],i=a.type,r=0;r<t;r++)D[r].removeClass("bf-color-select");if(D[e].addClass("bf-color-select"),"single"==i){A.enableSkyBox(!1);var l=a.color;o.setBackgroundColor(l)}else if("multiple"==i){A.enableSkyBox(!1);var d=a.direction,c=a.colors;o.setBackgroundColors(c,d)}else o._opt.skyBoxType=a.skyBoxType,A.enableSkyBox(!0),a.skyBoxType&&A.setStyle(a.skyBoxType)})}(z,V);var W=c.querySelector(".IBL-thumbnail"),H=W.querySelectorAll(".bf-thumbnail-item"),F=c.querySelector(".ambientLight .bf-checkbox-input"),O=c.querySelectorAll(".bf-enable-list");F.addEventListener("change",function(){for(var e=this.checked,t=0;t<O.length;t++)O[t].toggleClass("bf-setting-disabled",!e);if(e){var n=c.querySelector(".IBL-thumbnail .selected");o.setLightingMode(Glodon.Bimface.Viewer.LightingMode.IBL);var a;n?a=n.getAttribute("id"):(H[0].addClass("selected"),a=H[0].id),o.loadIBLScene(a,R.checked)}else{o.enableIBLBackground(!1),o.setLightingMode(Glodon.Bimface.Viewer.LightingMode.Phong);var n=c.querySelector(".IBL-thumbnail .selected");n&&n.removeClass("selected"),R.checked=!1,o._opt.enableSky&&A.enableSkyBox(!0),o.render()}}),W.addEventListener("click",function(e){if(o.isEnableIBLBackground()&&"IMG"==e.target.nodeName)for(var t=e.target.parentNode,n=t.id,a=0,i=H.length;a<i;a++)H[a].removeClass("selected"),H[a]==t&&(t.addClass("selected"),o.setLightingMode(Glodon.Bimface.Viewer.LightingMode.IBL),o.loadIBLScene(n,R.checked))});var R=c.querySelector(".IBLBackground .bf-checkbox-input");return R.addEventListener("change",function(){if(!o.isEnableIBLBackground())return void(this.checked=!1);var e=this.checked;o.enableIBLBackground(e),!e&&o._opt.enableSkyBox&&A.enableSkyBox(!0),o.render()}),u.querySelector(".reset").addEventListener("click",function(){h.setCurrentOption("default"),v[r.menu?0:1].checked=!0,o.toggleContextMenuDisplay(r.menu),w[0].click(),B.checked=r.hover,o.enableHover(r.hover),k.checked=r.scroll,o.setReverseWheelDirection(r.scroll),S.setCurrentOption(r.effect),L(r.effect),T.checked=r.borderLine,
o.setBorderLineEnabled(r.borderLine);for(var e=o.getDefaultModel().isShadowDafault(),t=o.lightManager.getAllDirectionalLights(),n=0;n<t.length;n++)t[n].enableShadow(e);_.checked=e,o.enableSSAO(!1),I.checked=!1,G.setProgress(r.exposure),o.setExposureShift(r.exposure),E.removeClass("bf-show-more"),N.removeClass("bf-show"),D[0].click(),F.checked!=r.ambientLight&&F.click();for(var n=0,a=H.length;n<a;n++)H[n].removeClass("selected"),H[n].id==r.IBLName&&H[n].addClass("selected");R.checked=r.enableIBLBackground,o.loadIBLScene(r.IBLName,r.enableIBLBackground),o.render()}),d.setContainerHeader(h.element),d.container.appendChild(c),d.container.appendChild(u),d};e.SettingPanel=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=e.getRootElement(),a="Viewer3D"==n.viewerType,i="ViewerDrawing"==n.viewerType,r=Glodon.Bimface.UI.Control.ControlEvent;if(!a&&!i)return void console.log("The API is not supported on this viewer.");var l=new Glodon.Bimface.UI.Button.ButtonConfig;l.id="Setting",l.title=BimfaceLanguage.bf_btn_settings,l.className="bf-button gld-bf-settings";var s=new Glodon.Bimface.UI.Button.ToggleButton(l);return s.addEventListener(r.StateChange,function(t){var i=e.getPanel("Setting");if(t?i?i.show():(i=a&&new Glodon.Bimface.Application.UI.Panel.SettingPanel(e)||new Glodon.Bimface.Application.UI.Panel.PrintModePanel(e),i.addEventListener("Hide",function(){s.setCheckedState(!1)}),o.appendChild(i.element),i.bringToFront(),e.addPanel(i)):i.hide(),a){var r=Glodon.Bimface.Viewer.Viewer3DEvent;n.getEventManager().fireEvent(r.ButtonOnToolbarClicked,{id:l.id,isChecked:t})}}),s};e.Setting=t}();var createRoutePanel=function(e,t){e.num||(e.num=0);var n=!1,o=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),a=o.create("div","bf-route-form"),i=o.create("div","bf-route-info"),r=o.create("div","bf-route-info-row"),l=o.create("span","bf-route-info-label");l.innerText=BimfaceLanguage.bf_panel_nav_name;var s=o.create("input","bf-route-info-input");s.value=e._walkthrough.getName(),r.appendChild(l),r.appendChild(s);var d=o.create("div","bf-route-info-input"),c=o.create("div","bf-route-info-row"),u=o.create("span","bf-route-info-label");u.innerText=BimfaceLanguage.bf_panel_nav_time;var p=o.create("input","bf-route-info-time");p.setAttribute("type","number"),p.value=e._walkthrough.walkthroughTime,p.setAttribute("min","1"),p.setAttribute("max","120");var f=o.create("span","bf-route-info-timespan");f.innerHTML=BimfaceLanguage.bf_panel_nav_second,d.appendChild(p),d.appendChild(f),c.appendChild(u),c.appendChild(d),i.appendChild(r),i.appendChild(c);var h=o.create("div","bf-route-title"),m=o.create("span","bf-route-add");m.innerHTML='<i class="bf-icon-add"></i><span>'+BimfaceLanguage.bf_panel_nav_addKeyframe+"</span>";var g=o.create("span","bf-route-clear");g.innerText=BimfaceLanguage.bf_panel_nav_clearKeyframe,h.appendChild(m),h.appendChild(g);var v=o.create("div","bf-route-panel-tips");v.innerText=BimfaceLanguage.bf_panel_nav_addHere;var b=o.create("ul","bf-route-list bf-scroll-bar"),y=o.create("div","bf-route-foot"),w=o.create("div","bf-route-control bf-route-disabled");w.innerHTML='<i class="bf-icon-play"></i><span>'+BimfaceLanguage.bf_panel_nav_playnav+"</span>",y.appendChild(w),a.appendChild(i),a.appendChild(h),a.appendChild(v),a.appendChild(b),a.appendChild(y),a.saveWalkthrough=function(){if(0===b.childElementCount)return!1;for(var t=[],n=0;n<b.childElementCount;n++)t.push(b.children[n].keyFrame);return e.setKeyFrames(t),""!==p.value&&parseFloat(p.value)>0?e.setWalkthroughTime(parseFloat(p.value)):(p.value=e._walkthrough.walkthroughTime,d.removeClass("bf-route-info-input-invalid")),""!==s.value?e._walkthrough.setName(s.value):(s.value=e._walkthrough.getName(),s.removeClass("bf-route-info-input-invalid")),!0};var C=function(e,a,i){v.style.display="none";var r=o.create("div","bf-route-li"),l=o.create("div","bf-route-box"),s=o.create("span","bf-route-button");s.innerText=BimfaceLanguage.bf_general_delete;var d=o.create("span","bf-route-button bf-route-play");d.innerText=BimfaceLanguage.bf_panel_nav_play;var c=o.create("span","bf-route-name");c.innerText=e,i&&(r.camera=i),r.keyFrame=a,l.appendChild(d),l.appendChild(s),r.appendChild(c),r.appendChild(l),r.addEventListener("click",function(e){var o=e,a=o.target;n||a!=s&&a!=d&&(M?M!==r&&(M.removeClass("bf-selected"),r.addClass("bf-selected"),M=r):(r.addClass("bf-selected"),M=r),t.setCameraStatus(r.camera))}),d.addEventListener("click",function(e){B(r.keyFrame.id)}),s.addEventListener("click",function(e){M==r&&(M=null),b.removeChild(r),b.childElementCount<2&&w.addClass("bf-route-disabled"),0==b.childElementCount&&(v.style.display="block")}),M?(M.after(r),M.removeClass("bf-selected"),M=null):b.appendChild(r),b.childElementCount>=2&&w.removeClass("bf-route-disabled")};!function(){var n=e._walkthrough.getKeyFrames();if(n&&n.length>0)for(var o=0;o<n.length;o++){var a=n[o],i=a.name||""+BimfaceLanguage.bf_panel_nav_keyframe+e.num++,r=t.getCameraStatus();r.position=t.getViewer().drawingToWorld(a.position),r.target=t.getViewer().drawingToWorld(a.target),r.up={x:0,y:0,z:1},C(i,a,r)}}();var M=!1;s.addEventListener("blur",function(){""===s.value?s.addClass("bf-route-info-input-invalid"):s.removeClass("bf-route-info-input-invalid")}),p.addEventListener("blur",function(){""===p.value||Number(p.value)<=0?d.addClass("bf-route-info-input-invalid"):d.removeClass("bf-route-info-input-invalid")}),m.addEventListener("click",function(){if(!n){var o=t.getCameraStatus(),a=""+BimfaceLanguage.bf_panel_nav_keyframe+e.num++,i=e.addKeyFrame(a);C(a,i,o)}}),g.addEventListener("click",function(){n||(e.clearKeyFrames(),b.innerHTML="",M=null,w.addClass("bf-route-disabled"),v.style.display="block")});var B=function(t){a.saveWalkthrough(),e.play(t),b.addClass("bf-route-disabled"),g.addClass("bf-route-disabled"),m.addClass("bf-route-disabled"),p.setAttribute("disabled",!0),s.setAttribute("disabled",!0),w.innerHTML='<i class="bf-icon-stop"></i><span>'+BimfaceLanguage.bf_panel_nav_stop+"</span>",document.querySelector(".bf-routes-return").addClass("bf-routes-disabled"),n=!0};return w.addEventListener("click",function(){this.hasClass("bf-route-disabled")||(n?(b.removeClass("bf-route-disabled"),g.removeClass("bf-route-disabled"),m.removeClass("bf-route-disabled"),p.removeAttribute("disabled"),s.removeAttribute("disabled"),this.innerHTML='<i class="bf-icon-play"></i><span>'+BimfaceLanguage.bf_panel_nav_playnav+"</span>",e.stop(),M=!1):B())}),e.stopCallback(function(){b.removeClass("bf-route-disabled"),g.removeClass("bf-route-disabled"),m.removeClass("bf-route-disabled"),p.removeAttribute("disabled"),s.removeAttribute("disabled"),w.innerHTML='<i class="bf-icon-play"></i><span>'+BimfaceLanguage.bf_panel_nav_playnav+"</span>",M&&M.removeClass("bf-selected"),document.querySelector(".bf-routes-return").removeClass("bf-routes-disabled"),n=!1}),e.setKeyFrameCallback(function(e){var t=e;M&&M.removeClass("bf-selected"),b.children[t].addClass("bf-selected"),M=b.children[t]}),a.stopWalkthrough=function(){n&&w.click()},a},createRouteManagerPanel=function e(t,n){function o(e){e.style.display="block"}function a(e){e.style.display="none"}var i=0,r=!1,l=null,s=null,d=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),c=d.create("div","bf-routes-panel"),u=d.create("div","bf-routes-form"),p=d.create("div","bf-routes-title"),f=d.create("span","bf-routes-create");f.innerHTML='<i class="bf-icon-create"></i><span>'+BimfaceLanguage.bf_panel_nav_addWalkthrough+"</span>";var h=d.create("span","bf-routes-return");h.innerText=BimfaceLanguage.bf_panel_nav_walkthroughList;var m=d.create("div","bf-routes-split");p.appendChild(f),p.appendChild(h),c.appendChild(p),c.appendChild(m);var g=d.create("div","bf-routes-panel-tips");g.innerText=BimfaceLanguage.bf_panel_nav_addWalkthroughHere;var v=d.create("ul","bf-routes-list bf-scroll-bar");u.appendChild(g),u.appendChild(v),c.appendChild(u);var b=!1,y=!1,w=null,C=function(){y=!1,w&&"[object Function]"===Object.prototype.toString.call(w)&&w(),w=null},M=null,B=function(e){if(!r){l&&(c.removeChild(l),l=null);var p,m;if(!e||e instanceof MouseEvent){var B=new Glodon.Bimface.Plugins.Walkthrough.WalkthroughConfig;B.viewer=n,p=new Glodon.Bimface.Plugins.Walkthrough.Walkthrough(B),m=BimfaceLanguage.bf_panel_nav_walkthrough1+ ++i,p.setWalkthroughTime(20),s=t.addWalkthrough(m,p),l=createRoutePanel(p,n),c.appendChild(l),a(u),a(f),o(h),M=!0}else p=e.walkthrough,m=e.walkthrough._walkthrough.getName(),s=e.id;a(g);var k=d.create("div","bf-routes-li"),T=d.create("div","bf-routes-box"),L=d.create("span","bf-routes-button");L.innerText=BimfaceLanguage.bf_general_edit;var x=d.create("span","bf-routes-button");x.innerText=BimfaceLanguage.bf_general_delete;var P=d.create("span","bf-routes-name");P.innerText=m,T.appendChild(L),T.appendChild(x);var S=d.create("div","bf-routes-play"),_=d.create("div","bf-routes-stop");k.appendChild(S),k.appendChild(_),k.appendChild(P),k.appendChild(T),k.setAttribute("walkthroughId",s);var I=function(e){var n=t._walkthroughMap[e],i=n.walkthrough._stopCallback;(!i||i.toString().indexOf("originCb")<0)&&n.walkthrough.stopCallback(function(){i(),a(_),o(S),b?b=!1:(v.removeClass("bf-routes-disabled"),f.removeClass("bf-routes-disabled"),r=!1)})},G=function(){v.querySelector(".bf-selected")&&v.querySelector(".bf-selected").removeClass("bf-selected"),v.querySelector('.bf-routes-li[walkthroughId="'+s+'"]').addClass("bf-selected")},E=function(e,i){var d=function(){if(r){var e=v.querySelector('.bf-routes-li[walkthroughId="'+s+'"]').querySelector(".bf-routes-stop");e&&e.click(),r=!1}},p=function(){var e=l.querySelector(".bf-route-control");!e.hasClass("bf-route-disabled")&&e.querySelector(".bf-icon-stop")?e.click():t._walkthroughMap[i].walkthrough.bPause&&t._walkthroughMap[i].walkthrough.stop()},m=function(){if(i!==s&&l&&(c.removeChild(l),l=null),!l){s=i;var e=t._walkthroughMap[s];l=createRoutePanel(e.walkthrough,n),I(i),a(l),c.appendChild(l)}};switch(e){case"play":return function(e){var n=this;if(y)return void(w=function(){n.click()});b=!1,d(),m(),G();var s=l.querySelector(".bf-route-control");if(!s.hasClass("bf-route-disabled")&&s.querySelector(".bf-icon-play"))s.click();else{if(!t._walkthroughMap[i].walkthrough.bPause)return;t._walkthroughMap[i].walkthrough.play()}r=!0,v.addClass("bf-routes-disabled"),f.addClass("bf-routes-disabled"),a(S),o(_)};case"select":return function(e){b=!1,s!==i&&d(),m(),p(),G();var t=l.querySelector(".bf-route-list");t.childElementCount>0&&(y=!0,n.setCameraStatus(t.firstElementChild.camera,C))};case"stop":return function(e){b=!1,r&&(a(_),o(S),t._walkthroughMap[i].walkthrough.pause(),r=!1,v.removeClass("bf-routes-disabled"),f.removeClass("bf-routes-disabled"))};case"edit":return function(e){if(b=!1,!r){m(),p(),G(),a(u),a(f),o(h),o(l),M=!1;var t=l.querySelector(".bf-route-list");t.childElementCount>0&&(y=!0,n.setCameraStatus(t.firstElementChild.camera,C))}};case"delete":return function(e){b=!1,r||(v.removeChild(v.querySelector('.bf-routes-li[walkthroughId="'+i+'"]')),t.removeWalkthrough(i),8===v.childElementCount&&v.removeClass("bf-routes-list-scroll"),0===v.childElementCount&&o(g))}}};S.addEventListener("click",E("play",s)),_.addEventListener("click",E("stop",s)),L.addEventListener("click",E("edit",s)),x.addEventListener("click",E("delete",s)),P.addEventListener("click",E("select",s)),I(s),v.appendChild(k),v.childElementCount>8&&v.addClass("bf-routes-list-scroll"),h.removeClass("bf-routes-disabled"),G()}};return f.addEventListener("click",B),h.addEventListener("click",function(){if(!this.hasClass("bf-routes-disabled")){if(l.saveWalkthrough()){var e=t._walkthroughMap[s];v.querySelector('.bf-routes-li[walkthroughId="'+s+'"]').querySelector(".bf-routes-name").innerHTML=e.walkthrough._walkthrough.getName()}else v.querySelector('.bf-routes-li[walkthroughId="'+s+'"]').querySelector(".bf-routes-box").lastElementChild.click(),M&&i--;a(l),a(h),o(u),o(f)}}),e.loadWalkthrough=function(e){t.setWalkthroughList(e);for(var n in t._walkthroughMap)B(t._walkthroughMap[n])},e.stopWalkthrough=function(){if("none"!==u.style.display&&r){var e=v.querySelector('.bf-routes-li[walkthroughId="'+s+'"]').querySelector(".bf-routes-stop");e&&e.click(),r=!1,v.removeClass("bf-routes-disabled"),f.removeClass("bf-routes-disabled")}else l&&l.stopWalkthrough()},c};!function(){var e=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel")),t=function(e){var t=e.getViewer(),n=new Glodon.Bimface.UI.Panel.PanelConfig;n.title=BimfaceLanguage.bf_panel_nav_walkthrough,n.id="WalkRoutePanel",n.css={right:"10px",top:"10px",width:"300px",height:"410px"},n.enableSizable=!1;var o=new Glodon.Bimface.UI.Panel.Panel(n),n=new Glodon.Bimface.Plugins.Walkthrough.WalkthroughManagerConfig;n.viewer=t;var a=new Glodon.Bimface.Plugins.Walkthrough.WalkthroughManager(n),i=createRouteManagerPanel(a,t);return o.container.appendChild(i),o.addEventListener("Hide",function(){createRouteManagerPanel.stopWalkthrough()}),o.loadWalkthrough=createRouteManagerPanel.loadWalkthrough,a.id="WalkthroughManager",e.addPlugin(a),o};e.WalkRoutePanel=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),n=function(e){function n(){var e=u[c];k.innerText=e+"X",s.setFlySpeedRate(parseFloat(e))}function o(){c<u.length-1&&(c++,n())}function a(){c&&(c--,n())}function i(e){var t,n=w.querySelector(".gld-bf-map"),o=document.querySelector(".gld-bf-min-");o&&o.click(),!0===e?(t=!0,d.addClass("walker")):t=!b._checked,t?n.addClass("active"):n.removeClass("active"),b.setCheckedState(t)}function r(){var t=e.getPanel("WalkRoutePanel");t&&f.getWalkthrough(function(e){t.loadWalkthrough(e)})}function l(){var t=this,n=w.querySelectorAll(".bf-walk-label"),o=e.getPanel("WalkRoutePanel");if(t.hasClass("active")){t.removeClass("active"),o&&o.hide();for(var a=0;a<n.length;a++)n[a].removeClass("bf-walk-disabled"),T.disabled=!1,L.disabled=!1}else{if(t.addClass("active"),o)o.show();else{var i=new Glodon.Bimface.Application.UI.Panel.WalkRoutePanel(e);i.addEventListener("Hide",function(){t.removeClass("active");for(var e=0;e<n.length;e++)n[e].removeClass("bf-walk-disabled"),T.disabled=!1,L.disabled=!1;T.disabled=!1,L.disabled=!1}),d.appendChild(i.element),e.addPanel(i),s._manifest&&s._manifest.Features_ext&&s._manifest.Features_ext.HasWalkthrough&&r()}for(var a=0;a<n.length;a++)n[a].addClass("bf-walk-disabled");T.checked=!1,T.disabled=!0,s.enableGravity(!1),L.checked=!1,L.disabled=!0,s.enableHitDetection(!1)}}var s=e.getViewer(),d=e.getRootElement(),c=0,u=["1","2","4","8","16"],p=(s.getViewer(),Glodon.Bimface.UI.Control.ControlEvent),f=s.getDefaultModel()._getMetaDataManager(),h="sv_SE"===BimfaceLanguage.name?"565px":"530px",m={element:d,className:"bf-panel bf-walk-panel bf-walkthrough-panel",id:"WalkPanel",css:{left:"50%",bottom:"10px",width:h,minWidth:0,minHeight:0,height:"50px"},title:"",enableSizable:!1},g=e.getToolbar("MainToolbar"),v="",b=g.getControl("Map");b?(v='<div class="bf-button gld-bf-map active"></div>',b.addEventListener(p.StateChange,function(e){if(!e){w.querySelector(".gld-bf-map").removeClass("active")}})):m.css.width="461px";var y=new Glodon.Bimface.Application.Panel(m),w=t.create("div","bf-person"),C='<div class="bf-walk-button">'+v+'</div>\n                <div class="bf-walk-button"><div class="bf-button gld-bf-route" title="'+BimfaceLanguage.bf_panel_nav_walkthrough+'"></div></div>\n                      <div class="bf-walk-speed">\n                        <span class="bf-walk-name">'+BimfaceLanguage.bf_panel_nav_speed+'</span>\n                        <span class="gld-bf-minus speedBtn"></span><span class="speedNum">'+u[c]+' X</span>\n                        <span class="gld-bf-add speedBtn"></span>\n                      </div>\n                      <label class="bf-checkbox bf-walk-label">\n                        <input type="checkbox" class="bf-checkbox-input bf-walk-gravity" name="gravity"}>\n                        <span class="bf-checkbox-display"></span>\n                        <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_nav_gravity+'</span>\n                      </label>\n                      <label class="bf-checkbox bf-walk-label">\n                        <input type="checkbox" class="bf-checkbox-input bf-walk-collision" name="collision"}>\n                        <span class="bf-checkbox-display"></span>\n                        <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_nav_collision+'</span>\n                      </label>\n                      <span class="bf-walk-exit">'+BimfaceLanguage.bf_general_exit+"</span>";w.innerHTML=C,w.querySelector(".gld-bf-add").addEventListener("click",o),w.querySelector(".gld-bf-minus").addEventListener("click",a),b&&w.querySelector(".gld-bf-map").addEventListener("click",i),w.querySelector(".gld-bf-route").addEventListener("click",l),y.container.appendChild(w);var M=new Glodon.Bimface.UI.Tips.TipsConfig;M.element=d,M.html="<div>\n                            "+BimfaceLanguage.bf_panel_nav_walkTips1+'\n                            <span class="bf-tips-key">W</span>\n                            <span class="bf-tips-key">A</span>\n                            <span class="bf-tips-key">S</span>\n                            <span class="bf-tips-key">D</span>\n                            '+BimfaceLanguage.bf_panel_nav_walkTips2+'\n                            <span class="bf-tips-key">Q</span>\n                            <span class="bf-tips-key">E</span>\n                            '+BimfaceLanguage.bf_panel_nav_walkTips3+"\n                            </div>";var B=new Glodon.Bimface.UI.Tips.Tips(M);CLOUD.EditorConfig.NoKey&&B.hide(),w.querySelector(".bf-walk-exit").addEventListener("click",function(){y.hide();for(var t=e.getToolbars(),n=0;n<t.length;n++)t[n].show()}),y.addEventListener("Close",function(){B.close()}),y.addEventListener("Hide",function(){B.hide(),d.removeClass("walker");var t=e.getPanel("WalkRoutePanel");t&&t.hide()}),y.addEventListener("Show",function(){CLOUD.EditorConfig.NoKey||B.show(),d.addClass("walker"),b&&i(!0)});var k=w.querySelector(".speedNum"),T=w.querySelector(".bf-walk-gravity");T.addEventListener("change",function(){s.enableGravity(this.checked)});var L=w.querySelector(".bf-walk-collision");return L.addEventListener("change",function(){s.enableHitDetection(this.checked)}),b&&i(!0),n(),y};e.WalkPanel=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),n=function(e){function n(){var e=b[v];L.innerText=e+"X",m.setFlySpeedRate(parseFloat(e))}function o(e){e.preventDefault(),e.stopPropagation(),v<b.length-1&&(v++,n())}function a(e){e.preventDefault(),e.stopPropagation(),v&&(v--,n())}function i(e){e.preventDefault(),e.stopPropagation(),y.moveTo(CLOUD.MoveDirection.UP,1)}function r(e){e.preventDefault(),e.stopPropagation(),y.moveTo(CLOUD.MoveDirection.DOWN,1)}function l(){x=T.getBoundingClientRect(),P=[x.left+.5*x.width,x.top+.5*x.height],S=T.querySelector(".ball"),I=y.getCurrentEditor(),G={panelRadius:x.width/2,radiusPow:Math.pow(x.width/2,2),smallRadiusPow:Math.pow((x.width-S.offsetWidth)/2,2),up:[(x.width-S.offsetWidth)/2,0],down:[(x.width-S.offsetWidth)/2,x.height-S.offsetHeight],left:[0,(x.height-S.offsetHeight)/2],right:[x.width-S.offsetWidth,(x.height-S.offsetHeight)/2],refresh:[(x.width-S.offsetWidth)/2,(x.height-S.offsetHeight)/2]}}function s(e){e.preventDefault(),E=e.touches[0],p()}function d(e){e.preventDefault(),E=e.touches[0],p()}function c(e){f("refresh"),u()}function u(){y.moveTo(CLOUD.MoveDirection.FORWARD,1,!1),y.moveTo(CLOUD.MoveDirection.BACK,1,!1),y.moveTo(CLOUD.MoveDirection.UP,1,!1),y.moveTo(CLOUD.MoveDirection.DOWN,1,!1)}function p(){var e=E.pageY-P[1],t=E.pageX-P[0];_=e/t,f(_>0?_>2.2?e>0?"down":"up":e>0?"right":"left":_<-2.2?e>0?"down":"up":e>0?"left":"right")}function f(e){switch(u(),e){case"up":y.moveTo(CLOUD.MoveDirection.FORWARD,1),y.render();break;case"down":y.moveTo(CLOUD.MoveDirection.BACK,1),y.render();break;case"left":I._doRotate({x:-1,y:0});break;case"right":I._doRotate({x:1,y:0})}"refresh"==e?h():h(E)}function h(e){if(e){var t=e.pageX-P[0],n=e.pageY-P[1],o=Math.pow(t,2),a=Math.pow(n,2),i=a+o;if(Math.sqrt(i)+S.offsetWidth/2<G.panelRadius)var r=e.pageY-S.offsetHeight/2-x.top,l=e.pageX-S.offsetWidth/2-x.left;else{var s=Math.sqrt(G.smallRadiusPow*o/i),d=Math.sqrt(G.smallRadiusPow*a/i);l=e.pageX-P[0]>0?G.panelRadius+s-S.offsetWidth/2:G.panelRadius-s-S.offsetWidth/2,r=e.pageY-P[1]>0?G.panelRadius+d-S.offsetWidth/2:G.panelRadius-d-S.offsetWidth/2}S.style.left=l+"px",S.style.top=r+"px"}else S.style.left=G.refresh[0]+"px",S.style.top=G.refresh[1]+"px"}var m=e.getViewer(),g=e.getRootElement(),v=0,b=["1","2","4","8","16"],y=m.getViewer(),w={element:g,className:"bf-panel bf-walk-panel",id:"WalkPanel",css:{minWidth:"auto",minHeight:"auto",bottom:"0.12em",width:"100%",height:"3.5em"},title:"",enableSizable:!1},C=new Glodon.Bimface.Application.Panel(w),M=t.create("div","bf-quit");M.innerHTML='<span class="bf-walk-exit">'+BimfaceLanguage.bf_general_exit+"</span><span class='close'></span>",g.appendChild(M),C.addEventListener("Show",function(){M.style.display="block"});var B=t.create("div","bf-person"),k='<div class="person-btns">\n\n                      <span class="gld-bf-minus speedBtn"></span>\n                      <span class="speedNum">'+b[v]+' X</span>\n                      <span class="gld-bf-add speedBtn"></span>\n                      <label class="bf-checkbox bf-walk-gravity">\n                        <input type="checkbox" class="bf-checkbox-input bf-walk-input" name="gravity"}>\n                        <span class="bf-checkbox-display"></span>\n                        <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_nav_gravity+'</span>\n                      </label>\n                      <div class=\'jump\'>\n\n                        <span class="bf-button gld-bf-up  arrow-up"></span>\n                        <span class="bf-button gld-bf-down  arrow-down"></span>\n                      </div>\n                    </div>',T=t.create("div","controllerPanel");B.innerHTML=k,T.innerHTML='<div class="ball">\n\n                    </div>',T.addEventListener("touchstart",s),T.addEventListener("touchmove",d),T.addEventListener("touchend",c),B.querySelector(".gld-bf-add").addEventListener("click",o),B.querySelector(".gld-bf-minus").addEventListener("click",a),B.querySelector(".arrow-up").addEventListener("touchstart",i),B.querySelector(".arrow-down").addEventListener("touchstart",r),B.querySelector(".arrow-up").addEventListener("touchend",u),B.querySelector(".arrow-down").addEventListener("touchend",u),C.container.appendChild(B),C.element.appendChild(T),M.addEventListener("click",function(){C.hide(),M.style.display="none";for(var t=e.getToolbars(),n=0;n<t.length;n++)t[n].show()});var L=B.querySelector(".speedNum");B.querySelector(".bf-walk-input").addEventListener("change",function(){m.enableGravity(this.checked)});var x,P,S,_,I,G,E;return l(),window.onresize=function(){l()},C};e.WalkMobilePanel=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=e.getRootElement(),a=n instanceof Glodon.Bimface.Viewer.Viewer3D,i=Glodon.Bimface.UI.Control.ControlEvent,r=Glodon.Bimface.Viewer.Viewer3DEvent;if(!a)return void console.log("The API is not supported on this viewer.");var l=new Glodon.Bimface.UI.Button.ButtonConfig;l.id="Walk",l.title=BimfaceLanguage.bf_btn_nav,l.className="bf-button gld-bf-firstperson";var s,d,c=new Glodon.Bimface.UI.Button.ToggleButton(l);n.getViewer();return c.addEventListener(i.StateChange,function(){if(n.getEventManager().fireEvent(r.ButtonOnToolbarClicked,{id:l.id,isChecked:c.isChecked()}),c.isChecked()){var a=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),i=t.getControl("RectangleSelect");i&&i.setCheckedState(!1),n.setNavigationMode(Glodon.Bimface.Viewer.NavigationMode3D.Select);var u=t.getControl("Measure");u&&u.setCheckedState(!1),hideSectionPanel(e);var p=t.getControl("RectangleSelect");p&&p.setCheckedState(!1);var f=t.getControl("Property");f&&f.setCheckedState(!1);var h=t.getControl("Information");h&&h.setCheckedState(!1);var m=t.getControl("Setting");m&&m.setCheckedState(!1),e.modelTreePanel&&e.modelTreePanel.hide();for(var g=e.getToolbars(),v=e.getPanels(),b=0;b<v.length;b++)"WalkPanel"!=v[b].id&&"MapPanel"!=v[b].id&&v[b].isDisplay()&&v[b].hide();for(var y=0;y<g.length;y++)g[y].hide();if(d=!!document.querySelector(".bf-house canvas"),n.setNavigationMode(Glodon.Bimface.Viewer.NavigationMode3D.Walk),n.hideViewHouse(),n.getModels().forEach(function(e){e.setSelectedComponentsById()}),n.render(),s)return void s.show();s=a?new Glodon.Bimface.Application.UI.Panel.WalkPanel(e):new Glodon.Bimface.Application.UI.Panel.WalkMobilePanel(e),s.addEventListener("Hide",function(){c.setCheckedState(!1)}),o.appendChild(s.element),s.bringToFront(),e.addPanel(s)}else{for(var g=e.getToolbars(),y=0;y<g.length;y++)g[y].show();n.setNavigationMode(Glodon.Bimface.Viewer.NavigationMode3D.PickWithRect),d&&n.showViewHouse(),s.hide()}}),c};e.Walk=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=n instanceof Glodon.Bimface.Viewer.Viewer3D,a=Glodon.Bimface.UI.Control.ControlEvent;if(!o)return void console.log("The API is not supported on this viewer.");var i=new Glodon.Bimface.UI.Button.ButtonConfig;i.id="Interactive",i.title="交互",i.inheritTitle=!0;var r=new Glodon.Bimface.UI.Button.ComboBox(i),l=new Glodon.Bimface.UI.Button.ButtonConfig;l.id="OrbitPoint",l.title="绕构件旋转",l.className="bf-button gld-bf-orbit";var s=new Glodon.Bimface.UI.Button.ComboBoxOptionButton(l),d=new Glodon.Bimface.UI.Button.ButtonConfig;d.id="OrbitCamera",d.title="绕相机旋转",d.className="bf-button gld-bf-pan";var c=new Glodon.Bimface.UI.Button.ComboBoxOptionButton(d),u=new Glodon.Bimface.UI.Button.ButtonConfig;u.id="OrbitCamera",u.title="绕相机旋转",u.className="bf-button gld-bf-zoom";var p=new Glodon.Bimface.UI.Button.ComboBoxOptionButton(u);return r.addControl(s),r.addControl(c),r.addControl(p),r.addEventListener(a.Change,function(e){}),r.addEventListener(a.Click,function(e){var n=t.getControl("ViewButton");n&&n.recover()}),r};e.Interactive=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),n=function(t){var n=t.getViewer(),o=new Glodon.Bimface.UI.Panel.PanelConfig;o.title="",o.id="MapPanel",o.css={left:"12px",bottom:"10px",width:"300px",height:"240px"},o.className="bf-panel bf-map bf-map-panel",o.enableSizable=!1;var a=new Glodon.Bimface.UI.Panel.Panel(o),i=Glodon.Bimface.Plugins.Map.MapEvents,r=e.create("div","bf-map-header"),l=e.create("div","bf-map-move"),s=e.create("div","bf-map-foot"),d=e.create("div","bf-map-container"),c=e.create("i","bf-map-fit-panel-min gld-bimface gld-bf-fitpanel"),u=e.create("i","bf-map-screen gld-bimface gld-bf-max-"),p=e.create("div","bf-map-right");s.innerHTML='<div class="bf-map-left"><i class="gld-bimface gld-bf-information"></i><span>'+BimfaceLanguage.bf_panel_map_cut+"</span></div>",s.appendChild(p);var f=new Glodon.Bimface.Plugins.Map.MapConfig;f.viewer=n,f.domElement=d,f.width=298,f.height=198,f.id="Map";var h=new Glodon.Bimface.Plugins.Map.Map(f);t.addPlugin(h);var m=h.getFloorList(),g=new Glodon.Bimface.UI.Select.SelectConfig;g.className="bf-select bf-select-map";var v=h.getDefaultFloorPlane(),b=m.getObjectByAttribute("name",v);0!=b&&(g.default=b.id),g.options=m,g.element=r,g.prefix=BimfaceLanguage.bf_panel_map_level;var y=new Glodon.Bimface.UI.Select.Select(g);y.addEventListener("Change",function(e){h.showFloorById(e.id)}),u.addEventListener("click",function(){a.showAsFull(u.hasClass("gld-bf-max-")),x&&x.hide()}),c.addEventListener("click",function(){h.clearZoomAndPan(),c.getCss().display="none"});var w=function(e){e.getToolbar("MainToolbar");clearSection(e),e.tree&&e.tree.clear(!0),n.restoreDefault()},C=new Glodon.Bimface.UI.Button.ButtonConfig;C.id="mapIsolate",C.title=BimfaceLanguage.bf_panel_map_isolation,C.className="bf-map-button bf-map-isolate";var M=new Glodon.Bimface.UI.Button.Button(C);M.setHtml(BimfaceLanguage.bf_panel_map_isolation),M.addEventListener("Click",function(){w(t);var e=h.getBoundingBox();n.isolateByBox(e,Glodon.Bimface.Viewer.IsolateOption.HideOthers),n.zoomToBoundingBox(e),h.clear(),x.hide(),n.render()});var B=new Glodon.Bimface.UI.Button.ButtonConfig;B.id="mapSection",B.title=BimfaceLanguage.bf_panel_map_section,B.className="bf-map-button bf-map-section";var k=new Glodon.Bimface.UI.Button.Button(B);k.setHtml(BimfaceLanguage.bf_panel_map_section),k.addEventListener("Click",function(){var e=h.getBoundingBox();clearSection(t),updateSection(t,e),h.clear(),x.hide(),n.render()});var T=new Glodon.Bimface.UI.Button.ButtonConfig;T.id="mapCancel",T.title=BimfaceLanguage.bf_general_cancel,T.className="bf-map-button bf-map-cancel";var L=new Glodon.Bimface.UI.Button.Button(T);L.setHtml(BimfaceLanguage.bf_general_cancel),L.addEventListener("Click",function(){h.clear(),x.hide()});var x;h.addEventListener(i.Zoom,function(e){1==e.zoomFactor?c.getCss().display="none":c.getCss().display="block"}),h.addEventListener(i.MouseHoveredGrid,function(e){p.innerHTML=""}),h.addEventListener(i.FloorPlaneChanged,function(e){y._currentElement.innerText=BimfaceLanguage.bf_panel_map_level+e}),h.addEventListener("MinimapRectChanged",function(e){P(e)}),h.addEventListener("MinimapRectDestroyed",function(e){x&&x.hide()}),r.appendChild(u),r.appendChild(c),r.appendChild(l),a.container.appendChild(r),a.container.appendChild(d),a.container.appendChild(s),a.drag=new Glodon.Web.Lang.Utility.Dom.drag({element:a.element,bBoxDetection:!0,handle:l,record:function(e,t){Glodon.Bimface.UI.Panel.PanelPositions[o.className]={left:e,top:t}}}),a.showAsFull=function(e){e?(u.removeClass("gld-bf-max-"),u.addClass("gld-bf-min-"),a.addClass("bf-map-big"),a.addClass("bf-map-big-panel"),a.element.style.left="50%",a.element.style.top="50%",a.element.style.bottom="initial",c.removeClass("bf-map-fit-panel-min"),c.addClass("bf-map-fit-panel-max"),h.resize(528,420,!0)):(u.removeClass("gld-bf-min-"),u.addClass("gld-bf-max-"),a.removeClass("bf-map-big"),a.removeClass("bf-map-big-panel"),a.element.style.left="12px",a.element.style.top="initial",a.element.style.bottom="10px",c.removeClass("bf-map-fit-panel-max"),c.addClass("bf-map-fit-panel-min"),h.resize(298,198,!1)),c.getCss().display="none"};var P=function(e){if(x)x.show();else{var t=new Glodon.Bimface.UI.Toolbar.ToolbarConfig;t.className="bf-map-toolbar",x=new Glodon.Bimface.UI.Toolbar.Toolbar(t),x.addControls([M,k,L]),x.element.style.zIndex=11,d.appendChild(x.element)}var n={width:d.offsetWidth,height:d.offsetHeight},o={width:x.element.offsetWidth,height:x.element.offsetHeight};e.x+e.width<o.width?x.element.style.left=e.x+"px":x.element.style.left=e.x+e.width-o.width+"px",n.height<e.y+e.height+o.height?x.element.style.top=e.y+e.height-o.height-6+"px":x.element.style.top=e.y+e.height+6+"px"};return a};t.MapPanel=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=e.getRootElement(),a=Glodon.Bimface.UI.Control.ControlEvent,i=new Glodon.Bimface.UI.Button.ButtonConfig;i.id="Map",i.title=BimfaceLanguage.bf_btn_map,i.className="bf-button gld-bf-map";var r,l=new Glodon.Bimface.UI.Button.ToggleButton(i)
;if("ViewerDrawing"==n.viewerType)l.addEventListener(a.StateChange,function(e){e?n.enableMiniMap(!0):n.enableMiniMap(!1)});else{var s=n instanceof Glodon.Bimface.Viewer.Viewer3D,d=Glodon.Bimface.Viewer.Viewer3DEvent;if(!s)return void console.log("The API is not supported on this viewer.");l.addEventListener(a.StateChange,function(t){if(r=e.getPanel("MapPanel"))if(t)r.show();else{r.hide();var a=e.getPlugin("Map");a.clearZoomAndPan()}else r=new Glodon.Bimface.Application.UI.Panel.MapPanel(e),r.addEventListener("Hide",function(){l.setCheckedState(!1)}),o.appendChild(r.element),r.bringToFront(),e.addPanel(r),n.render();n.getEventManager().fireEvent(d.ButtonOnToolbarClicked,{id:i.id,isChecked:t})})}return l};e.Map=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=(e.getRootElement(),n instanceof Glodon.Bimface.Viewer.Viewer3D),a=Glodon.Bimface.UI.Control.ControlEvent;if(!o)return void console.log("The API is not supported on this viewer.");var i=new Glodon.Bimface.UI.Button.ButtonConfig;i.id="SectionDirection",i.title="剖切方向",i.className="bf-button gld-bf-axial";var r=new Glodon.Bimface.UI.Button.Button(i);return r.addEventListener(a.Click,function(){var t=this.hasClass("gld-bf-axial");r.toggleClassName("gld-bf-axial"),r.toggleClassName("gld-bf-axial-");var o=e.getPlugin("SectionPlane");o&&(o.setDirection(t?"Reverse":"Forward"),o.setProgress(50)),n.render()}),r};e.SectionDirection=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=n instanceof Glodon.Bimface.Viewer.Viewer3D,a=Glodon.Bimface.UI.Control.ControlEvent;if(!o)return void console.log("The API is not supported on this viewer.");var i=new Glodon.Bimface.UI.Button.ButtonConfig;i.id="SectionRecalculation",i.title=BimfaceLanguage.bf_tip_section_fitBox,i.className="bf-button gld-bf-fittobox";var r=new Glodon.Bimface.UI.Button.Button(i);return r.addEventListener(a.Click,function(){var t=e.getPlugin("SectionBox");t&&t.fitToModel(),n.render()}),r};e.SectionRecalculation=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),t=function(e){var t=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),n=new Glodon.Bimface.UI.Panel.PanelConfig;n.title=BimfaceLanguage.bf_panel_explode,n.css=t?{right:"10px",bottom:"60px",width:"200px",height:"90px"}:{maxWidth:"414px",left:"50%",transform:"translate(-50%)",bottom:"0.12em",width:"100%",height:"1.02em"},n.enableSizable=!1,n.className="bf-panel bf-explode-panel";var o=new Glodon.Bimface.UI.Panel.Panel(n);if(o.setHtml('<div class="bf-explode-range" id="dispersionRange"></div>'),!t){var a=e.getRootElement(),i=a.offsetWidth,r=a.offsetHeight;o.element.style.fontSize=100*Math.min(r,i,414)/750+"px",o.element.addClass("explode-panel");o.element.querySelector(".bf-close").innerHTML="<span class='quit'>"+BimfaceLanguage.bf_general_exit+"</span>"}return o};e.ExplodePanel=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),Glodon.Web.Lang.Utility.ClientHelper.getIsIphone(),function(e,t){window.viewer=e.getViewer();var n,o=e.getRootElement(),a=viewer instanceof Glodon.Bimface.Viewer.Viewer3D,i=Glodon.Bimface.UI.Control.ControlEvent,r=Glodon.Bimface.Viewer.Viewer3DEvent;if(!a)return void console.log("The API is not supported on this viewer.");var l=new Glodon.Bimface.UI.Button.ButtonConfig;l.id="Explode",l.title=BimfaceLanguage.bf_btn_explode,l.className="bf-button gld-bf-explode";var s,d=new Glodon.Bimface.UI.Button.ToggleButton(l);return d.addEventListener(i.StateChange,function(a){if(a){var i=t.getControl("Measure");i&&i.setCheckedState(!1),clearSection(e);var c=t.getControl("SectionBox");c&&c.setCheckedState(!1);var u=t.getControl("SectionPlane");u&&u.setCheckedState(!1),viewer.setExplosionExtent(0),viewer.render(),s=new Glodon.Bimface.Application.UI.Panel.ExplodePanel(e),s.addEventListener("Hide",function(){d.setCheckedState(!1)}),o.appendChild(s.element),n=new Glodon.Web.Lang.Utility.Dom.range({element:s.element.querySelector("#dispersionRange"),min:0,cur:0,max:3,step:.1,isShowProgress:!1,defaultColor:"#555555",currentColor:"#999999",input:function(e){viewer.setExplosionExtent(e),viewer.render()}}),e.addPanel(s)}else e.removePanel(s.id),s.close(),viewer.setExplosionExtent(0),viewer.render();viewer.getEventManager().fireEvent(r.ButtonOnToolbarClicked,{id:l.id,isChecked:a})}),d});e.Explode=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(){var e=new Glodon.Bimface.UI.Button.ButtonConfig;return e.id="Drag",e.title=BimfaceLanguage.bf_tip_roomEdit_dragNode,e.className="bf-button gld-bf-room-dragnode",new Glodon.Bimface.UI.Button.ToggleButton(e)};e.RoomEditingDrag=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(){var e=new Glodon.Bimface.UI.Button.ButtonConfig;return e.id="Add",e.title=BimfaceLanguage.bf_tip_roomEdit_addNode,e.className="bf-button gld-bf-room-addnode",new Glodon.Bimface.UI.Button.ToggleButton(e)};e.RoomEditingAdd=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(){var e=new Glodon.Bimface.UI.Button.ButtonConfig;return e.id="Delete",e.title=BimfaceLanguage.bf_tip_roomEdit_deleteNode,e.className="bf-button gld-bf-room-deletenode",new Glodon.Bimface.UI.Button.ToggleButton(e)};e.RoomEditingDelete=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(){var e=new Glodon.Bimface.UI.Button.ButtonConfig;return e.id="Height",e.title=BimfaceLanguage.bf_tip_roomEdit_editHeight,e.className="bf-button gld-bf-room-height",new Glodon.Bimface.UI.Button.ToggleButton(e)};e.RoomEditingHeight=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(){var e=new Glodon.Bimface.UI.Button.ButtonConfig;return e.id="Translation",e.title=BimfaceLanguage.bf_general_move,e.className="bf-button gld-bf-translation",new Glodon.Bimface.UI.Button.ToggleButton(e)};e.ModelEditingTranslate=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(){var e=new Glodon.Bimface.UI.Button.ButtonConfig;return e.id="Rotation",e.title=BimfaceLanguage.bf_general_rotate,e.className="bf-button gld-bf-rotation",new Glodon.Bimface.UI.Button.ToggleButton(e)};e.ModelEditingRotate=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(){var e=new Glodon.Bimface.UI.Button.ButtonConfig;return e.id="Scaling",e.title=BimfaceLanguage.bf_general_zoom,e.className="bf-button gld-bf-scaling",new Glodon.Bimface.UI.Button.ToggleButton(e)};e.ModelEditingScale=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),n=function(e){var n=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),o=new Glodon.Bimface.UI.Panel.PanelConfig;o.title=BimfaceLanguage.bf_btn_layers,o.className="bf-panel bf-layers-panel",o.id="LayersPanel",o.css=n?{left:"10px",top:"10px",width:"300px",height:"416px"}:{left:0,top:0,width:"100%",height:"100%",zIndex:9999};var a=new Glodon.Bimface.UI.Panel.Panel(o);a.element.addClass("layers-panel");var i=e.getLayers();this.layers=i;var r=0;i.map(function(e){e.visible||r++});var l=t.create("ul","bf-layers bf-scroll-bar"),s=t.create("div","bf-allLayers"),d=void 0;r==i.length?(d="gld-bf-hide",s.addClass("disable")):d="gld-bf-show",s.innerHTML="<span title='显示' class='eyes "+d+"'></span><span   class='name'>"+BimfaceLanguage.bf_panel_layers_all+"</span>",s.addEventListener("click",function(){var t=this.hasClass("disable");t?(e.showAllLayers(),c(!0)):(e.hideAllLayers(),c(!1)),this.toggleClass("disable");var n=this.querySelector(".eyes");n.setAttribute("title",t?"显示":"隐藏"),n.toggleClass("gld-bf-show"),n.toggleClass("gld-bf-hide")});var c=function(e){for(var t=l.querySelectorAll(".bf-layer"),n=0,o=t.length;n<o;++n){var a=t[n],i=a.querySelector(".eyes");e?a.removeClass("disable"):a.addClass("disable"),a.setAttribute("visible",e),i.addClass(e?"gld-bf-show":"gld-bf-hide"),i.removeClass(e?"gld-bf-hide":"gld-bf-show"),i.setAttribute("title",e?"显示":"隐藏")}};i=Glodon.Web.Lang.Utility.ClientHelper.sortByName(i);for(var u=0,p=i.length;u<p;++u){var f,h,m=t.create("li","bf-layer"),g=i[u],v=e.getColor(g.color);g.visible?(f="gld-bf-show",h="显示"):(f="gld-bf-hide",h="隐藏",m.addClass("disable")),m.innerHTML="<span title='"+h+"' class='eyes "+f+"'></span><span class='color'style='background:"+v+"'></span><span   class='name'>"+g.name+"</span>",m.setAttribute("layer-id",g.id),m.setAttribute("visible",g.visible),m.addEventListener("click",function(){this.toggleClass("disable");var t=this.querySelector(".eyes");t.toggleClass("gld-bf-show"),t.toggleClass("gld-bf-hide");var n=this.getAttribute("visible"),o=this.getAttribute("layer-id");n="true"!=n,this.setAttribute("visible",n),this.querySelector(".eyes").setAttribute("title",n?"显示":"隐藏");var a=s.querySelector(".eyes");n?(e.showLayer(o),s.removeClass("disable"),a.addClass("gld-bf-show"),a.removeClass("gld-bf-hide"),a.setAttribute("title","显示")):(0==l.querySelectorAll(".gld-bf-show").length&&(s.addClass("disable"),a.removeClass("gld-bf-show"),a.addClass("gld-bf-hide"),a.setAttribute("title","隐藏")),e.hideLayer(o))}),l.appendChild(m)}return a.container.appendChild(s),a.container.appendChild(l),e.changeLayers(i),a.element.setCss({border:"solid 1px #333333"}),this.update=function(t){for(var n=0,o=this.layers.length;n<o;++n){var a=this.layers[n];a.id==t.id&&(a.visible=t.visible)}e.changeLayers(this.layers),e.update()},a};e.LayersPanel=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=e.getRootElement(),a=Glodon.Bimface.UI.Control.ControlEvent,i=new Glodon.Bimface.UI.Button.ButtonConfig;i.id="Layers",i.title=BimfaceLanguage.bf_btn_layers,i.className="bf-button gld-bf-layers";var r,l=new Glodon.Bimface.UI.Button.ToggleButton(i);return l.addEventListener(a.StateChange,function(t){r=e.getPanel("LayersPanel"),r?t?r.show():r.hide():(r=new Glodon.Bimface.Application.UI.Panel.LayersPanel(n),o.appendChild(r.element),r.bringToFront(),e.addPanel(r),r.addEventListener("Hide",function(){l.setCheckedState(!1)}))}),l};e.Layers=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),n=function(e){function n(t,n){var o=d.getObjectByAttribute("id",t),a=o.frames.getObjectByAttribute("id",n),i=a.bbox,l=e.getToolbar("LeftSubToolbar");l&&l.getControl("LayoutList").setSelectedUiById(0==t&&"Model"||t),r.zoomToBoundingBox([i.slice(0,2),i.slice(2,4)])}function o(t,n){var o=d.getObjectByAttribute("id",t),a=o.frames.getObjectByAttribute("id",n),i=e.getPanel("DrawingFramePanel"),s=r._viewMetaData||r._data,c=s.dataEnvType,u=new Glodon.Bimface.UI.Panel.PanelConfig;u.title=a.name,u.className="bf-panel bf-drawingFrame-panel",u.id="DrawingFramePanel",u.css={left:"0",top:"0",width:"100%",height:"100%"},i=new Glodon.Bimface.UI.Panel.Panel(u),i.element.addClass("frame-panel"),l.appendChild(i.element),i.bringToFront();var p=new Glodon.Bimface.Application.WebApplicationDrawingConfig;p.Buttons.removeByValue("Sheets"),p.domElement=i.element.querySelector(".bf-panel-container");var f=new Glodon.Bimface.Application.WebApplicationDrawing(p);"Local"==c?f.getViewer().addModel(s,null,null,n):f.loadFrame(s.viewToken,n),e.addPanel(i),i.addEventListener("Hide",function(){f.getViewer().destroy(!0),i.destroy(),e.removePanel("DrawingFramePanel")})}function a(e){d=e;for(var a=t.create("ul","bf-sheets bf-scroll-bar"),i=0,r=d.length;i<r;i++){var l=t.create("li","bf-sheet"),s=d[i],u=t.create("span","bf-sheet-title");t.create("div","bf-sheet-frames");u.innerHTML="<span >"+s.name+"</span>",l.setAttribute("sheet-id",s.id),l.appendChild(u);for(var p=0,f=s.frames.length;p<f;p++){var h=s.frames[p],m=t.create("div","bf-sheet-row");m.setAttribute("frame-id",h.id),m.innerHTML='<div title="'+h.name+'"  class="bf-sheet-frameName">'+h.name+'</div><span title="'+BimfaceLanguage.bf_panel_viewSheet+'" class="bf-sheet-icon gld-bf-export bf-button"></span><div  title="'+h.number+'" class="bf-sheet-frameNumber">'+h.number+"</div>",l.appendChild(m)}a.appendChild(l)}a.addEventListener("click",function(e){var t=e.target,a=void 0,i=void 0;a=t.parentElement.parentElement.getAttribute("sheet-id"),i=t.parentElement.getAttribute("frame-id"),"bf-sheet-icon gld-bf-export bf-button"==t.className?o(a,i):"bf-sheet-row"==t.parentElement.className&&n(a,i)}),c.container.appendChild(a),c.element.setCss({border:"solid 1px #333333"})}var i=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),r=e.getViewer(),l=e.getRootElement(),s=new Glodon.Bimface.UI.Panel.PanelConfig;s.title=BimfaceLanguage.bf_btn_sheets,s.className="bf-panel bf-sheets-panel",s.id="SheetsPanel",s.css=i?{left:"10px",bottom:"70px",width:"320px",height:"230px"}:{left:0,top:0,width:"100%",height:"100%",zIndex:9999};var d=void 0,c=new Glodon.Bimface.UI.Panel.Panel(s);return c.element.addClass("sheets-panel"),r.getDrawingFrame(function(e){a(e.data||[])}),c};e.SheetsPanel=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=(e.getViewer(),e.getRootElement()),o=Glodon.Bimface.UI.Control.ControlEvent,a=new Glodon.Bimface.UI.Button.ButtonConfig;a.id="Sheets",a.title=BimfaceLanguage.bf_btn_sheets,a.className="bf-button gld-bf-split-drawings";var i,r=new Glodon.Bimface.UI.Button.ToggleButton(a);return r.addEventListener(o.StateChange,function(t){i=e.getPanel("SheetsPanel"),i?t?i.show():i.hide():(i=new Glodon.Bimface.Application.UI.Panel.SheetsPanel(e),n.appendChild(i.element),i.bringToFront(),e.addPanel(i),i.addEventListener("Hide",function(){r.setCheckedState(!1)}))}),r};e.Sheets=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=n instanceof Glodon.Bimface.Viewer.Viewer3D,a=Glodon.Bimface.UI.Control.ControlEvent;if(!o)return void console.log("The API is not supported on this viewer.");var i=new Glodon.Bimface.UI.Button.ButtonConfig;i.id="SectionBoxReverse",i.title=BimfaceLanguage.bf_panel_section_reverse,i.className="bf-button gld-bf-reverse-lg";var r=new Glodon.Bimface.UI.Button.ToggleButton(i);return r.addEventListener(a.StateChange,function(t){var o=e.getPlugin("SectionBox");o&&(t?o.changeClipDirection(!0):o.changeClipDirection(!1)),n.render()}),r};e.SectionBoxReverse=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Toolbar"),t=function(){var e={id:"MainToolbar",title:"主菜单",className:"bf-toolbar bf-toolbar-bottom",buttons:["Home","Person","OrbitButton","RectangleSelect","Measure","Section","Annotation","Property","Information","Setting","FullScreen"]},t=new Glodon.Bimface.UI.Toolbar.ToolbarConfig;return Object.assign({},t,e)};e.MainToolbarConfig=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Toolbar"),t=function(){var e={id:"SectionToolbar",title:"剖切",className:"bf-section-box",buttons:["SectionBoxVisiable","SectionBoxReverse","SectionRecalculation","SectionReset"]},t=new Glodon.Bimface.UI.Toolbar.ToolbarConfig;return Object.assign({},t,e)};e.SectionToolbarConfig=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Toolbar"),t=function(){var e={id:"FamilyTypes",title:"FamilyTypes",className:"bf-toolbar bf-toolbar bf-toolbar-select",buttons:["FamilyList"]},t=new Glodon.Bimface.UI.Toolbar.ToolbarConfig;return Object.assign({},t,e)};e.FamilyListConfig=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Toolbar"),t=function(){var e={id:"ModelTree",title:"ModelTree",className:"bf-toolbar bf-toolbar bf-tree-toolbar",buttons:["ModelTree"]},t=new Glodon.Bimface.UI.Toolbar.ToolbarConfig;return Object.assign({},t,e)};e.ModelTree=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Toolbar"),t=function(){var e={id:"FamilyTypes",title:"FamilyTypes",className:"bf-toolbar bf-toolbar bf-toolbar-select",buttons:["FamilyList"]},t=new Glodon.Bimface.UI.Toolbar.ToolbarConfig;return Object.assign({},t,e)};e.LeftSubToolbarConfig=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Toolbar"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),n=function(e,n){for(var o=new Glodon.Bimface.UI.Toolbar.Toolbar(e),a=0,i=e.buttons.length;a<i;a++)if(t[e.buttons[a]]){var r=t[e.buttons[a]](n,o);o.addControl(r)}return o};e.Toolbar=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Menu"),t=function(e,t,n){var o=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),a=!!Glodon.Bimface.Viewer.ViewerDrawingSet&&e.getViewer()instanceof Glodon.Bimface.Viewer.ViewerDrawingSet,i=a?e.getActiveViewer():e.getViewer(),r=!!Glodon.Bimface.Viewer.Viewer3D&&i instanceof Glodon.Bimface.Viewer.Viewer3D,l=r?e.getRootElement():i.getDomElement(),s=Glodon.Bimface.UI.Control.ControlEvent,d=null,c=new Glodon.Bimface.UI.Menu.MenuConfig;c.element=l;var u=new Glodon.Bimface.UI.Menu.Menu(c),p=function(){u&&(u.destroy(),u=null),l.removeEventListener("mousedown",Z),Y.removeEventListener("mousedown",Z)};if(r){var f=void 0,h=!0;for(var m in t){var g=t[m];if(f||1!==g.length){if(g.length>1||1===g.length&&f&&f.id!==g[0]){f=void 0,d=void 0,h=!1;break}}else f={modelId:m,id:g[0]},d=n[g[0]],h=!1}var v,b=e.getToolbar("MainToolbar");b&&(v=b.getControl("Property")||b.getControl("MobileProperty"));var y=new Glodon.Bimface.UI.Menu.MenuItemConfig;y.id="showProperty";var w=new Glodon.Bimface.UI.Menu.MenuItem(y);w.setText(BimfaceLanguage.bf_btn_props),w.addEventListener(s.Click,function(){!v||v.isChecked()||w.isDisabled||v.setCheckedState(!0),p()});var C=new Glodon.Bimface.UI.Menu.MenuItemConfig;C.id="areaProperty";var M=new Glodon.Bimface.UI.Menu.MenuItem(C);M.setText(BimfaceLanguage.bf_tip_props_rooms),M.addEventListener(s.Click,function(){var t=e.getPanel("AreaPropertyPanel");t||(t=new Glodon.Bimface.Application.UI.Panel.AreaPanel(e),t.addEventListener("Close",function(){e.removePanel(t.id)}),t.addEventListener("Hide",function(){t.close()}),showAreaProperty(i,t,d,f),l.appendChild(t.element),t.initPosition(),e.addPanel(t)),p()});var B=new Glodon.Bimface.UI.Menu.MenuItemConfig;B.id="areaEdit";var k=new Glodon.Bimface.UI.Menu.MenuItem(B);k.setText(BimfaceLanguage.bf_contextmenu_roomEdit),k.addEventListener(s.Click,function(){if(p(),o){var t=e.getPlugin("RoomEditorToolbar");if(t){t.roomId=f.id;var n=t.switchToolbar.getControls();t.uncheckOthers("Drag",n),t.roomEditor.activateByRoomId(f.id),t.roomEditor.onEnter()}else{var a=new Glodon.Bimface.Plugins.SpatialRelation.RoomEditorToolbarConfig;a.viewer=i,a.roomId=f.id,t=new Glodon.Bimface.Plugins.SpatialRelation.RoomEditorToolbar(a),e.addPlugin(t)}t.show()}});var T=function(e){i.getModels().forEach(e);var t=i._getExternalComponentModel();t&&e(t)},L=new Glodon.Bimface.UI.Menu.MenuItemConfig;L.id="HideComponents";var x=new Glodon.Bimface.UI.Menu.MenuItem(L);x.setText(BimfaceLanguage.bf_contextmenu_hide),x.addEventListener(s.Click,function(){T(function(e){var n=t[e.modelId];e.hideComponentsById(n),e.setSelectedComponentsById()}),i.render(),p()});var P=new Glodon.Bimface.UI.Menu.MenuItemConfig;P.id="SetComponentsOpacityssddd";var S=new Glodon.Bimface.UI.Menu.MenuItem(P);S.setText(BimfaceLanguage.bf_contextmenu_transparent),S.addEventListener(s.Click,function(){T(function(e){var n=t[e.modelId];e.setComponentsOpacity(n,Glodon.Bimface.Viewer.OpacityOption.Translucent),e.setSelectedComponentsById()}),i.render(),p()});var _=new Glodon.Bimface.UI.Menu.MenuConfig;_.id="IsolateMenu",_.isSubMenu=o&&!0||!1,_.text=BimfaceLanguage.bf_contextmenu_isolate,_.className="bf-sub-menu";var I=new Glodon.Bimface.UI.Menu.Menu(_),G=new Glodon.Bimface.UI.Menu.MenuItemConfig;G.id="HideOthers";var E=new Glodon.Bimface.UI.Menu.MenuItem(G);E.setText(BimfaceLanguage.bf_contextmenu_isolate_hidden),E.addEventListener(s.Click,function(){T(function(e){var n=t[e.modelId];e.isolateComponentsById(n,Glodon.Bimface.Viewer.IsolateOption.HideOthers),e.setSelectedComponentsById()}),i.render(),p()});var N=new Glodon.Bimface.UI.Menu.MenuItemConfig;N.id="MakeOthersTranslucent";var U=new Glodon.Bimface.UI.Menu.MenuItem(N);U.setText(BimfaceLanguage.bf_contextmenu_isolate_translucent),U.addEventListener(s.Click,function(){T(function(e){var n=t[e.modelId];e.isolateComponentsById(n,Glodon.Bimface.Viewer.IsolateOption.MakeOthersTranslucent),e.setSelectedComponentsById()}),i.render(),p()}),I.addControl(E),I.addControl(U);var A=new Glodon.Bimface.UI.Menu.Spacer,D=new Glodon.Bimface.UI.Menu.Spacer,z=new Glodon.Bimface.UI.Menu.MenuItemConfig;z.id="ShowAll";var V=new Glodon.Bimface.UI.Menu.MenuItem(z);V.setText(BimfaceLanguage.bf_contextmenu_showAll),V.addEventListener(s.Click,function(){resetSection(e),e.tree&&"areaPanel"!=e.tree.element.id&&"drawingPanel"!=e.tree.element.id&&e.tree.clear(!0),T(function(e){e.activateAllComponents(),e.clearIsolation(),e.clearSelectedComponents(),e.showAllComponents(),e.opaqueAllComponents()}),i.render(),p();var t=e.getPlugin("SectionPlane");t&&t.coordinateSystem.update(!0)}),!d||"room"!=d.toLocaleLowerCase()&&"area"!=d.toLocaleLowerCase()?h?(u.addControl(V),u.oneOption=!0):(v&&(u.addControl(w),u.addControl(A)),u.addControl(x),u.addControl(S),u.addControl(I),u.addControl(D),u.addControl(V),"ExternalComponent"==d&&w.disabled()):(u.addControl(M),u.addControl(k),u.addControl(A),u.addControl(V),!o&&k.disabled(),u.oneOption=!0)}else{var W=t;if(W.length>0){var H=new Glodon.Bimface.UI.Menu.MenuItemConfig;H.id="hideElement";var F=new Glodon.Bimface.UI.Menu.MenuItem(H);F.setText(BimfaceLanguage.bf_contextmenu_hideElement),F.addEventListener(s.Click,function(){i.hideElementsById(W),i.clearSelection(),p()}),u.addControl(F),u.addControl(new Glodon.Bimface.UI.Menu.Spacer);var O=new Glodon.Bimface.UI.Menu.MenuItemConfig;O.id="hideLayer";var R=new Glodon.Bimface.UI.Menu.MenuItem(O);R.setText(BimfaceLanguage.bf_contextmenu_hideLayer),R.addEventListener(s.Click,function(){var e=i.getLayerIdFromElementId(W[0]);i.hideLayer(e),q(e),i.clearSelection(),p()}),u.addControl(R),u.addControl(new Glodon.Bimface.UI.Menu.Spacer)}var z=new Glodon.Bimface.UI.Menu.MenuItemConfig;z.id="showAll";var V=new Glodon.Bimface.UI.Menu.MenuItem(z);V.setText(BimfaceLanguage.bf_contextmenu_showAll),V.addEventListener(s.Click,function(){j(!0),i.showAllLayers(),i.showAllElements(),p()}),u.addControl(V);var j=function(e){var t=document.querySelector(".bf-allLayers");if(t){t.removeClass("disable");var n=t.querySelector(".eyes");n.addClass(e?"gld-bf-show":"gld-bf-hide"),n.removeClass(e?"gld-bf-hide":"gld-bf-show"),n.setAttribute("title",e?"显示":"隐藏");for(var o=t.nextSibling,a=o.querySelectorAll(".bf-layer"),i=0,r=a.length;i<r;++i){var l=a[i],n=l.querySelector(".eyes");e?l.removeClass("disable"):l.addClass("disable"),l.setAttribute("visible",e),n.addClass(e?"gld-bf-show":"gld-bf-hide"),n.removeClass(e?"gld-bf-hide":"gld-bf-show"),n.setAttribute("title",e?"显示":"隐藏")}}},q=function(e){var t=document.querySelector(".bf-layers");if(t)for(var n=t.querySelectorAll(".bf-layer"),o=0,a=n.length;o<a;++o){var i=n[o];if(i.getAttribute("layer-id")==e){i.setAttribute("visible",!1),i.toggleClass("disable");var r=i.querySelector(".eyes");if(r.toggleClass("gld-bf-show"),r.toggleClass("gld-bf-hide"),r.setAttribute("title","隐藏"),0==t.querySelectorAll(".gld-bf-show").length){var l=document.querySelector(".eyes");document.querySelector(".bf-allLayers").addClass("disable"),l.removeClass("gld-bf-show"),l.addClass("gld-bf-hide"),l.setAttribute("title","隐藏")}break}}}}var Z=function(){p()};l.addEventListener("mousedown",Z);var Y=r?i.getDomElement():i.getRootElement();return Y.addEventListener("mousedown",Z),u};e.ContextMenu=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Viewer"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom")),n=Glodon.Bimface.Data.StatisticsDataManager.getInstance(),o=function(e){var o,a=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop();if(a)o=t.create("div","bf-container"),e.EnableFamilyList&&!e.Toolbars.includes("FamilyList")&&e.Toolbars.push("FamilyList"),!e.EnableFamilyList&&e.Toolbars.includes("FamilyList")&&e.Toolbars.removeByValue("FamilyList");else{e.Toolbars=["FamilyList","MainToolbar"],e.Buttons=["Home","ViewButton","Measure","Section","Explode"],e.enableViewHouse=!1,o=t.create("div","bf-container  bf-mobile bf-mobile-rfa");var i=e.domElement.offsetWidth,r=e.domElement.offsetHeight;o.style.fontSize=90*Math.min(i,r,414)/750+"px"}var l=this,s=e;l.toolbars=[],l._rootElement=o,e.domElement.appendChild(o),s.domElement=o,this.getViewer=function(){return d},this.getEventManager=function(){return u},this.getToolbars=function(){return l.UI.getToolbars()},this.getToolbar=function(e){return"LeftToolbar"==e&&(e="ModelTree"),l.UI.getToolbar(e)},this.render=function(){this.getViewer().render()},this.addView=function(e){d.addView(e)},this.getAnnotationManager=function(){return l.getPlugin("Annotation")},this._mainToolbarAdaptive=function(){var e=l.getToolbars();if(e&&e.length>=2&&!!l.getToolbar("MainToolbar")){var t=l.getToolbar("MainToolbar");l._rootElement.offsetWidth<1e3?t.addClassName("bf-toolbar-bottom-float-right"):t.removeClassName("bf-toolbar-bottom-float-right")}},this.addEventListener=Glodon.Bimface.Viewer.Viewer3D.prototype.addEventListener,this.removeEventListener=Glodon.Bimface.Viewer.Viewer3D.prototype.removeEventListener;var d=new Glodon.Bimface.Viewer.Viewer3D(s),c=Glodon.Bimface.Viewer.Viewer3DEvent,u=d.getEventManager();d.addEventListener(c.ViewAdded,function(e){var t=d.getViewer(),o=t.getNumOfElements(),a=t.getNumOfTriangles(),i={eventId:"加载",loadModel:"normal",type:"rfa",elements:o,triangles:a};n.send("Glodon.Bimface.Application.WebApplicationRfa","ViewAdded",i),d.getFamilyTypes(function(e){d.getDefaultModel().showFamilyTypeById(e[0].id),d.render()}),l.UI.init(),l._mainToolbarAdaptive(),window.addEventListener("resize",function(e){l._mainToolbarAdaptive()})}),d.addEventListener(c.AddView,function(t){if(1===t){var n=new Glodon.Bimface.Application.UI.UIConfig;n=Object.assign(n,e),n.element=o,n.viewer=d,l.UI=new Glodon.Bimface.Application.UI.UI(n)}}),d.addEventListener(c.RemoveView,function(e){0==e&&(l.UI.destroy(),l.UI=null)})};e.WebApplicationRfa=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=function(){var e={Toolbars:["MainToolbar","LeftSubToolbar"],Buttons:["Home","RectZoom","FullScreen"]},t=Glodon.Bimface.Viewer.Viewer2DConfig();return Object.assign({},e,t)};e.WebApplication2DConfig=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=Object.freeze({Loaded:"Loaded",Error:"Error"});e.WebApplication2DEvent=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=function(e){var t=new Glodon.Bimface.UI.Toolbar.ToolbarConfig,n=Object.assign({},t,e);return new Glodon.Bimface.UI.Toolbar.Toolbar(n)},n=function(e){for(var n=[],o=0,a=e.length;o<a;o++)n.push(t(e[o]));this._Toolbars=n};n.prototype.getToolbar=function(e){return this._Toolbars.getObjectByAttribute("id",e)},e.Toolbar=t,e.Toolbars=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=function(e){var t=new Glodon.Bimface.UI.Button.ButtonConfig,n=Object.assign({type:"Button"},t,e),o=(Glodon.Bimface.UI.Control.ControlEvent,new Glodon.Bimface.UI.Button[n.type](n));for(var a in n.handles)o.addEventListener(a,n.handles[a]);return n.html&&o.setHtml(n.html),o},n=function(e){for(var n=[],o=0,a=e.length;o<a;o++){var i=t(e[o]);if("ComboBox"==e[o].type){var r=e[o].options;for(var l in r)i.addControl(t(r[l]))}n.push(i)}this._Buttons=n};n.prototype.getButtons=function(e){return this._Buttons},n.prototype.getButton=function(e){return this._Buttons.getObjectByAttribute("id",e)},e.Button=t,e.Buttons=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=function(e){var t=new Glodon.Bimface.UI.Panel.PanelConfig,n=Object.assign({},t.css,e.css),o=Object.assign({},t,e);return o.css=n,new Glodon.Bimface.UI.Panel.Panel(o)};e.Panel=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=function(e,t,n,o,a){var i=new Glodon.Bimface.UI.Tree.TreeNodeConfig;i.hasCheckbox=o,i.isChecked=!0,i.selection=a;var r=new Glodon.Bimface.UI.Tree.TreeNode(i);return r.element.setAttribute("data-filter",n),r.setTitle(""),r.setData(e,t),r};e.Tree=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Viewer"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom")),n=Glodon.Bimface.Data.StatisticsDataManager.getInstance(),o=function(e){var o,a=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop();if(a)o=t.create("div","bf-container");else{e.Toolbars=["LeftSubToolbar"],e.Buttons=[],e.enableViewHouse=!1,o=t.create("div","bf-container  bf-mobile bf-mobile-dwg");var i=e.domElement.offsetHeight;o.style.fontSize=75*i/1340+"px"}var r=this,l=e,s=(Glodon.Bimface.Viewer.NavigationMode2D,Glodon.Bimface.Viewer.Viewer2DEvent);e.domElement.appendChild(o),l.domElement=o;var d=new Glodon.Bimface.Viewer.Viewer2D(l);this.load=function(e){d.load(e)},this.getViewer=function(){return d},this.getToolbars=function(){return g},this.getToolbar=function(e){return g.getToolbar(e)},this._panels={};var c={MainToolbar:{id:"MainToolbar",title:"MainToolbar",element:o,className:"bf-toolbar bf-toolbar-bottom"},LeftSubToolbar:{id:"LeftSubToolbar",title:"LeftSubToolbar",element:o,className:"bf-toolbar bf-toolbar-select"}},u={Home:{id:"Home",title:"适应屏幕",className:"bf-button gld-bf-home",handles:{Click:function(){d.home()}}},RectZoom:{id:"RectZoom",title:"框选",type:"ToggleButton",className:"bf-button gld-bf-zoomrect",handles:{Click:function(){var e=v.getControl("RectZoom");d.rectZoom(),d.addEventListener(Glodon.Bimface.Viewer.Viewer2DEvent.ViewZooming,function(){d.setNavigationMode(Glodon.Bimface.Viewer.NavigationMode2D.Pan),e.setCheckedState(!1),d._opt.enableZoomRect=!1})}}},Information:{id:"Information",title:"关于BIMFACE",className:"bf-button gld-bf-information",type:"ToggleButton",handles:{Click:function(){if(this.hasClass("bf-checked"))if(r._panels.InformationPanel)r._panels.InformationPanel.show();else{var e=new Glodon.Bimface.Application.Panel(p.Information)
;e.setHtml('<div class="bf-info"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANEAAAAfCAYAAAB52CgrAAAABGdBTUEAALGPC/xhBQAAFJlJREFUeAHlXAt8VcWZn5lzbyAQIIRAoSISEnyBVq1u17oqspqg5WeLq65WixV8oNQVpGopdqtWVizUoi1QFJDCyq9VKau7KyGAPBStRayPtVLzIKBSH0A0JCHJvWdm/9+5Z86dc+85ed5AKPPLZGa++WbmO+fMf75vvjPn8q/s3jDCbrJPZUaQ3KpiPD5MSB7RZNtSasSI/LLdHx4YyBrVWZrupIL9jSnZhymR46P3772lV4OKNDQ1nGfSbcFraoqKt5m0oHywbGrXgZHj3tP8A6pK/4HH+SBdTk1VlFXsLyjZmUrv6rJSiudVrb/UspUIG6tntnr1o+PHHQir13T01Qf50xDzNK2DaRztXuWc17a3PWSguZCNWI/2sr3t28KPMU4AXwGifx61pXGS5zPI96dkMT2Hceg6oog8vbZdlCaM1RhpaoqN54z/C2PqAt2cMzWfSTXZZs7Dc8jgmV5dsS9PgoaGYyEI2iQCV+w55E5VTCbBaIk5/Iu6wXWcC8XV6UypqQb/H/PKS5eeXtRj+WZ+ET3YwODIxtkVTLELNQNX4nHk76RyfnnpWZLxYYrLXynFBmsenXLODnEmLur/QelDB0aW/ARyK13XlWl+1dqT8ipLL2eKD8M9/EHgWJwtbGgSX0XdE4H1IOIe90IyB/EWxB6ImQi0AI1uT0eQoxD8OxD7Ib6O8nm4l3Z7+gjjRV80ka9HvBdxVBhfe+jo83bItyi1DehTQLsP8bjUug6WbfQ5TGCw+Yqp1QDl1rCOuMWnK8m+jRk4Blc8E9e9E+3QJiQQgKQagWlwFTTUjWiTzThf4OdWV71T0fT0GLXJ03b+ekjE2aMA739hvdiSWueUOeunbLWEWeIO8H6SygM571cxiYejZg0oL1vkPrBUtoyW88o3nCptthnAnyO5XIOL2JM2AACEe9KDFqq0OpcAWYci+zbiHYiZAhD1PgJ90yrcnjALzAQgCt9AvNLJdfIf5CCNQPNoBWJGAOSKdJKbOgk9d0Qag4CVKQBR3xZibgTLHfAAICk1DRMWtKRGIi4NIPCNwYSoIhpjcpZSYjYm7mq08zSSU+UCCPSrUV9GNOQnYYxlGGkBCp5GIh4AiQFI14VoJLr4X6LtdNwGdJTUSM5Yic4BJLaEW+ImbhsaibM/o8FeaKgJDhuTtw6oKI3cr9Qt93eROdK/cv1pTMY3YEzHvLQYXwSL+E6uYms8eV0AgWcy7nZLZscStCny2jH2LvIViJ3RpjG0fxr3k9I2Bdx/AvP1Kcw/Qvn3KbSOFJejkfN83MYNSN9C/NQtByWtXf9naDQ7peGdKH/PoH2E/JuIcYPWkez7aPTXhBZIAxKqYNNxkdBADoDShkgCyXuuBoBS2X1AYurrur4NQCIQmkDSTZOpUilA4vlCRO6RdhwPOnnPaeI+VrEuCiDdmGkgDdxVdkY8Fl+P0fK1YBjvRMHi52PxWIWL+C7uqaOBSA7NE5Tiemlilbh1jUgnYOKXBvEeBtoMjJGquc6AjOM6IxPaX45+rzbk/zXy96JPAlLGAsYR6Ow+o0PaDszAOJ0FkNclDZAIGkhk2in2CuORH5IJFwwg3YiAxHcirmGCzyMTDkKbN0YzOinqJmH1zcYFkFr1ArVpzbQDzy9d0+5lr6GZcYDkmnaCz5QyDjNIpW/ElZoIIK28SilSxRkJ+RXrvh6PyY3ozAOQ7him8jSmrFXQ4v9BJlxrAHLbjdftkc7rzGQ1+ml3Fvd8ABrdbDTcbORnGvmOZKcbjZbhGmGSZxZAbv/9kdJ1UChHnI5xMgYg6jTCo9Y0yuggbJsNLyx5ofqjlwbxJlmJh/8zXQcLcK+0xTLBlc9Gz+7R9zVpNfVuamjeDQEXa35LqP0S9gy2jtqedqr6WFlv1kbtch6TL2peSt/dE7sQCU1GJ0AT3sVEEufcthVke167s6K9+lTJpnq//DGZlcsLf7VfVDVwIV7SfaWmGz57eRSA9N6zndwgF5WX96hhVaN5VDyYOoYuSyUOwhpdzISaACB58oq42qd5UtJhRnmLkT/cWdqP9XYHfR3ptYi7EHsiXgCQnYvn/Rry7Qpol40G5xuNOgtIo6u0LI2lwzbIK3UhU2lExez5vs7gRKiuXD9+f1Ex2fEf++paLhxCdeikNZvuRwEeswKYNyOh6bw9Esp/QZW3wVRSPcpsO4kiy5pBsoHH2WPEGg6OAI8nP/ZgtTISnVyjdsMbyHapuL0GqQ/wWg5Re2jmxtp1swCk73YUSAMqN5xToyqvxKSYqGLp3kFnLM439eqd92RT/YErlC3PgGb6vpYBnkXaEz2ty0aaZeTrjfxhy+KaCDwEIh0exgT8BPSnQLjNJdLkJ7OsvYG8ktoSqEa/tI/pqoB1ywtt3gt6LdqQSU5QMGsnglLygja07RQLvM034OoCvHbB3XIAiEn7WwDNmCAOAhCzopNZPP4Yl/bgmqKStYyLCQBmUxA/0TAhrt5YsW5VR0w7AhBMxjLIkxvWP7T4puze+eP3fvXsBrj/bwOADsIkXR7K370qyK2uzWHaQL/gijcPqe3mx+MeeoueS2tL0stg0oaFQTq6sh6INIBa3gNl9uLwAJw9EiZbivvbP44HIMXG+msSJRNAmKi0yjmhq4CkAYR71SYAaXmQ3nE0AAnPhTThXYbcj0BbwGeChTbhoX3GraNVnjx1x3RwQHQkAKTveitAUh0FkO4/00BqI4A2aw2k5TDSowFI10Peoa7Me5CuMuSnLL0A1uEaPMMTdOFYTMWRBJC+4RpIOF3g00hwLPzQMeFCNBDWRc+EMzWQ7lenmQJSOwD0LTLh9PgBqQMkuL6XB9QdURKeBS2s9xhC/ALax7eXQPkd1GunEL0mudvgP+ayES6yXmPCMXGf11dv25JuUmDAcZ1RVkT43hv0ZtGdYO5Zz2LDzUY8bh2UQllcSNMGZiqnV2Xsy/pH0M9ak59Jvt0sk2wKssFm+G9Nt6V6V+f3FZXsyKvaUMCi1lxz99hs9yYb3hcISP0r1uH9C04RhDgbMIFoj8SCnA2dBRCcjAukiDxrCgWvnZ6IJvlI53GP2EmuEOQ9XBIi0MOgX+bWTcK9ewDg+jyE9++aHGF280mYVJNxE0brK7VwggH5EE+bKo3HbK3qyUj+dR1rXC+taBazJfUzTvcD73EZk6wvThT8Y5LGV/PaQ6uwfGFfbp+JfcVEp47zL4QQl2g+J1XxE5VtT4J8p2m6xZyzcxupTIB29rhx+QDev/TVPFn8YCXyFbqsUx+QNDElDQJSZwFEQ0jJpio7/k09HBwMfxCW/SHKuzWtm6TmHudxACNQo4L+Cu7VNsh8HiK5kachzkI85kIED3cJVsmbgIa7TSC16U4AQNAAvSQdqbBjpyohVpIX3gSS2Q9uPI4J8Z04GkPqvxbl9xXjK5C/3AKA9hUWv2HyS9t+UkTErTIuZ5hA0jyCs0Gom88iYjKO/Cw1gaR5UlMNJLy7OtnzMaUwmUB6qWrjWeSFa9GJoOCFy8m/qRUTzhuFAIR3Rn9hNiezabVXEZy5F/J8FlzVbiqZajtw3xcFtcQ4F4N+tltXh5ROEbQUSBv9j8twO9rPQd8HW2pwhOvOh4xPZFAGsnjmQyGoKF6Ith9ILoAgFM7FOae4oRTkw8oSM4OA5AEI5+4w8B/pQuAevhP7nsfwwuCczwuL0zQHWKIypp4UUXFzGJDgMjqOdwBIo9R7Gz+u3IOXUI4nisRJCYqtr15/muDyDLyfm002ZVAQFts+enjPbZv52fGg+lSaBhBOg9yHLv+UWh9Q/nYArTOka/HMluB5+PY5bofmS8/F4KlpZSAyR8m8JkuBPJX0/ujniN01nAzBKGYyvAgQUfADKUFr4b8BoDQuA0jol1Y+cosmNFACQL4mBCR8X0Q0MgcCAmSLMRNIaTypQEpjCCC8x0c1968srYSp+QdUmy83E9wwL62I3Koa2VBoz38P6AIkvtXK4YtCDs+mNTEBlFZ5+AhknqUBHsA6B/SxrhjNSB9186EJniuaqTlg0C+Mp6H8GOih7+ZCOzt6Kw65IKIrSAIJk8ag+69OwYOGs6kjcbMm+WuMUhJIjUBQBKsuVilHAxlMySwBKa+ilB0oGtcqkFScBcpmAglmUm2y9/BcTeG4/wWQrmC2SgcSVz9SjXwpi/L5vJnB7FSn+HviW7P68ss+HVxS76eHlDjAylUuaaAQjjDyQ6igPV4mAjmE6KM83K60YGqhFeDZm8qhVuScwifWpTptfg8+krEAcQji9xEXI3bHsAVCLc+gYO/jPu2JWBG4kY2gJM8tKCpedMCgmVmYbk9Db1yExiSQE/Ch3G7Ycv2U4KTSEwEbFJ6bs6ZnY130UBMbj1X7Bl2F4y6f41O9PjDjyjSN0n6fbCn4cvCFuzTNEtbdjEsMlwgSpwMKikoWatniIloVETGf/LZkkX0jiz3ZdNuwNBBIOGkAk3QQgDOaNcM8sayJ2Me9gH2Zo1lJA7ULQBic94j+jsdi16AHT944E23Z67yIe/1amPyZoGNBJBPnO25f2NWmm2RqRf9hsVjsd6j7msvnJJCNPkybh8ICl057azIXHZevydsN8h9AruWZliNix50bkOzX4nN2V677JxA2JYnJ3IGiEvIorUhS2pRL488rX7vOVqw42ZpvFQfrP0DZA5Et7bnJiYuJKMTc6sqy88HzErWLyNgIuLzpAerQLLiYTN/11BRe4rnCdWVYagIJi4TNIuoRaLznMTaCysMxoolYEhYi/4OOAIh6kQ3217hg/4wJdimVKQgmaU+00ikc2X/3Yni9WK3GRCtPFac53jwFtNNjy3IujE6qS12klqHup4iDEAsRr0IkwB0TwV1Z3Wt1vweSqkOHCjtxw/hWrPqr8bKVvD2BgQAEP/HxzucZgRwMALLgYpezLCmHB7OEUwlIzOJXYC79GDuGnwBAPTQ3Jj4+MOT4PIT9Z3s1kO4D78pmQZG9gn7Walp3SHFtx0OO6wxZ5hh5J6ueGZWF/dxNVICamppaj2tqBG2+QSdQHjMhCaIWPqjr2rvhAsh5N+V8b582nAcgxq5Jq0wQPAABjCeH8LRKJiDxCD5+4/wN8hqaEY2Prxl56ffavAcKGk3Zs7shkGZAVNorUSgDIN5MZJP/mxuq8f5ZDSQKXAkT1Mp82vukBmhqHAJOBPpoz9O4qYx/b+WIc0HdAUDwZngGhXGXDxeA9JDuLwOFODg0VydSAhK3ZjmftSjvY7FOdNjxppjoA9Da0TBuL2laiOjc5lOxODks+B+JxxtvQeEBh+D+A/i+RH+LUNRaiF7adiuta8qbybzAj3w4PyqCG3B1JjturS/8CFDChCMNRAAKDOLnjgkXooHgoGjSJlxnNFDg0F1JdDUSNN6LXTlMG/r+N/D0dvleBxA2pbZp/m3umbi355p0OHhuUZvGJBZgsyJh0pFpR4E+2vtmIpv2n1zoOujxdfmoSyPY/zwXEexiqAFPjcOLvCPsSoZ+WJonrR5JMxCMJw5hX1RXs0hzD//vhTXWZzf3jRwSoPtueP8hg2p3fVjzVHZz3fXQPjP1nhZOjk/McWVUPRux+SVA2FuaDrh5csLJ8eqAirKvYMO+3FRjPAunIrpZwMmQ38AT+kJSLCwBVq+nkuXDm8MEz8GIcJR4IVgLsXguvK4/87h0Ztc7ZNKRk8kLACF9tLcchCkukbTR5W7eTP5mFOh1SQ7a1hm0rsr65m2mBolYgo/Az05NxYXQBtMJFo/TJnGDW/QlDY3qbaUah2oiLn71W7v448IW2fgg7iF4ts9O1jWW1cZxdi6WPDsHwGytr/r4wZ7SvgcA9rxzAMr23KyexV/oxkgtyUdg1bsdmmqYJgMsjyO/nsoDK0qLpJI54HkQxSyiUeCNOFKT+J7eKXeHfzhaNUXavpX5FckaaLEyJ9ThFJVMsjx3wPeRegeQTSGiN9SRdkrTUCZPSn4uyjcjWoj00d5ozJH/M3lQrgX9z6CdiUgTm/ZlPvMQ5UyFJqOj0418xrL4MRq5DCYd/fqJb1VpywgEIFhiO4UtcbQ/Plco8SRcxG+Et004EeA9861sBKC+0Z7F1QUXmRiiY0RLIxaO2Qf9dhsGUdjsA7QzBXc8R6aJEC5Ct6jhL+Msx7OWVL77cLhEwwSmBecuYzzvozuD1qEs5kQVGj7jNsaj9fZIqf0tNgj4wRtFoO6KcACdahPznK4YJwJ7Nwdnz5bhEOckHOL8BQbxNFJLV6QB5J5EeA53y7K5XGQpcRt+tBDKI6mREv34vHCv675DAQQGgCTHjrOlkQibHLc53hklNZJuD/lPwY97OUCSeMkHuqeRNE/3SglA6jmuaC/Ith8h2f4V4x7njr0H6aoMy0Gm4bVun/TR3lTMl9qUMZaifCPiNxDJO7gYfGRevorYGe1ML7Dp14McDYQ0jn7pRTBpOwo0zpVI6R1djAidCHRi4Rlnr5IKpNY6RcPgs3Dw3zpA4nwKYGR0YwDI8MK1BCDdmGSz49wAkq5JpgFASlZ2q5wJIHKm4O/IBDK3dEj76E5XdDTF/HgHE5WcJpch0hyjA6rbEL3gTu7vgLAOUZtZxEexs2EwOvip0cl9yJOT41yXdglSip0OuM4d3kaLJqs27fBwaXUKDmEA0twEJKV+AxPrCeBlO25WoBeO6gJNON2PkSaABI1Epp1QgbIRkLRpJ5nsdqYd4GJooDBvpHHRXZvV94dWfNLeXRFmo1O9ktpBA2BukCPpPMR5iIeCeDpIwzvhZMA4ZM5djLgIMZ6syUhO8QHlpT/2dYXvQcYWFi8M+xmpIVUbT2i2Y9f52wg6oDkQL+LyNR1XYVu5OQuds3ON6lYAM7nscv7x/qKS32resHRA+dqZ/naqbmzhuAVatjBZ3J/7Cuv2iNDJq3ko7T6ovfuLLl2eKhBWN/r8YYhLX4NJ8GkqT2fK6D8H7U9BrETftGfokoBxCtBxP8S3MY4GVOBY4CVX91hEakPydTTQvVqJ8fRC4evHvfbhIPZB9JSIj6nthX0Y56//Dy5GPw14sZShAAAAAElFTkSuQmCC" /><p>Powered by BIMFACE</p><a target="_blank" href="https://bimface.com">https://bimface.com</a></div>'),r._panels.InformationPanel=e,e.addEventListener("Hide",function(){y.getButton("Information").setCheckedState(!1)})}else r._panels.InformationPanel.hide()}}},FullScreen:{id:"FullScreen",title:"全屏",className:"bf-button gld-bf-maximize",handles:{Click:function(){var e=this.hasClass("gld-bf-maximize");d.enableFullScreen(e),Glodon.Web.Lang.Utility.FullScreen.onFullScreenChanged(function(){var t=v.getControl("FullScreen");t.getTitle();t.toggleClassName("gld-bf-maximize"),t.toggleClassName("gld-bf-minimize"),e?t.setTitle("全屏"):t.setTitle("取消全屏")})}}}},p={Information:{element:o,title:"BIMFACE",css:{left:"50%",top:"50%",width:"330px",height:"278px",transform:"translate(-50%,-50%)",zIndex:999},enableSizable:!1}};if(!e.Toolbars||0==e.Toolbars.length)return!1;for(var f=[],h=0,m=e.Toolbars.length;h<m;h++)f.push(c[e.Toolbars[h]]);var g=new Glodon.Bimface.Application.Toolbars(f),v=g.getToolbar("MainToolbar");if(v){for(var b=[],h=0,m=e.Buttons.length;h<m;h++)b.push(u[e.Buttons[h]]);var y=new Glodon.Bimface.Application.Buttons(b);v.addControls(y.getButtons())}var w=g.getToolbar("LeftSubToolbar");w&&d.addEventListener(s.Loaded,function(e){for(var t=e.getViews(),n={type:"ComboBox",id:"Views",inheritTitle:!0,className:"bf-combobox bf-family",options:{},handles:{Change:function(e){d.showViewById(e.id)}}},o=0,a=t.length;o<a;o++){var i=t[o];n.options[i.name]={type:"ComboBoxOptionButton",title:i.name,id:i.id,className:"bf-button",html:'<span class="bf-button-name">'+i.name+"</span>"}}var n=new Glodon.Bimface.Application.Buttons([n]),r=n.getButtons()[0];d.addEventListener(s.ViewChanged,function(e){r.setSelectedControlById(e)}),w.addControls(n.getButtons())}),d.addEventListener(s.Loaded,function(){var e={eventId:"加载",loadModel:"normal",type:"2d"};n.send("Glodon.Bimface.Application.WebApplication2D","Loaded",e)})};e.WebApplication2D=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t="Glodon.Bimface.Application.WebApplicationDemo",n=Glodon.Bimface.Data.StatisticsDataManager.getInstance(),o=function(e,o,a){var i,r=function(e){a&&(e.APIHost="https://api-test.bimface.com/",e.resourceHost="https://m-test.bimface.com/")};if("dwgView"==e.viewType){var l=new Glodon.Bimface.Application.WebApplication2DConfig;l.domElement=o,r(l);var s=Glodon.Bimface.Application.WebApplication2DEvent;i=new Glodon.Bimface.Application.WebApplication2D(l),i.load(e.viewToken),i.getViewer().addEventListener(s.Loaded,function(){var e={eventId:"加载",loadModel:"normal",type:"demo"};n.send(t,"Loaded",e)})}else if("rfaView"==e.viewType){var l=new Glodon.Bimface.Application.WebApplicationRfaConfig;l.domElement=o,r(l);var s=Glodon.Bimface.Application.WebApplicationRfaEvent;i=new Glodon.Bimface.Application.WebApplicationRfa(l),i.addView(e.viewToken),i.addEventListener(s.ViewAdded,function(){var e=i.getViewer().getViewer(),o=e.getNumOfElements(),a=e.getNumOfTriangles(),r={eventId:"加载",loadModel:"normal",type:"demo",elements:o,triangles:a};n.send(t,"ViewAdded",r),i.render()})}else if("drawingView"==e.viewType){var l=new Glodon.Bimface.Application.WebApplicationDrawingConfig;l.domElement=o,r(l),l.drawingUrl=e.drawingUrl,l.viewToken=e.viewToken;var s=Glodon.Bimface.Application.WebApplicationDrawingEvent;i=new Glodon.Bimface.Application.WebApplicationDrawing(l),i.load(e.viewToken),i.addEventListener(s.Loaded,function(){var e={eventId:"加载",loadModel:"normal",type:"demo"};n.send(t,"Loaded",e)})}else if("pdfView"===e.viewType){var d=new Glodon.Bimface.Application.WebApplicationPDFConfig;d.domElement=o,r(d),i=new Glodon.Bimface.Application.WebApplicationPDF(d);var c=i.getViewer();c.addView(e.viewToken)}else if("gisView"===e.viewType){var u=new Glodon.Bimface.Application.WebApplicationGISConfig;u.domElement=o,r(u),i=new Glodon.Bimface.Application.WebApplicationGIS(u),i.addScene(e.viewToken)}else{var l=new Glodon.Bimface.Application.WebApplication3DConfig;l.domElement=o;var p=this.getQueryString("renderMode");switch(p){case"fullVolume":l.renderMode="fullVolume";break;case"incremental":l.renderMode="incremental";break;default:l.renderMode="auto"}r(l);var s=Glodon.Bimface.Application.WebApplication3DEvent;i=new Glodon.Bimface.Application.WebApplication3D(l),i.addView(e.viewToken),i.addEventListener(s.ViewAdded,function(){var e=i.getViewer().getViewer(),o=e.getNumOfElements(),a=e.getNumOfTriangles(),r={eventId:"加载",loadModel:"normal",type:"demo",elements:o,triangles:a};n.send(t,"ViewAdded",r)})}this._application=i};o.prototype={hideBimfaceInfo:function(){this._application.getToolbar("MainToolbar").getControl("Information").hide()},getQueryString:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(t);return null!=n?unescape(n[2]):null}},e.WebApplicationDemo=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=function(){var e={Toolbars:["MainToolbar","LeftSubToolbar","SearchToolbar"],Buttons:["Home","RectZoom","DrawingMeasure","Map","Layers","Sheets","Setting","FullScreen"],defaultDisplayMode:null},t=Glodon.Bimface.Viewer.ViewerDrawingConfig(),n=Object.assign({},e,t);return n.staticPath="/api/Glodon",n};e.WebApplicationDrawingConfig=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=Object.freeze({ViewAdded:"ViewAdded",ViewLoading:"ViewLoading",ComponentsSelectionChanged:"ComponentsSelectionChanged",ComponentsHoverChanged:"ComponentsHoverChanged",Error:"Error",Loaded:"Loaded",MouseClicked:"MouseClicked",MouseDragged:"MouseDragged",ContextMenu:"ContextMenu",Rendered:"Rendered",ViewChanged:"ViewChanged",ViewMoving:"ViewMoving",ViewMoved:"ViewMoved",ViewZooming:"ViewZooming",ViewZoomed:"ViewZoomed",Hover:"Hover",DrawingMeasure:"DrawingMeasure",ZoomFactorChanged:"ZoomFactorChanged"});e.WebApplicationDrawingEvent=t}(),function(){var e=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Viewer"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application")),t=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Viewer"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),Glodon.Bimface.Data.StatisticsDataManager.getInstance()),n=function(e){function n(e){a.contextMenu&&a.contextMenu.element&&a.contextMenu.destroy();var t=e.clientPosition,n=e.containerBox,o=a.getSelectedIds(),r=new Glodon.Bimface.Application.UI.Menu.ContextMenu(i,o),l={},s=r.element.getBoundingClientRect();n.width-t.x>2*s.width?(l.x=t.x,r.element.removeClass("bf-menu-left"),r.element.addClass("bf-menu-right")):(l.x=t.x-s.width,r.element.addClass("bf-menu-left"),r.element.removeClass("bf-menu-right")),n.height-t.y>s.height?l.y=t.y:l.y=t.y-s.height,l.x+=2,l.y+=2,r.setPosition(l),a.contextMenu=r}var o=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop();this._plugins=[],this.isMeasureEventAdded=!1;var a,i=this,r=e,l=(Glodon.Bimface.UI.Control.ControlEvent,Glodon.Bimface.Viewer.ViewerDrawingEvent);o||(e.Buttons=["Home","DrawingMeasure","Layers"],e.Toolbars=["MainToolbar","LeftSubToolbar"]);var s=new Glodon.Web.Lang.EventManager;this.getEventManager=function(){return s},a=new Glodon.Bimface.Viewer.ViewerDrawing(r),a.addEventListener(l.ViewChanged,function(e){i.getEventManager().fireEvent(l.ViewChanged,e)}),a.addEventListener(l.ContextMenu,n),this.addEventListener=function(e,t){this.getEventManager().addEvent(e,t)},this.removeEventListener=function(e,t){this.getEventManager().removeEvent(e,t)},this.loadFrame=function(e,t){a.loadFrame(e,t)},this.getRenderInfo=function(e,t){a.getRenderInfo(e,t)},a.addEventListener(l.Loaded,function(n){var o={eventId:"加载",loadModel:"normal",type:"drawing"};if(t.send("Glodon.Bimface.Application.WebApplicationDrawing","Loaded",o),!i.UI){var r=a.getDomElement(),l=new Glodon.Bimface.Application.UI.UIConfig;l=Object.assign(l,e),l.element=r,l.viewer=a,i.UI=new Glodon.Bimface.Application.UI.UI(l),i.UI.init(),window.addEventListener("resize",function(e){i._mainToolbarAdaptive()})}i._mainToolbarAdaptive()}),this.getViewer=function(){return a},this.getDrawingFrame=function(e){a.getDrawingFrame(e)},this.load=function(e,t){a.load(e,t)},this.getAxisInfo=function(e){a.getAxisInfo(e)},this.getToolbars=function(){return this.UI.getToolbars()},this.getPlugin=function(e){return this.UI.getPlugin(e)},this.getToolbar=function(e){return this.UI.getToolbar(e)},this._mainToolbarAdaptive=function(){var e=this.getToolbars();if(e&&e.length>=2&&!!i.getToolbar("MainToolbar")){var t=i.getToolbar("MainToolbar");a.getDomElement().offsetWidth<1e3?t.addClassName("bf-toolbar-bottom-float-right"):t.removeClassName("bf-toolbar-bottom-float-right")}}};e.WebApplicationDrawing=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=function(){var e={mainToolbar:{create:!0,items:{Pan:{create:!0},ZoomOut:{create:!0},ZoomIn:{create:!0},FullScreen:{create:!0}}},pageController:{create:!0}},t=new Glodon.Bimface.Viewer.ViewerPDFConfig,n=Object.assign({},e,t);return n.staticPath="/api/Glodon",n};e.WebApplicationPDFConfig=t}(),function(){var e=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Viewer"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application")),t=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Viewer"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom")),n=(Glodon.Bimface.Data.StatisticsDataManager.getInstance(),function(e){var n=this,o=e,a=Glodon.Bimface.Viewer.ViewerPDFEvent,i=void 0,r=[],l=new Glodon.Web.Lang.EventManager;this.getEventManager=function(){return l},i=new Glodon.Bimface.Viewer.ViewerPDF(o),this.addEventListener=function(e,t){this.getEventManager().addEvent(e,t)},this.removeEventListener=function(e,t){this.getEventManager().removeEvent(e,t)},this.getViewer=function(){return i},this.load=function(e){i.load(e)},this.getToolbars=function(){return r},this.getToolbar=function(e){return r.getToolbar(e)},this.destroy=function(){if(i.destroy(),r&&r._Toolbars&&r._Toolbars.length>0)for(var e=0,t=r._Toolbars.length;e<t;e++)r._Toolbars[e].destroy()};var s=function(){if(r&&r._Toolbars&&r._Toolbars.length>0)for(var o=0,l=r._Toolbars.length;o<l;o++)r._Toolbars[o].destroy();var s=i.getDomElement().querySelector(".bf-pdf-outer"),d=t.create("div","bf-pdf-message");d.style.display="none",s.appendChild(d);var c=void 0,u=function(e){c&&(clearTimeout(c),c=void 0),d.innerHTML=e,d.removeClass("bf-pdf-message-hide"),d.style.opacity=1,d.style.display="block",c=setTimeout(function(){var e=function e(){d.style.display="none",d.removeEventListener("transitionend",e)};d.addClass("bf-pdf-message-hide"),d.addEventListener("transitionend",e),d.style.opacity=0,c=void 0},1500)};i.enableFullScreen=function(e){e?Glodon.Web.Lang.Utility.FullScreen.fullScreen(s):Glodon.Web.Lang.Utility.FullScreen.exitFullScreen()};var p={MainToolbar:{id:"MainToolbar",title:"MainToolbar",element:s,className:"bf-toolbar bf-toolbar-bottom"},PageController:{id:"PageController",title:"PageController",element:s,className:"bf-toolbar bf-toolbar-select"}},f={Pan:{id:"Pan",title:BimfaceLanguage.bf_btn_pan,className:"bf-button gld-bf-drag",type:"ToggleButton",handles:{Click:function(){var e=n.getToolbar("MainToolbar").getControl("Pan");e._checked?(e.setCheckedState(!0),i.setDragMode()):(e.setCheckedState(!1),i.setTextMode())}}},ZoomIn:{id:"ZoomIn",title:BimfaceLanguage.bf_btn_zoomIn,className:"bf-button gld-bf-zoom-in",handles:{Click:function(){n.getToolbar("MainToolbar").getControl("ZoomIn")._enabled&&i.zoomIn()}}},ZoomOut:{id:"ZoomOut",title:BimfaceLanguage.bf_btn_zoomOut,className:"bf-button gld-bf-zoom-out",handles:{Click:function(){n.getToolbar("MainToolbar").getControl("ZoomOut")._enabled&&i.zoomOut()}}},FullScreen:{id:"FullScreen",title:BimfaceLanguage.bf_btn_fullScreen,className:"bf-button gld-bf-maximize",handles:{Click:function(){var e=this.hasClass("gld-bf-maximize");e?i.fullScreen():i.exitFullScreen(),Glodon.Web.Lang.Utility.FullScreen.onFullScreenChanged(function(){var t=m.getControl("FullScreen");t.toggleClassName("gld-bf-maximize"),t.toggleClassName("gld-bf-minimize"),e?t.setTitle(BimfaceLanguage.bf_btn_fullScreen_exit):t.setTitle(BimfaceLanguage.bf_btn_fullScreen)})}}},Previous:{id:"Previous",title:BimfaceLanguage.bf_btn_previousPage,className:"bf-button gld-bf-previous",handles:{Click:function(){n.getToolbar("PageController").getControl("Previous")._enabled&&i.previousPage()}}},Next:{id:"Next",title:BimfaceLanguage.bf_btn_nextPage,className:"bf-button gld-bf-next",handles:{Click:function(){n.getToolbar("PageController").getControl("Next")._enabled&&i.nextPage()}}}},h=[];e.mainToolbar&&e.mainToolbar.create&&h.push(p.MainToolbar),e.pageController&&e.pageController.create&&h.push(p.PageController),r=new Glodon.Bimface.Application.Toolbars(h);var m=r.getToolbar("MainToolbar");if(m){var g=[];for(var v in e.mainToolbar.items){e.mainToolbar.items[v].create&&g.push(f[v])}var b=new Glodon.Bimface.Application.Buttons(g);m.addControls(b.getButtons());var y=m.getControl("ZoomIn"),w=m.getControl("ZoomOut");i.addEventListener(a.ViewZoomed,function(e){y&&(Math.abs(e.zoom-e.max)<.001?y.disabled():y.enabled()),w&&(Math.abs(e.zoom-e.min)<.001?w.disabled():w.enabled());var t=Math.round(100*e.zoom)+"%";u(t)});var C=m.getControl("Pan");C&&(C.element.style.marginLeft=0)}var M=r.getToolbar("PageController");if(M){var B=new Glodon.Bimface.Application.Button(f.Previous);B.element.style.marginLeft=0,B.disabled(),M.addControl(B);var k=t.create("input","bf-page-input");k.type="number",M.element.appendChild(k),k.value=1;var T=t.create("span","bf-page-count");M.element.appendChild(T);var L=i.getPageCount();T.innerHTML=L;var x=new Glodon.Bimface.Application.Button(f.Next);M.addControl(x),1===L&&x.disabled(),i.addEventListener(a.ViewMoved,function(e){var t=e.pageNo;t>=e.max?(x.disabled(),t=e.max):x.enabled(),t<=e.min?(B.disabled(),t=e.min):B.enabled(),k.value=t});var P=function(){var e=parseInt(k.value);!isNaN(e)&&e>=1&&e<=i.getPageCount()?i.turnToPage(e):k.value=i.getCurrentPageNo()};k.addEventListener("keyup",function(e){13===e.keyCode&&P()}),k.addEventListener("blur",P)}u("100%")};this._mainToolbarAdaptive=function(){var e=n.getToolbars();if(e&&e._Toolbars&&e._Toolbars.length>=2&&!!n.getToolbar("MainToolbar")){var t=n.getToolbar("MainToolbar");i.getDomElement().offsetWidth<1e3?t.addClassName("bf-toolbar-bottom-float-right"):t.removeClassName("bf-toolbar-bottom-float-right")}},i.addEventListener(a.ViewLoaded,function(){s(),n._mainToolbarAdaptive(),window.addEventListener("resize",function(e){n._mainToolbarAdaptive()})})});e.WebApplicationPDF=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=function(){var e={Toolbars:["MainToolbar"],Buttons:["Home","RectZoom","DrawingMeasure","Layers","Annotation","FullScreen","Setting"],defaultDisplayMode:null},t=Glodon.Bimface.Viewer.ViewerDrawingSetConfig(),n=Object.assign({},e,t);return n.staticPath="/api/Glodon",n};e.WebApplicationDrawingSetConfig=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=Object.freeze({ViewAdded:"ViewAdded",ViewLoading:"ViewLoading",ComponentsSelectionChanged:"ComponentsSelectionChanged",ComponentsHoverChanged:"ComponentsHoverChanged",Error:"Error",Loaded:"Loaded",MouseClicked:"MouseClicked",MouseDragged:"MouseDragged",ContextMenu:"ContextMenu",ActiveViewChanged:"ActiveViewChanged",Rendered:"Rendered",ViewChanged:"ViewChanged",ViewMoving:"ViewMoving",ViewMoved:"ViewMoved",ViewZooming:"ViewZooming",ViewZoomed:"ViewZoomed",AddDrawing:"AddDrawing",Hover:"Hover",ZoomFactorChanged:"ZoomFactorChanged",DrawingMeasure:"DrawingMeasure"});e.WebApplicationDrawingSetEvent=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),n=function(e,n){var o,a=this,i=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),r=Glodon.Bimface.Viewer.Viewer3DEvent,l=[];if(e.sets.forEach(function(e){l.push(e.viewerDrawing),e.active&&(o=e.fileName)}),d)return d.show(),l.forEach(function(e){e.getViewer().addEventListener(r.ComponentsSelectionChanged,showLayers)}),d;var s=new Glodon.Bimface.UI.Panel.PanelConfig;s.title=BimfaceLanguage.bf_btn_layers,s.className="bf-panel bf-layers-panell",s.id="layersSet",s.css=i?{left:"10px",top:"10px",width:"300px",height:"416px"}:{left:0,top:0,width:"100%",height:"100%",zIndex:9999};var d=new Glodon.Bimface.UI.Panel.Panel(s);d.element.addClass("layers-panel");var c=0,u=[],p=t.create("ul","bf-layers bf-scroll-bar");l.forEach(function(e){var n=e.getLayers();a.layers=n,n.map(function(e){e.visible||c++}),n=Glodon.Web.Lang.Utility.ClientHelper.sortByName(n),u.push(n);for(var i=0,r=n.length;i<r;++i){var l,s,d=t.create("li","bf-layer"),h=n[i],m=e.getColor(h.color);h.visible?(l="gld-bf-show",s="显示"):(l="gld-bf-hide",s="隐藏",d.addClass("disable"));var g=e._viewMetaData.name,v=g.split(".dwg")[0];g=g==o?"":v+" | ",d.innerHTML="<span title='"+s+"' class='eyes "+l+"'></span>\n                        <span class='color'style='background:"+m+"'></span>\n                        <span class='name'>"+g+h.name+"</span>",d.setAttribute("layer-id",h.id),d.setAttribute("visible",h.visible),d.addEventListener("click",function(){this.toggleClass("disable");var t=this.querySelector(".eyes");t.toggleClass("gld-bf-show"),t.toggleClass("gld-bf-hide");var n=this.getAttribute("visible"),o=this.getAttribute("layer-id");n="true"!=n,this.setAttribute("visible",n),this.querySelector(".eyes").setAttribute("title",n?"显示":"隐藏");var a=f.querySelector(".eyes");n?(e.showLayer(o),f.removeClass("disable"),a.addClass("gld-bf-show"),a.removeClass("gld-bf-hide"),a.setAttribute("title","显示")):(0==p.querySelectorAll(".gld-bf-show").length&&(f.addClass("disable"),a.removeClass("gld-bf-show"),a.addClass("gld-bf-hide"),a.setAttribute("title","隐藏")),e.hideLayer(o))}),p.appendChild(d)}e.changeLayers(n)});var f=t.create("div","bf-allLayers"),h=void 0;c==u.length?(h="gld-bf-hide",f.addClass("disable")):h="gld-bf-show",f.innerHTML="<span title='显示' class='eyes "+h+"'></span><span class='name'>"+BimfaceLanguage.bf_panel_layers_all+"</span>",f.addEventListener("click",function(){var e=this.hasClass("disable");e?l.forEach(function(e){e.showAllLayers(),m(!0)}):l.forEach(function(e){e.hideAllLayers(),m(!1)}),this.toggleClass("disable");var t=this.querySelector(".eyes");t.setAttribute("title",e?"显示":"隐藏"),t.toggleClass("gld-bf-show"),t.toggleClass("gld-bf-hide")});var m=function(e){for(var t=document.querySelectorAll(".bf-layer"),n=0,o=t.length;n<o;++n){var a=t[n],i=a.querySelector(".eyes");e?a.removeClass("disable"):a.addClass("disable"),a.setAttribute("visible",e),i.addClass(e?"gld-bf-show":"gld-bf-hide"),i.removeClass(e?"gld-bf-hide":"gld-bf-show"),i.setAttribute("title",e?"显示":"隐藏")}};return d.container.appendChild(f),d.container.appendChild(p),d.element.setCss({border:"solid 1px #333333"}),d.addEventListener("Hide",function(){n.setCheckedState(!1)}),d};e.LayersSetPanel=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),n=function(t,n){var o,a=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),i=e.create("div","bf-tab-container"),r=e.create("ul","bf-measure-tab");r.addEventListener("click",function(e){r.hasClass("tab-open")?(r.removeClass("tab-open"),o.element.removeClass("tab-open")):(r.addClass("tab-open"),o.element.addClass("tab-open"))},!0);var l=e.create("div","bf-tab-body"),s=e.create("div","bf-tab-foot");s.innerHTML='<div class="settingBtn">'+BimfaceLanguage.bf_panel_measure_clearAll+"<div>",s.addEventListener("click",function(){t.clear()});var d=e.create("span","bf-clear-all gld-bf-measure-settings");d.addEventListener("click",function(e){h(),e.preventDefault(),e.stopPropagation()}),s.appendChild(d);var c=e.create("div","bf-measure-tabface");c.innerHTML='<li class="bf-measure-tab-item" data-type="Distance">\n                            <i class="gld-bimface gld-bf-distance"></i>\n                        </li>',c.addEventListener("click",function(e){r.hasClass("tab-open")?(r.removeClass("tab-open"),o.element.removeClass("tab-open")):(r.addClass("tab-open"),o.element.addClass("tab-open"))}),i.appendChild(r),i.appendChild(l),i.appendChild(s);var u=e.create("div","bf-setting-container"),p=e.create("div","bf-setting-body"),f=e.create("div","bf-setting-foot");u.appendChild(p),u.appendChild(f);var h=function(e){g(!1);var n,a=t.getScale(),i=t.getPrecision(),r=t.getUnits();n='<ul class="bf-measure-setting">\n                  <li class="bf-measure-scale">\n                      <span >'+BimfaceLanguage.bf_panel_measure_scale+' :</span>\n                      <div class="scaleWrap">\n                          1: <input type="number"min="1" max="2000" value ="'+a+'" >\n                          <span>'+BimfaceLanguage.bf_panel_measure_scaleInput+' </span>\n                      </div>\n                  </li>\n                  <li class="bf-measure-lengthUnits">\n                      <span >'+BimfaceLanguage.bf_panel_measure_units+" :</span>\n                      <div class = 'unit'></div>\n                      </li>\n                  <li class=\"bf-measure-precision\">\n                      <span >"+BimfaceLanguage.bf_panel_measure_precision+" :</span>\n                      <div class = 'unit'></div>\n                  </li>\n\n                </ul>",p.innerHTML=n;var l="";p.querySelector(".scaleWrap input").oninput=function(e){var t=e.target.value;if("."==e.data||"e"==e.data){var n=(t||l).replace(/\./g,"").replace(/e/g,"");e.target.setAttribute("value",n),e.target.value=n}l=e.target.value,!l||l>2e3||l<1?e.target.addClass("error"):e.target.removeClass("error")};var s={type:"ComboBox",id:"units",inheritTitle:!0,className:"bf-combobox",options:{},handles:{Change:function(e){}}},d=new Glodon.Bimface.Application.Button(s);for(var c in m){var u=m[c],h={type:"ComboBoxOptionButton",title:u,id:c,className:"bf-button",html:'<span class="bf-button-name">'+u+"</span>"};d.addControl(new Glodon.Bimface.Application.Button(h))}d.setSelectedControlById(r.distance),p.querySelector(".bf-measure-lengthUnits .unit").appendChild(d.element),d.element.onclick=function(){y.element.removeClass("bf-expand")};var b={type:"ComboBox",id:"units",inheritTitle:!0,className:"bf-combobox",options:{},handles:{Change:function(e){}}},y=new Glodon.Bimface.Application.Button(b),w={0:"0",1:"0.0",2:"0.00",3:"0.000"};for(var c in w){var u=w[c],h={type:"ComboBoxOptionButton",title:u,id:c.toString(),className:"bf-button",html:'<span class="bf-button-name">'+u+"</span>"};y.addControl(new Glodon.Bimface.Application.Button(h))}y.setSelectedControlById(i.distance),p.querySelector(".bf-measure-precision .unit").appendChild(y.element),y.element.onclick=function(){d.element.removeClass("bf-expand")},f.innerHTML="<div class=\"bf-measure-btns\">\n                                    <span class= 'save'>"+BimfaceLanguage.bf_panel_measure_save+" </span> <span class= cancel>"+BimfaceLanguage.bf_general_cancel+"</span>\n                               </div>",f.querySelector(".save").onclick=function(){var e=y.getCurrentControl().id,n=p.querySelector(".scaleWrap input").value,a=d.getCurrentControl().id;n<1||n>2e3||(t.setScale(n),t.setPrecision({distance:e,area:e,angle:e}),t.setUnits({distance:a,area:a}),g(!0),v(o.data),t.getEventManager().fireEvent("MeasureParamsUpdated"))},f.querySelector(".cancel").onclick=function(){g(!0)}},m={None:BimfaceLanguage.bf_general_none,Meter:"m",Centimeter:"cm",Millimeter:"mm"},g=function(e){if(e){o.setTitleContent(BimfaceLanguage.bf_btn_measure);var t=o.element.querySelector(".bf-close");t.style.display="block",u.style.display="none",i.style.display="block"}else{var t=o.element.querySelector(".bf-close");t.style.display="none",o.setTitleContent(BimfaceLanguage.bf_panel_measure_setting),u.style.display="block",i.style.display="none"}},v=function e(n){o.data=n;var a,i=t.getMeasureType(),s=(t.getPrecision(),t.getScale(),t.getUnits()),d=null,u="None"!=s.distance&&"<span class='units'>"+m[s.distance]+"</span>"||"",p="None"!=s.area&&"<span class='units'>"+m[s.area]+"</span>"||""
;r.innerHTML='<li class="bf-measure-tab-item '+(i==Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Distance&&"bf-active")+'" data-type="Distance">\n          <i class="gld-bimface gld-bf-distance" title="'+BimfaceLanguage.bf_tip_measure_distance+'"></i>\n        </li>\n        <li class="bf-measure-tab-item '+(i==Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Angle&&"bf-active")+'" data-type="Angle">\n          <i class="gld-bimface gld-bf-angle" title="'+BimfaceLanguage.bf_tip_measure_angle+'"></i>\n        </li>\n        <li class="bf-measure-tab-item '+(i==Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Area&&"bf-active")+'" data-type="Area">\n          <i class="gld-bimface gld-bf-area" title="'+BimfaceLanguage.bf_tip_measure_area+'"></i>\n        </li>';for(var f=r.querySelectorAll(".bf-measure-tab-item"),h=0;h<f.length;h++)f[h].addEventListener("click",function(){for(var n=0;n<f.length;n++)f[n].removeClass("bf-active");var o=this.getAttribute("data-type");this.addClass("bf-active"),t.setMeasureType(o);var a=t.getSelectedItem(),i=a&&a.type==o?y(t.drawableManager.mapMeasureInfo[a.getId()]):{};e(i)});if(i==Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Distance){var g=n?n.distance:null,v=n?n.distanceX:null,b=n?n.distanceY:null;a='<ul class="bf-measure-info">\n                  <li class="bf-measure-distance">\n                  '+BimfaceLanguage.bf_panel_measure_distance+'：\n                    <span class="bf-measure-value">'+(g?g+u:"--")+'</span>\n                    <span class="bf-measure-reset gld-bimface gld-bf-reset-box" title="'+BimfaceLanguage.bf_tip_section_resetBox+'"><span></li>\n                  <li class="bf-measure-x">X： '+(v||"--")+'</li>\n                  <li class="bf-measure-y">Y： '+(b||"--")+"</li>\n\n                </ul>",d=f[0],o.element.removeClass("miniStyle")}else if(i==Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Angle){var w=null;n&&(w=n.angle),a='<ul class="bf-measure-info">\n                <li class="bf-measure-distance">\n                '+BimfaceLanguage.bf_panel_measure_angle+'：\n                  <span class="bf-measure-value">'+(w?w+"<span class='units'>°</span>":"--")+'</span>\n                  <span class="bf-measure-reset gld-bimface gld-bf-reset-box" title="'+BimfaceLanguage.bf_tip_section_resetBox+'"><span></li>\n              </ul>',d=f[1],o.element.addClass("miniStyle")}else if(i==Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Area){var C=null;n&&(C=n.area),p&&(p+="<i class='square'>2</i>"),a='<ul class="bf-measure-info">\n                <li class="bf-measure-distance">\n                '+BimfaceLanguage.bf_panel_measure_area+'：\n                  <span class="bf-measure-value">'+(C?C+p:"--")+'</span>\n                  <span class="bf-measure-reset gld-bimface gld-bf-reset-box" title="'+BimfaceLanguage.bf_tip_section_resetBox+'"><span></li>\n              </ul>',d=f[2],o.element.addClass("miniStyle")}l.innerHTML=a,l.querySelector(".gld-bf-reset-box").addEventListener("click",function(){t.reset()}),c.innerHTML="",c.appendChild(d.cloneNode(!0))},b=new Glodon.Bimface.UI.Panel.PanelConfig;b.title=BimfaceLanguage.bf_btn_measure,b.id="MeaurePanel",b.className="bf-panel bf-measurement-panel",b.css=a?{right:"10px",bottom:"220px",width:"200px",height:"220px"}:{maxWidth:"414px",left:"50%",transform:"translate(-50%)",bottom:"0.12em",width:"100%",height:"1.7em"};var y=function(e){var n={type:e.type},o=t.getMeasureParams();if("Distance"===e.type){var a=e.end[0]-e.start[0],i=e.end[1]-e.start[1],r=Math.sqrt(a*a+i*i);n.distance=MeasureResultFormat.formatDistance(r,o),n.distanceX=MeasureResultFormat.formatDistance(a,o),n.distanceY=MeasureResultFormat.formatDistance(i,o)}else"Angle"===e.type?n.angle=MeasureResultFormat.formatArea(e.angle,o):"Area"===e.type&&(n.area=MeasureResultFormat.formatArea(e.area,o));return n};if(b.enableSizable=!1,t.viewer.addEventListener(Glodon.Bimface.Plugins.Measure.MeasureEvent.Measuring,function(){v()}),t.viewer.addEventListener(Glodon.Bimface.Plugins.Measure.MeasureEvent.Measured,function(e){e?v(y(e)):v()}),t.addEventListener(Glodon.Bimface.Plugins.Measure.MeasureEvent.MeasureSelected,function(e){if(e.isDataEmpty)return void v();var n=r.querySelectorAll(".bf-measure-tab-item"),o=!0,a=!1,i=void 0;try{for(var l,s=n[Symbol.iterator]();!(o=(l=s.next()).done);o=!0){var d=l.value;d.getAttribute("data-type")===e.type?d.addClass("bf-active"):d.removeClass("bf-active")}}catch(e){a=!0,i=e}finally{try{!o&&s.return&&s.return()}finally{if(a)throw i}}t.setMeasureType(e.type),v(y(e))}),t.addEventListener(Glodon.Bimface.Plugins.Measure.MeasureEvent.MeasureUnselected,function(e){v()}),t.addEventListener(Glodon.Bimface.Plugins.Measure.MeasureEvent.Reset,function(){v(),g(!0)}),o=new Glodon.Bimface.UI.Panel.Panel(b),o.container.appendChild(i),o.container.appendChild(u),o.bringToFront(),!a){var w=n.offsetWidth,C=n.offsetHeight;o.element.style.fontSize=100*Math.min(w,C,414)/750+"px",o.element.addClass("measure-panel");o.element.querySelector(".bf-close").innerHTML="<span class='quit'>"+BimfaceLanguage.bf_general_exit+"</span>",o.element.appendChild(c)}return v(),o};t.DrawingMeasurePanel=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),n=function(e){var n=new Glodon.Bimface.UI.Panel.PanelConfig,o=this,a=void 0;a="ViewerDrawingSet"==e.viewerType?e:e.getViewer(),this.viewer=a,this.status={print:a.getDisplayMode()},n.title=BimfaceLanguage.bf_btn_settings,n.css={left:"50%",top:"50%",transform:"translate(-50%,-200px)",width:"330px",height:"auto"},n.id="Setting",n.enableSizable=!1,n.className="bf-panel bf-settings-panel";var i=new Glodon.Bimface.UI.Panel.Panel(n),r=t.create("form","bf-setting"),l=t.create("div","bf-setting-foot"),s='<ul class="bf-setting-tab-default bf-show">\n\n        \n        <li class="bf-setting-li">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_displayMode+'</span>\n          <div class="bf-setting-value printmode">\n            <label class="bf-radio">\n              <input type="radio" class="bf-radio-input normal" name=\'menu\' mode="普通模式" '+(0==this.status.print?"checked":"")+'>\n              <span class="bf-radio-display"></span>\n              <span class="bf-radio-value">'+BimfaceLanguage.bf_panel_settings_normalMode+'</span>\n            </label>\n            <label class="bf-radio">\n              <input type="radio" class="bf-radio-input" name=\'menu\' mode="白底模式" '+(1==this.status.print?"checked":"")+'>\n              <span class="bf-radio-display"></span>\n              <span class="bf-radio-value">'+BimfaceLanguage.bf_panel_settings_whiteBgMode+'</span>\n            </label>\n            <label class="bf-radio">\n              <input type="radio" class="bf-radio-input" name=\'menu\' mode="黑白模式" '+(2==this.status.print?"checked":"")+'>\n              <span class="bf-radio-display"></span>\n              <span class="bf-radio-value">'+BimfaceLanguage.bf_panel_settings_monoBgMode+"</span>\n            </label>\n          </div>\n        </li>\n        </ul>\n       ",d='<div class="bf-reset">\n          <span class="reset">'+BimfaceLanguage.bf_panel_settings_restore+"</span>\n        </div>";r.innerHTML=s,l.innerHTML=d;for(var c=r.querySelectorAll(".printmode .bf-radio-input"),u=0,p=c.length;u<p;u++)!function(e,t){c[e].addEventListener("change",function(){var t=e;a.setDisplayMode(t)})}(u);return l.querySelector(".reset").addEventListener("click",function(){var e=void 0!=a._opt.defaultDisplayMode?a._opt.defaultDisplayMode:o.status.print;c[e].click()}),i.container.appendChild(r),i.container.appendChild(l),i};e.PrintModePanel=n}(),function(){var e=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Viewer"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application")),t=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Viewer"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),"Glodon.Bimface.Application.WebApplicationDrawingSet"),n=Glodon.Bimface.Data.StatisticsDataManager.getInstance(),o=function(e){function o(){var o={eventId:"加载",loadModel:"normal",type:"DrawingSet"};if(n.send(t,"Loaded",o),s&&s._Toolbars&&s._Toolbars.length>0)for(var a=0,d=s._Toolbars.length;a<d;a++)s._Toolbars[a].destroy();var c,h,m,g,v,b,y={MainToolbar:{id:"MainToolbar",title:"MainToolbar",element:f,className:"bf-toolbar bf-toolbar-bottom"},LeftSubToolbar:{id:"LeftSubToolbar",title:"LeftSubToolbar",element:f,className:"bf-toolbar bf-toolbar-select"}},w={Home:{id:"Home",title:BimfaceLanguage.bf_btn_home,className:"bf-button gld-bf-home",handles:{Click:function(){l.getViewer().home()}}},Layers:{id:"Layers",title:BimfaceLanguage.bf_btn_layers,type:"ToggleButton",className:"bf-button gld-bf-layers",handles:{Click:function(){var e=M.getControl("Layers");e._checked?(e.setCheckedState(!0),c?c.show():(c=new Glodon.Bimface.Application.UI.Panel.LayersSetPanel(i,e),r||c.element.addClass("layers-panel"),f.appendChild(c.element),l.addPanel(c))):(e.setCheckedState(!1),c.hide()),e.addEventListener(u.StateChange,function(e){e||c.hide()})}}},PrintMode:{id:"PrintMode",title:BimfaceLanguage.bf_btn_settings,type:"ToggleButton",className:"bf-button gld-bf-settings",handles:{Click:function(){var e=M.getControl("PrintMode");if(e._checked){if(b)return b.show();b=new Glodon.Bimface.Application.UI.Panel.PrintModePanel(l.getActiveViewer()),b.addEventListener("Hide",function(){e.setCheckedState(!1),b.isShow&&b.hide()}),f.appendChild(b.element)}else b.toggle()}}},DrawingMeasure:{id:"DrawingMeasure",title:BimfaceLanguage.bf_btn_measure,type:"ToggleButton",className:"bf-button gld-bf-measure",handles:{Click:function(){var e=l.getActiveViewer();l.getViewer().getActiveDrawing();if(!m){var t=new Glodon.Bimface.Plugins.Measure.MeasureConfig;t.viewer=e,m=new Glodon.Bimface.Plugins.Measure.Measure(t)}var n=e.getDomElement(),o=M.getControl("DrawingMeasure");if(o._checked){o.setCheckedState(!0);var a=l.getViewer();m.addEventListener("typeChange",function(){l.getActiveViewer().getViewer().mouseEditorMgr.editors[0].captureFail=function(e,t,n){return e&&a.verify(e,t,n),!1}}),h=new Glodon.Bimface.Application.UI.Panel.DrawingMeasurePanel(m,n),h.addEventListener("Hide",function(){o.setCheckedState(!1),m.switchOff(),e.getEventManager().fireEvent("ButtonOnToolbarClicked",{id:"Measure",isChecked:!1})}),n.appendChild(h.element),m.switchOn(),l.getActiveViewer().getViewer().mouseEditorMgr.editors[0].captureFail=function(e,t,n){return a.verify(e,t,n),!1}}else o.setCheckedState(!1),n.removeChild(h.element),h=null,m.switchOff();e.getEventManager().fireEvent("ButtonOnToolbarClicked",{id:"Measure",isChecked:o._checked}),o.addEventListener(u.StateChange,function(e){if(!e){m.setMeasureType(Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Distance);var t=l.getActiveViewer();t.getViewer().mouseEditorMgr.activeEditorByName("pick"),t.update(),h.hide()}})}}},RectZoom:{id:"RectZoom",title:BimfaceLanguage.bf_btn_zoom,type:"ToggleButton",className:"bf-button gld-bf-zoomrect",handles:{Click:function(){var e=M.getControl("RectZoom"),t=!1;!e._checked&&t?(i.setNavigationMode("pick"),t=!1):(i.rectZoom(),t=!0,i.addEventListener(p.ViewZoomed,function(){e._checked&&t&&setTimeout(function(){e.setCheckedState(!1),i.isAlignment&&i.startMoving(!0)},200)})),e.addEventListener(u.StateChange,function(e){if(!e&&t){t=!1;var n=M.getControl("DrawingMeasure");n&&n._checked?i.setNavigationMode("measure"):i.isAlignment?i.startMoving(!0):i.setNavigationMode("pick")}})}}},Annotation:{id:"Annotation",title:"批注",className:"bf-button gld-bf-notes",handles:{Click:function(){var e=new Glodon.Bimface.Plugins.Annotation.AnnotationToolbarConfig,t=l.getActiveViewer();e.viewer=t,g=l._annotation=new Glodon.Bimface.Plugins.Annotation.AnnotationToolbar(e),v=Glodon.Bimface.Plugins.Annotation.AnnotationToolbarEvent,M.hide();var n=M.getControl("Measure");n&&n.setCheckedState(!1);var o=M.getControl("DrawingMeasure");o._checked&&o.toggleCheckedState(),g.show(),g.addEventListener(v.Saved,function(){M.show(),t.setNavigationMode("pick")}),g.addEventListener(v.Cancelled,function(){M.show(),t.setNavigationMode("pick")})}}},FullScreen:{id:"FullScreen",title:BimfaceLanguage.bf_btn_fullScreen,className:"bf-button gld-bf-maximize",handles:{Click:function(){var e=this.hasClass("gld-bf-maximize");i.enableFullScreen(e),Glodon.Web.Lang.Utility.FullScreen.onFullScreenChanged(function(){var t=M.getControl("FullScreen");t.getTitle();t.toggleClassName("gld-bf-maximize"),t.toggleClassName("gld-bf-minimize"),e?t.setTitle(BimfaceLanguage.bf_btn_fullScreen_exit):t.setTitle(BimfaceLanguage.bf_btn_fullScreen)})}}},Setting:{id:"Setting",title:BimfaceLanguage.bf_btn_settings,type:"ToggleButton",className:"bf-button gld-bf-settings",handles:{Click:function(){var e=M.getControl("Setting");if(e._checked){if(b)return b.show();b=new Glodon.Bimface.Application.UI.Panel.PrintModePanel(i),b.addEventListener("Hide",function(){e.setCheckedState(!1),b.isShow&&b.hide()}),f.appendChild(b.element)}else b.toggle()}}}};if(document.addEventListener("keydown",function(e){if(27==e.which){var t=M.getControl("DrawingMeasure"),n=M.getControl("RectZoom");t&&(h&&h.data?m.reset():t.setCheckedState(!1)),n&&n.setCheckedState(!1)}}),!e.Toolbars||0==e.Toolbars.length)return!1;for(var C=[],a=0,d=e.Toolbars.length;a<d;a++)C.push(y[e.Toolbars[a]]);s=new Glodon.Bimface.Application.Toolbars(C);var M=s.getToolbar("MainToolbar");if(M){for(var B=[],a=0,d=e.Buttons.length;a<d;a++)B.push(w[e.Buttons[a]]);var k=new Glodon.Bimface.Application.Buttons(B);M.addControls(k.getButtons())}var T=function(e){e&&L.removeControl("Views");var t=l.getActiveViewer(),n=t.getViews(),o={type:"ComboBox",id:"Views",inheritTitle:!0,className:"bf-combobox bf-family",options:{},handles:{Change:function(e){var n=void 0,o=void 0;h&&h.hide(),"Model"==e.id?(r||document.querySelector(".gld-bf-measure").setCss({display:"block"}),n=0):(r||document.querySelector(".gld-bf-measure").setCss({display:"none"}),n=e.id),o=l.getViewer().sets;for(var a=0;a<o.length;a++){o[a].viewerDrawing.showViewById(n)}t.update(!0),t.getEventManager().fireEvent("ButtonOnToolbarClicked",{id:"LeftSubToolbar"})}}};if(o.options.Model={type:"ComboBoxOptionButton",title:"Model",id:"model",className:"bf-button",html:'<span class="bf-button-name">Model</span>'},n.length)for(var a=0,i=n.length;a<i;a++){var s=n[a];o.options[s.name]={type:"ComboBoxOptionButton",title:s.name,id:s.id||"Model",className:"bf-button",html:'<span class="bf-button-name">'+s.name+"</span>"}}var o=new Glodon.Bimface.Application.Buttons([o]),d=o.getButtons()[0],c=t.getCurrentViewId();t.addEventListener(p.ViewChanged,function(e){0===e&&(e="Model"),d.setSelectedControlById(e)}),L.addControls(o.getButtons()),c?(d._currentControl.setCheckedState(!1),d.setSelectedControlById(c)):d.setSelectedControlById("Model")},L=s.getToolbar("LeftSubToolbar");L&&(T(),i.addEventListener(p.ActiveViewChanged,T)),i.getManifest(function(e){var t=e.Features,n=void 0;(n=!t||t.HasLayout)||L&&L.destroy()}),i.addEventListener(p.ViewChanged,function(){var e=l.getPanel("layersSet");if(e){var t=M.getControl("Layers"),n=e.isShow;n&&e.hide(),e.destroy(),l.removePanel("layersSet"),n?t.setCheckedState(!0):t.setCheckedState(!1),c=new Glodon.Bimface.Application.UI.Panel.LayersSetPanel(i,t),f.appendChild(c.element),l.addPanel(c),n||c.hide()}})}function a(e){var t=l.getActiveViewer();t.contextMenu&&t.contextMenu.element&&t.contextMenu.destroy();var n=e.clientPosition,o=e.containerBox,a=t.getSelectedIds(),i=new Glodon.Bimface.Application.UI.Menu.ContextMenu(l,a),r={},s=i.element.getBoundingClientRect();o.width-n.x>2*s.width?(r.x=n.x,i.element.removeClass("bf-menu-left"),i.element.addClass("bf-menu-right")):(r.x=n.x-s.width,i.element.addClass("bf-menu-left"),i.element.removeClass("bf-menu-right")),o.height-n.y>s.height?r.y=n.y:r.y=n.y-s.height,r.x+=2,r.y+=2,i.setPosition(r),t.contextMenu=i}var i,r=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),l=this,s=[],d=[],c=e,u=Glodon.Bimface.UI.Control.ControlEvent,p=Glodon.Bimface.Viewer.ViewerDrawingSetEvent;i=new Glodon.Bimface.Viewer.ViewerDrawingSet(c);var f=i.getRootElement();i.addEventListener(p.Loaded,function(){o(),l._mainToolbarAdaptive(),window.addEventListener("resize",function(e){l._mainToolbarAdaptive()})}),i.addEventListener(p.ContextMenu,a),this.getViewer=function(){return i},this.getActiveViewer=function(){return i.getActiveDrawing().viewerDrawing},this.addDrawing=function(e,t,n){i.addDrawing(e,t,n)},this.addDrawings=function(e,t){i.addDrawings(e,t)},this.getRenderInfo=function(e,t){i.getRenderInfo(e,t)},this.getToolbars=function(){return s},this.getToolbar=function(e){return s.getToolbar(e)},this.addPanel=function(e){d.push(e)},this.removePanel=function(e){d.removeObjectByAttribute("id",e)},this.getPanel=function(e){return d.getObjectByAttribute("id",e)},this._mainToolbarAdaptive=function(){var e=l.getToolbars();if(e&&e._Toolbars&&e._Toolbars.length>=2&&!!l.getToolbar("MainToolbar")){var t=l.getToolbar("MainToolbar");i.getRootElement().offsetWidth<1e3?t.addClassName("bf-toolbar-bottom-float-right"):t.removeClassName("bf-toolbar-bottom-float-right")}}};e.WebApplicationDrawingSet=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=function(e,t){var n,o=new Glodon.Bimface.Application.WebApplicationDrawingConfig;o.domElement=document.getElementById(t),o.domElementId=t,o.drawingUrl=e.drawingUrl;Glodon.Bimface.Application.WebApplicationDrawingEvent;n=new Glodon.Bimface.Application.WebApplicationDrawing(o),this._application=n};e.ApplicationDrawingDemo=t}(),function(){function e(t,n,o){function a(r,l){if(!n[r]){if(!t[r]){var s="function"==typeof require&&require;if(!l&&s)return s(r,!0);if(i)return i(r,!0);var d=new Error("Cannot find module '"+r+"'");throw d.code="MODULE_NOT_FOUND",d}var c=n[r]={exports:{}};t[r][0].call(c.exports,function(e){return a(t[r][1][e]||e)},c,c.exports,e,t,n,o)}return n[r].exports}for(var i="function"==typeof require&&require,r=0;r<o.length;r++)a(o[r]);return a}return e}()({1:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./../Markups"),i=function(e){function t(t,n,o,a){var i=e.call(this)||this;return i.rotation=a||0,i.markupType="Arrow",i.drawPoints=t,i.strokeStyle=n,i.lineWidth=o,i.bNeedHitByBbox=!1,i}return o(t,e),t.prototype.draw=function(e,t,n,o){if(!(this.drawPoints.length<2)){var a=e.worldToClientPoint([this.drawPoints[0][0],this.drawPoints[0][1],this.drawPoints[0][2]]),i=e.worldToClientPoint([this.drawPoints[1][0],this.drawPoints[1][1],this.drawPoints[1][2]]),r=10+this.lineWidth,l=a[0],s=a[1],d=i[0],c=i[1],u=180*Math.atan2(s-c,l-d)/Math.PI,p=(u+30)*Math.PI/180,f=(u-30)*Math.PI/180,h=r*Math.cos(p),m=r*Math.sin(p),g=r*Math.cos(f),v=r*Math.sin(f),b=l-h,y=s-m,w=[(a[0]+i[0])/2,(a[1]+i[1])/2];t.fillStyle=t.strokeStyle,t.beginPath(),b=d+h,y=c+m,t.moveTo(b,y),t.lineTo(d,c),b=d+g,y=c+v,t.lineTo(b,y),t.closePath(),t.fill(),t.beginPath(),t.moveTo(l,s),h=(r-3)*Math.cos(p),m=(r-3)*Math.sin(p),g=(r-3)*Math.cos(f),v=(r-3)*Math.sin(f);var C=[d+(h+g)/2,c+(m+v)/2];t.lineTo(C[0],C[1]),t.stroke(),n.drawArrow(this,l,s,d,c,h,m,g,v,w,this.rotation,o,a,i)}},t.prototype.setPoints=function(e){this.drawPoints=e},t.prototype.getPoints=function(){return this.drawPoints},t.prototype.getGrips=function(e){var t=e.worldToClientPoint(this.drawPoints[0]),n=e.worldToClientPoint(this.drawPoints[1]);return t.concat(n)},t}(a.default);n.default=i},{"./../Markups":21}],2:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./ArrowMarkup"),i=e("..//MarkupTool"),r=e("../Mouse"),l=r.MouseButtons,s=function(e){function t(t){var n=e.call(this)||this;return n.markupManager=t,n}return o(t,e),t.prototype.begin=function(e,t,n,o){this.startX=t,this.startY=n;var i=e.markupManager.getColor(),r=e.markupManager.getLineWidth();this.markup=new a.default([],i,r)},t.prototype.onEditing=function(e,t,n,o){var a=e.clientToWorldPoint([this.startX,this.startY]),i=e.clientToWorldPoint([t,n]);this.markup.setPoints([a,i]),this.redraw(e)},t.prototype.end=function(e,t,n,o){return this.startX==t&&this.startY==n?(console.log("Ignore single point."),l.FINISHED):(this.addMarkup(e,this.markup),this.markup=null,l.FINISHED)},t}(i.default);n.default=s},{"..//MarkupTool":16,"../Mouse":23,"./ArrowMarkup":1}],3:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("../MathUtil"),i=e("./../Markups"),r=e("../MarkupViewer"),l=function(e){function t(t,n,o,a,i,r,l){var s=e.call(this)||this;return s.rotation=i||0,s.fillStyle=r||0,s.close=l||!1,s.markupType="Cloud",s.drawPoints=t,s.strokeStyle=n,s.lineWidth=o,s.controlPt=[],s.editPt=null,s.bNeedHitByBbox=!0,s}return o(t,e),t.prototype.draw=function(e,t,n,o){if(!(this.drawPoints.length<2)){var a=e.markupManager.getMarkupCenter(e,o);a||(a=[0,0]),t.save(),t.translate(a[0],a[1]),t.rotate(this.rotation),t.beginPath(),n.ctx.save(),n.ctx.translate(a[0],a[1]),n.ctx.rotate(this.rotation),n.ctx.beginPath(),n.ctx.strokeStyle="rgba("+(2*o+2)+",60,60,1)",n.ctx.fillStyle="rgba("+(2*o+2)+",60,255,1)",n.ctx.lineWidth=r.MarkupViewer.isMobile?36:this.lineWidth+n.lineWidth;for(var i=1,l=this.drawPoints.length;i<l;i++){var s=e.worldToClientPoint([this.drawPoints[i-1][0],this.drawPoints[i-1][1],this.drawPoints[i-1][2]]),d=e.worldToClientPoint([this.drawPoints[i][0],this.drawPoints[i][1],this.drawPoints[i][2]]),c=void 0;if(1==i&&(t.moveTo(s[0]-a[0],s[1]-a[1]),n.ctx.moveTo(s[0]-a[0],s[1]-a[1])),this.editPt&&this.editPt[i-1])c=e.worldToClientPoint([this.editPt[i-1][0],this.editPt[i-1][1],this.editPt[i-1][2]]);else if(this.controlPt[i-1]&&i<l-1)c=e.worldToClientPoint([this.controlPt[i-1][0],this.controlPt[i-1][1],this.controlPt[i-1][2]]);else{c=this.getControlPt(s,d);var u=e.clientToWorldPoint(c);u[0]&&u[1]&&(this.controlPt[i-1]=u)}t.quadraticCurveTo(c[0]-a[0],c[1]-a[1],d[0]-a[0],d[1]-a[1]),n.ctx.quadraticCurveTo(c[0]-a[0],c[1]-a[1],d[0]-a[0],d[1]-a[1])}n.ctx.stroke(),this.close&&this.fillStyle&&t.fill(),t.stroke(),t.restore(),n.ctx.restore()}},t.prototype.shouldClose=function(e,t,n){if(this.drawPoints.length<3)return!1;var o=e.worldToClientPoint([this.drawPoints[0][0],this.drawPoints[0][1],this.drawPoints[0][2]]);return a.default.distanceByArr(o,[t,n])<5?(this.close=!0,!0):(this.close=!1,!1)},t.prototype.getControlPt=function(e,t,n){var o=[(e[0]+t[0])/2,(e[1]+t[1])/2],i=.6*a.default.distanceByArr(e,t),r=[t[1]-e[1],e[0]-t[0]];return r=a.default.normalize(r),[o[0]+r[0]*i,o[1]+r[1]*i]},t.prototype.setPoints=function(e){this.drawPoints=e},t.prototype.addPoint=function(e){this.drawPoints.push(e)},t.prototype.getStartPoint=function(){return this.drawPoints[0]},t.prototype.popPoint=function(){this.drawPoints.pop()},t.prototype.isEmpty=function(){return 0==this.drawPoints.length},t.prototype.getPoints=function(){return this.drawPoints},t.prototype.getGrips=function(e,t){if(void 0==t)return this.drawPoints;var n=e.markupManager.getMarkupBbox(e,t),o=[n[0],n[1]],a=[n[2],n[3]],i=[(o[0]+a[0])/2,(o[1]+a[1])/2],r=[];return r.push(o[0],o[1]),r.push(o[0],i[1]),r.push(o[0],a[1]),r.push(i[0],a[1]),r.push(a[0],a[1]),r.push(a[0],i[1]),r.push(a[0],o[1]),r.push(i[0],o[1]),r},t}(i.default);n.default=l},{"../MarkupViewer":17,"../MathUtil":22,"./../Markups":21}],4:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./CloudMarkup"),i=e("./../MarkupTool"),r=e("../MathUtil"),l=e("./../Mouse"),s=l.MouseButtons,d=function(e){function t(t){var n=e.call(this)||this;return n.markupManager=t,n.bFirstCloudMarkup=!0,n.uncertainty=!1,n}return o(t,e),t.prototype.begin=function(e,t,n,o){if(this.bFirstCloudMarkup){if(e.markupManager.hitTest(e,t,n)>-1)return;var i=e.markupManager.getColor(),r=e.markupManager.getLineWidth(),l=e.markupManager.getFillStyleState()?e.markupManager.getFillColor():void 0;this.markup=new a.default([],i,r,null,0,l),this.bFirstCloudMarkup=!1}if(this.markup.shouldClose(e,t,n))this.addMarkup(e,this.markup),this.markup=null,this.redraw(e),this.bFirstCloudMarkup=!0;else{var s=e.clientToWorldPoint([t,n]);this.markup.popPoint(),this.markup.addPoint(s)}this.uncertainty=!1},t.prototype.onEditing=function(e,t,n,o){if(!this.bFirstCloudMarkup){var a=void 0;a=this.markup.shouldClose(e,t,n)?this.markup.getStartPoint():e.clientToWorldPoint([t,n]),this.uncertainty&&this.markup.drawPoints.length>1?this.markup.popPoint():this.uncertainty=!0,this.markup.addPoint(a),this.redraw(e)}},t.prototype.onMouseMove=function(e,t,n,o){this.onEditing(e,t,n,o)},t.prototype.end=function(e,t,n,o){if(this.bFirstCloudMarkup)return s.FINISHED},t.prototype.onMouseRightClick=function(e,t){this.bFirstCloudMarkup||(this.markup.popPoint(),this.markup.drawPoints.length>1&&this.addMarkup(e,this.markup),this.markup.close=!1,this.markup=null,this.redraw(e),this.bFirstCloudMarkup=!0)},t.prototype.onDoubleClick=function(e,t){if(!this.bFirstCloudMarkup){this.markup.popPoint();var n=this.markup.drawPoints.length;n>1&&this.addMarkup(e,this.markup);var o=e.worldToClientPoint([this.markup.drawPoints[n-1][0],this.markup.drawPoints[n-1][1],this.markup.drawPoints[n-1][2]]);r.default.distanceByArr(o,[t.x,t.y])<5&&this.markup.popPoint(),this.markup=null,this.redraw(e),this.bFirstCloudMarkup=!0}},t}(i.default);n.default=d},{"../MathUtil":22,"./../MarkupTool":16,"./../Mouse":23,"./CloudMarkup":3}],5:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./../Markups"),i=e("../MathUtil"),r=e("../MarkupViewer"),l=function(e){function t(t,n,o,a,i){var r=e.call(this)||this;return r.rotation=a||0,r.markupType="CloudRect",r.drawPoints=t,r.strokeStyle=n,r.lineWidth=o,r.fillStyle=i,r.baseUnit="30",r.bNeedHitByBbox=!0,r}return o(t,e),t.prototype.draw=function(e,t,n,o){if(!(this.drawPoints.length<2)){var a=e.worldToClientPoint([this.drawPoints[0][0],this.drawPoints[0][1],this.drawPoints[0][2]]),i=e.worldToClientPoint([this.drawPoints[1][0],this.drawPoints[1][1],this.drawPoints[1][2]]),l=this.getCenter(e),s=i[1]-a[1],d=i[0]-a[0],c=Math.abs(d),u=Math.abs(s),p=c/this.baseUnit,f=u/this.baseUnit,h=parseInt(p),m=parseInt(f),g=0==h?c:c/h,v=0==m?u:u/m;t.save(),t.translate(l[0],l[1]),t.rotate(this.rotation),t.beginPath(),n.ctx.save(),n.ctx.translate(l[0],l[1]),n.ctx.rotate(this.rotation),n.ctx.beginPath();var b=[-c/2,-u/2],y=[c/2,u/2];n.ctx.strokeStyle="rgba("+(2*o+2)+",40,40,1)",n.ctx.lineWidth=r.MarkupViewer.isMobile?36:this.lineWidth+n.lineWidth,t.lineJoin="round",this.drawSide("orientation",g,c,b[0],b[1],t,null,o,n,!0),this.drawSide("portrait",v,u,y[0],b[1],t,null,o,n),this.drawSide("orientation",g,c,y[0],y[1],t,!0,o,n),this.drawSide("portrait",v,u,b[0],y[1],t,!0,o,n),this.fillStyle&&t.fill(),t.stroke(),t.restore(),n.ctx.stroke(),n.ctx.restore()}},t.prototype.drawSide=function(e,t,n,o,a,i,r,l,s,d){var c,u=0,p=0,f=n/t,h=o,m=a;"orientation"==e?u=t:p=t;for(var g=0;g<f;g++){d&&0==g&&i.moveTo(o,a),c=r?[o-u,a-p]:[o+u,a+p],u&&Math.abs(c[0]-h)>n?c[0]=r?h-n:h+n:p&&Math.abs(c[1]-m)>n&&(c[1]=r?m-n:m+n);var v=this.getControlPt([o,a],c);i.quadraticCurveTo(v[0],v[1],c[0],c[1]),s.drawCloudRect(o,a,v,c,l),o=c[0],a=c[1]}},t.prototype.getControlPt=function(e,t,n){var o=[(e[0]+t[0])/2,(e[1]+t[1])/2],a=.5*i.default.distanceByArr(e,t),r=[t[1]-e[1],e[0]-t[0]];return r=i.default.normalize(r),[o[0]+r[0]*a,o[1]+r[1]*a]},t.prototype.setPoints=function(e){this.drawPoints=e},t.prototype.getPoints=function(){return this.drawPoints},t.prototype.getGrips=function(e){var t=e.worldToClientPoint(this.drawPoints[0]),n=e.worldToClientPoint(this.drawPoints[1]),o=[(t[0]+n[0])/2,(t[1]+n[1])/2],a=[];return a.push(t[0],t[1]),a.push(t[0],o[1]),a.push(t[0],n[1]),a.push(o[0],n[1]),a.push(n[0],n[1]),a.push(n[0],o[1]),a.push(n[0],t[1]),a.push(o[0],t[1]),a},t}(a.default);n.default=l},{"../MarkupViewer":17,"../MathUtil":22,"./../Markups":21}],6:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./../MarkupTool"),i=e("./CloudRectMarkup"),r=e("./../Mouse"),l=r.MouseButtons,s=function(e){function t(t){var n=e.call(this)||this;return n.markupManager=t,n}return o(t,e),t.prototype.begin=function(e,t,n,o){this.startX=t,this.startY=n;var a=e.markupManager.getColor(),r=e.markupManager.getLineWidth(),l=e.markupManager.getFillStyleState()?e.markupManager.getFillColor():void 0;this.markup=new i.default([],a,r,0,l)},t.prototype.onEditing=function(e,t,n,o){var a=e.clientToWorldPoint([this.startX,this.startY]),i=e.clientToWorldPoint([t,n]);this.markup.setPoints([a,i]),this.redraw(e)},t.prototype.end=function(e,t,n,o){return this.startX==t&&this.startY==n?(console.log("Ignore single point."),l.FINISHED):(this.addMarkup(e,this.markup),this.markup=null,l.FINISHED)},t}(a.default);n.default=s},{"./../MarkupTool":16,"./../Mouse":23,"./CloudRectMarkup":5}],7:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./../Markups"),i=e("../MarkupViewer"),r=function(e){function t(t,n,o,a){var i=e.call(this)||this;return i.rotation=a||0,i.markupType="Cross",i.drawPoints=t,i.strokeStyle=n,i.lineWidth=o,i.bNeedHitByBbox=!1,i}return o(t,e),t.prototype.draw=function(e,t,n,o){if(!(this.drawPoints.length<2)){var a=e.worldToClientPoint([this.drawPoints[0][0],this.drawPoints[0][1],this.drawPoints[0][2]]),r=e.worldToClientPoint([this.drawPoints[1][0],this.drawPoints[1][1],this.drawPoints[1][2]]),l=this.getCenter(e);t.save(),t.translate(l[0],l[1]),t.rotate(this.rotation),t.beginPath(),
t.moveTo(-.5*(r[0]-a[0]),-.5*(r[1]-a[1])),t.lineTo(.5*(r[0]-a[0]),.5*(r[1]-a[1])),t.moveTo(-.5*(r[0]-a[0]),.5*(r[1]-a[1])),t.lineTo(.5*(r[0]-a[0]),-.5*(r[1]-a[1])),t.stroke(),t.restore(),n.ctx.lineWidth=i.MarkupViewer.isMobile?36:this.lineWidth+n.lineWidth,n.drawCross(a,r,l,this.rotation,o)}},t.prototype.setPoints=function(e){this.drawPoints=e},t.prototype.getPoints=function(){return this.drawPoints},t.prototype.getGrips=function(e){var t=e.worldToClientPoint(this.drawPoints[0]),n=e.worldToClientPoint(this.drawPoints[1]),o=[(t[0]+n[0])/2,(t[1]+n[1])/2],a=[];return a.push(t[0],t[1]),a.push(t[0],o[1]),a.push(t[0],n[1]),a.push(o[0],n[1]),a.push(n[0],n[1]),a.push(n[0],o[1]),a.push(n[0],t[1]),a.push(o[0],t[1]),a},t}(a.default);n.default=r},{"../MarkupViewer":17,"./../Markups":21}],8:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./../MarkupTool"),i=e("./CrossMarkup"),r=e("./../Mouse"),l=r.MouseButtons,s=function(e){function t(t){var n=e.call(this)||this;return n.markupManager=t,n}return o(t,e),t.prototype.begin=function(e,t,n,o){this.startX=t,this.startY=n;var a=e.markupManager.getColor(),r=e.markupManager.getLineWidth();this.markup=new i.default([],a,r)},t.prototype.onEditing=function(e,t,n,o){var a=e.clientToWorldPoint([this.startX,this.startY]),i=e.clientToWorldPoint([t,n]);this.markup.setPoints([a,i]),this.redraw(e)},t.prototype.end=function(e,t,n,o){return this.startX==t&&this.startY==n?(console.log("Ignore single point."),l.FINISHED):(this.addMarkup(e,this.markup),this.markup=null,l.FINISHED)},t}(a.default);n.default=s},{"./../MarkupTool":16,"./../Mouse":23,"./CrossMarkup":7}],9:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./../Markups"),i=e("../MarkupViewer"),r=function(e){function t(t,n,o,a,i){var r=e.call(this)||this;return r.rotation=a||0,r.markupType="Ellipse",r.drawPoints=t,r.strokeStyle=n,r.lineWidth=o,r.fillStyle=i,r.bNeedHitByBbox=!0,r}return o(t,e),t.prototype.draw=function(e,t,n,o){if(!(this.drawPoints.length<2)){var a=e.worldToClientPoint([this.drawPoints[0][0],this.drawPoints[0][1],this.drawPoints[0][2]]),r=e.worldToClientPoint([this.drawPoints[1][0],this.drawPoints[1][1],this.drawPoints[1][2]]),l=.5*Math.abs(r[0]-a[0]),s=.5*Math.abs(r[1]-a[1]),d=this.getCenter(e);t.save(),t.translate(d[0],d[1]),t.rotate(this.rotation),t.beginPath(),t.ellipse(0,0,l,s,0,0,2*Math.PI),t.restore(),t.closePath(),this.fillStyle&&t.fill(),t.stroke(),n.ctx.lineWidth=i.MarkupViewer.isMobile?36:this.lineWidth+n.lineWidth,n.ctx.fillStyle=this.fillStyle,n.drawEllips(a,r,d,this.rotation,o,l,s)}},t.prototype.setPoints=function(e){this.drawPoints=e},t.prototype.getPoints=function(){return this.drawPoints},t.prototype.getGrips=function(e){var t=e.worldToClientPoint(this.drawPoints[0]),n=e.worldToClientPoint(this.drawPoints[1]),o=[(t[0]+n[0])/2,(t[1]+n[1])/2],a=[];return a.push(t[0],t[1]),a.push(t[0],o[1]),a.push(t[0],n[1]),a.push(o[0],n[1]),a.push(n[0],n[1]),a.push(n[0],o[1]),a.push(n[0],t[1]),a.push(o[0],t[1]),a},t}(a.default);n.default=r},{"../MarkupViewer":17,"./../Markups":21}],10:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./../MarkupTool"),i=e("./EllipsMarkup"),r=e("./../Mouse"),l=r.MouseButtons,s=function(e){function t(t){var n=e.call(this)||this;return n.markupManager=t,n}return o(t,e),t.prototype.begin=function(e,t,n,o){this.startX=t,this.startY=n;var a=e.markupManager.getColor(),r=e.markupManager.getLineWidth(),l=e.markupManager.getFillStyleState()?e.markupManager.getFillColor():void 0;this.markup=new i.default([],a,r,0,l)},t.prototype.onEditing=function(e,t,n,o){var a=e.clientToWorldPoint([this.startX,this.startY]),i=e.clientToWorldPoint([t,n]);this.markup.setPoints([a,i]),this.redraw(e)},t.prototype.end=function(e,t,n,o){return this.startX==t&&this.startY==n?(console.log("Ignore single point."),l.FINISHED):(this.addMarkup(e,this.markup),this.markup=null,l.FINISHED)},t}(a.default);n.default=s},{"./../MarkupTool":16,"./../Mouse":23,"./EllipsMarkup":9}],11:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),e("./MarkupDrawing"),e("./MarkupViewer3D"),e("./MarkupViewer2D")},{"./MarkupDrawing":12,"./MarkupViewer2D":18,"./MarkupViewer3D":19}],12:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0}),n.MarkupDrawing=void 0;var a=e("./MarkupViewer"),i=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.modelViewer.addEventListener("Rendered",function(){o.update()}),o.viewer.clientToWorldPoint=function(e){return o.viewer.toWorldPoint(e)},o.viewer.worldToClientPoint=function(e){return e?o.viewer.toScreenPoint([e[0],e[1]]):[]},o}return o(t,e),t.prototype.getCurrentState=function(){return{annotationList:this.getAnnotationList(),state:JSON.parse(this.modelViewer.getCurrentState())}},t.prototype.startDrawing=function(){this.canvas.style.zIndex=10,this.work=!0,this.alwaysMode=!1,this.showCanvas(),this.switchMode()},t.prototype.onTouchstart=function(e){if(!this.alwaysMode){var t=Date.now();if(t-this.firstTouch<500)return void this.editor.onDoubleTouch(this.viewer,e);this.firstTouch=t,!this.work&&this.restoreState&&(this.restoreState=!1,this.endDrawing()),this.work&&e.target==this.canvas&&e.touches.length<2&&(e.preventDefault(),this.editor.onTouchstart(this.viewer,e),this.containerSize=this.getContainerSize())}},t.prototype.onTouchmove=function(e){if(this.alwaysMode)return void this.update();if(this.work){var t=e.touches[0],n=this.containerSize,o=n.left,a=n.top,i=n.width,r=n.height;e.touches.length<2?(e.preventDefault(),e.stopPropagation(),t.pageX>o&&t.pageX<o+i&&t.pageY>a&&t.pageY<a+r&&this.editor.onTouchmove(this.viewer,e)):this.update()}},t.prototype.showAnnotation=function(){this.alwaysMode=!0,this.canvas.style.zIndex=5,this.editor.editIndex=-1,this.update(),this.showCanvas()},t.prototype.hideAnnotation=function(){this.hideCanvas()},t.prototype.setState=function(e){if("string"!=typeof e.state&&(e.state=JSON.stringify(e.state)),this.modelViewer.setState(e.state),"string"==typeof e.annotationList){var t=this.markupManager.fromString(e.annotationList);this.setAnnotationList(t)}else e.annotationList[0].id?this.setAnnotationList(this.transform(e.annotationList)):this.setAnnotationList(e.annotationList)},t.prototype.onMouseWheel=function(e){if(this.alwaysMode)return void this.update();!this.work&&this.restoreState&&(this.restoreState=!1,this.endDrawing()),this.work&&(e.preventDefault(),this.update(),this.editor.onMouseWheel(this.viewer,e))},t.prototype.createSnapshot=function(e){var t=this.viewer.snapshotPure(),n=document.createElement("canvas");n.width=this.wrapDom.clientWidth,n.height=this.wrapDom.clientHeight;var o=n.getContext("2d");o.beginPath(),o.fillStyle=this.wrapDom.style.background,o.fillRect(0,0,n.width,n.height),o.drawImage(t,0,0),o.drawImage(this.canvas,0,0),e(n.toDataURL())},t.prototype.switchMode=function(){this.work&&this.getIsDesktop()?this.modelViewer.setNavigationMode("pan"):this.modelViewer.setNavigationMode("pick")},t}(a.MarkupViewer);n.MarkupDrawing=i,window.MarkupDrawing=i},{"./MarkupViewer":17}],13:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o=e("./EllipsMarkup/EllipsMarkupTool"),a=e("./RectMarkup/RectMarkupTool"),i=e("./ArrowMarkup/ArrowMarkupTool"),r=e("./CrossMarkup/CrossMarkupTool"),l=e("./CloudMarkup/CloudMarkupTool"),s=e("./CloudRectMarkup/CloudRectMarkupTool"),d=e("./TextMarkup/TextMarkupTool"),c=e("./PolylineMarkup/PolylineMarkupTool"),u=e("./MarkupViewer"),p=e("./Mouse"),f=p.MouseButtons,h=function(){function e(e,t,n){this.canvas=e,this.MarkupVirtualPad=n,this.ctx=e.getContext("2d"),this.markupManager=t,this.setMarkupType("arrow"),this.curIndex=-1,this.editIndex=-1,this.preEdit=-1,this.inEditMode=!1,this.currentGrip=-1,this.bFirstClick=!0,this.firstPos=[],this.touchPos=[],this.hightLightColor="yellow",new d.default(this.markupManager).createDiv(d.default.divId)}return e.prototype.onDrawing=function(e,t,n){if(this.tool.onDrawing(e,t,this.MarkupVirtualPad,this.curIndex),this.curIndex!=this.highLightId&&this.highLightId>=0){var o=e.markupManager.get(this.highLightId);this.canvas.style.cursor="",this.highLightId=-1}if(this.curIndex>=0){var o=e.markupManager.get(this.curIndex);if(!o)return;n&&e.markupManager.hitTest(e,n[0],n[1])==this.curIndex&&(this.canvas.style.cursor="pointer",this.highLightId=this.curIndex)}if(this.editIndex>=0){if(0==e.markupManager.markups.length)return this.editIndex,!1;var a=e.markupManager.getMarkupBbox(e,this.editIndex);if(!a)return;var i=[a[0],a[1]],r=[a[2],a[3]],o=e.markupManager.get(this.editIndex),l=o.getGrips(e,this.editIndex),s=e.markupManager.getMarkupCenter(e,this.editIndex);if(!s)return;t.save(),t.translate(s[0],s[1]),"Arrow"!=o.markupType&&t.rotate(o.rotation),t.beginPath(),t.lineWidth="1",t.strokeStyle="red",t.fillStyle="#ffffff";var d=(o.lineWidth||0)/2;if(4!=l.length&&(t.strokeRect(-.5*(r[0]-i[0])-d,-.5*(r[1]-i[1])-d,r[0]-i[0]+2*d,r[1]-i[1]+2*d),t.arc(0,i[1]-s[1]-20,6,0,2*Math.PI,!1),t.fill(),t.stroke(),t.closePath(),t.beginPath(),t.arc(0,i[1]-s[1]-20,3,.5*Math.PI,1.8*Math.PI,!1),t.moveTo(3,i[1]-s[1]-21),t.lineTo(.5,i[1]-s[1]-19.5),t.moveTo(3,i[1]-s[1]-21),t.lineTo(3,i[1]-s[1]-24.5),t.stroke()),t.closePath(),"Arrow"==o.markupType){var c=e.markupManager.getMarkupSize(e,this.editIndex),u=Math.sqrt(c[0]*c[0]+c[1]*c[1]),p=c[0]/u*3,f=c[1]/u*3;t.beginPath(),t.arc(l[0]-s[0]+(l[0]<l[2]?-p/2:p/2),l[1]-s[1]+(l[1]<l[3]?-f/2:f/2),3,0,2*Math.PI,!1),t.fill(),t.stroke(),t.closePath(),t.beginPath(),t.arc(l[2]-s[0]+(l[0]<l[2]?p:-p),l[3]-s[1]+(l[1]<l[3]?f:-f),3,0,2*Math.PI,!1),t.fill(),t.stroke(),t.closePath()}else for(var h=0;h<l.length;h+=2){t.beginPath();var m=[l[h],l[h+1]];switch(h){case 0:t.arc(m[0]-s[0]-d,m[1]-s[1]-d,3,0,2*Math.PI,!1);break;case 2:t.arc(m[0]-s[0]-d,m[1]-s[1],3,0,2*Math.PI,!1);break;case 4:t.arc(m[0]-s[0]-d,m[1]-s[1]+d,3,0,2*Math.PI,!1);break;case 6:t.arc(m[0]-s[0],m[1]-s[1]+d,3,0,2*Math.PI,!1);break;case 8:t.arc(m[0]-s[0]+d,m[1]-s[1]+d,3,0,2*Math.PI,!1);break;case 10:t.arc(m[0]-s[0]+d,m[1]-s[1],3,0,2*Math.PI,!1);break;case 12:t.arc(m[0]-s[0]+d,m[1]-s[1]-d,3,0,2*Math.PI,!1);break;case 14:t.arc(m[0]-s[0],m[1]-s[1]-d,3,0,2*Math.PI,!1)}t.fill(),t.stroke(),t.closePath()}t.restore(),this.MarkupVirtualPad.drawEdit(i,r,s,o,l,this.editIndex,p,f,d)}},e.prototype.canCreateMarkup=function(e){if(-1==this.curIndex)return!0;var t=e.markupManager.get(this.curIndex);if(!t)return!0;var n=t.getGrips(e);return this.editIndex!=this.curIndex&&0!=n.length&&"Text"!=t.markupType},e.prototype.setMarkupType=function(e){switch(this.tool&&this.tool.onExit(),this.crtMarkupType=e,this.start=!1,e){case"ellips":this.tool=new o.default(this.markupManager);break;case"rectangle":this.tool=new a.default(this.markupManager);break;case"arrow":this.tool=new i.default(this.markupManager);break;case"cross":this.tool=new r.default(this.markupManager);break;case"cloud":this.tool=new l.default(this.markupManager);break;case"cloud-rect":this.tool=new s.default(this.markupManager);break;case"text":this.tool=new d.default(this.markupManager);break;case"polyline":this.tool=new c.default(this.markupManager);break;default:console.log("Current type is not supported.")}this.tool.redraw=this.redraw.bind(this),this.tool.type=e},e.prototype.begin=function(e,t,n,o){this.curIndex=e.markupManager.hitTest(e,t,n,!0);var a=this.curIndex<0&&this.canCreateMarkup(e),i=this.MarkupVirtualPad.isEdge(t,n);a&&!i&&(o==f.LelftButton&&(this.start=!0,this.textMarkupTool&&(this.textMarkupTool.initDom(e),this.textMarkupTool=null),this.tool.begin(e,t,n,o)),this.start&&o==f.RightButton&&this.tool.begin(e,t,n,o)),this.bFirstClick=!0;var r=this.editIndex;this.preEdit=r,this.curIndex>=0?(this.editIndex=this.curIndex,this.inEditMode=!0,this.redraw(e)):(this.editIndex=-1,this.redraw(e)),this.editIndex!=r&&e.onSelectChange(this.editIndex)},e.prototype.onEditing=function(e,t,n,o){if(this.start?-1!=this.curIndex&&this.editIndex==this.curIndex||this.tool.onEditing(e,t,n,o):this.tool.onMouseMove(e,t,n,o),this.inEditMode){var a=e.markupManager.hitGrip(e,[t,n],this.editIndex);if(this.bFirstClick){this.firstPos=[t,n],this.bFirstClick=!1,this.currentGrip=a>=0?a:-1;var i=e.markupManager.get(this.editIndex);if(!i)return;return i.originPoints=i.getPoints(),i.originRotation=i.rotation,"Text"==i.markupType&&(this.editIndex==this.preEdit&&i.userText&&i.originUserText&&this.currentGrip<9?i.userText=i.originUserText:-1!=this.currentGrip&&this.currentGrip<9&&(i.originUserText=i.userText)),i.controlPt&&(i.originControlPt=i.controlPt),void(i.editPt&&(i.originEditPt=i.editPt))}var r=[t,n];if(9==this.currentGrip)e.markupManager.gripRotate(e,this.editIndex,this.firstPos,r),this.redraw(e,r);else if(this.currentGrip>=0&&this.currentGrip<9)e.markupManager.gripDragging(e,this.editIndex,this.currentGrip,this.firstPos,r),this.redraw(e,r);else{var i=e.markupManager.get(this.editIndex);e.markupManager.translatePos(e,this.editIndex,this.firstPos,r),this.redraw(e,r)}}else this.bFirstClick=!0,this.currentGrip=-1,this.curIndex=e.markupManager.hitTest(e,t,n),this.redraw(e,[t,n])},e.prototype.end=function(e,t,n,o){this.start&&(-1!=this.curIndex&&this.editIndex==this.curIndex||f.FINISHED==this.tool.end(e,t,n,o)&&(this.start=!1)),this.inEditMode&&(this.inEditMode=!1),this.start=!1},e.prototype.onExit=function(e){this.tool.onExit(e)},e.prototype.onMouseWheel=function(e,t){this.start},e.prototype.onKeyDown=function(e,t){this.editIndex>=0&&("Delete"==t.code||"Backspace"==t.code)&&(e.markupManager.remove(this.editIndex),this.curIndex=-1,this.editIndex=-1,this.redraw(e))},e.prototype.onDoubleClick=function(e,t){this.tool.onDoubleClick&&this.tool.onDoubleClick(e,t),this.editText(e)},e.prototype.onDoubleTouch=function(e,t){this.tool.onDoubleTouch&&this.tool.onDoubleTouch(e,t),this.editText(e)},e.prototype.editText=function(e){if(!(this.curIndex<0||void 0==this.curIndex)){var t=e.markupManager.get(this.curIndex);if(t){var n=t.getPoints();if("Text"==t.markupType){var o=new d.default(this.markupManager,t.rotation);""!=d.default.lastTextareaId&&o.initDom(e);var a=e.worldToClientPoint([n[0][0],n[0][1],n[0][2]]);o.setUserText(t.getPureText()),this.tool.rotation=t.rotation,o.begin(e,a[0],a[1],f.LelftButton),o.setEditBox(t.getTextSize()),e.markupManager.remove(this.curIndex),this.highLightId=-1,this.curIndex=-1,this.editIndex=-1,this.textMarkupTool=o,this.redraw(e)}}}},e.prototype.onMouseDown=function(e,t){2==t.button?(e.startX=null,e.startY=null,this.tool.onMouseRightClick&&this.tool.onMouseRightClick(e,t)):this.begin(e,t.offsetX,t.offsetY,t.buttons)},e.prototype.onMouseMove=function(e,t){var n=this.formatEventOffset(e,t);this.onEditing(e,n.x,n.y,t.buttons)},e.prototype.onMouseUp=function(e,t,n){var o=this.formatEventOffset(e,t);if(n){var a=e.markupManager.hitTest(e,o.x,o.y,!0);if(a>-1){var i=e.markupManager.get(a);e.markupManager.viewer.alwaysMode&&0==t.button&&e.onClick(i)}}return this.end(e,o.x,o.y,t.buttons)},e.prototype.onTouchstart=function(e,t){var n=this.formatEventOffset(e,t);this.begin(e,n.x,n.y,1)},e.prototype.onTouchmove=function(e,t){var n=this.formatEventOffset(e,t);this.touchPos=[n.x,n.y],this.onEditing(e,n.x,n.y,1)},e.prototype.onTouchend=function(e,t){return this.end(e,this.touchPos[0],this.touchPos[1],1)},e.prototype.isPanMode=function(e){return e==f.MiddleButton||e==f.RightButton},e.prototype.formatEventOffset=function(e,t){var n,o,a=this.canvas.getBoundingClientRect();return u.MarkupViewer.isMobile?(n=t.touches[0].pageX-(a.x||a.left),o=t.touches[0].pageY-(a.y||a.top)):(n=t.clientX-(a.x||a.left),o=t.clientY-(a.y||a.top)),{x:n,y:o}},e.prototype.redraw=function(e,t){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.MarkupVirtualPad.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.MarkupVirtualPad.ctx.fillStyle="rgba(0,0,0,0)",this.MarkupVirtualPad.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.markupManager.draw(e,this.ctx),this.onDrawing(e,this.ctx,t)},e}();n.default=h},{"./ArrowMarkup/ArrowMarkupTool":2,"./CloudMarkup/CloudMarkupTool":4,"./CloudRectMarkup/CloudRectMarkupTool":6,"./CrossMarkup/CrossMarkupTool":8,"./EllipsMarkup/EllipsMarkupTool":10,"./MarkupViewer":17,"./Mouse":23,"./PolylineMarkup/PolylineMarkupTool":25,"./RectMarkup/RectMarkupTool":27,"./TextMarkup/TextMarkupTool":29}],14:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o=e("./RectMarkup/RectMarkup"),a=e("./EllipsMarkup/EllipsMarkup"),i=e("./ArrowMarkup/ArrowMarkup"),r=e("./CrossMarkup/CrossMarkup"),l=e("./CloudMarkup/CloudMarkup"),s=e("./CloudRectMarkup/CloudRectMarkup"),d=e("./TextMarkup/TextMarkup"),c=e("./PolylineMarkup/PolylineMarkup"),u=function(){function e(){}return e.markups2string=function(e){return JSON.stringify(e)},e.string2markups=function(e){var t=JSON.parse(e);return this.transform2markups(t)},e.transform2markups=function(e){for(var t=[],n=0;n<e.length;n++){var u=e[n],p=u.drawPoints,f=u.strokeStyle,h=u.lineWidth,m=u.fillStyle,g=u.close,v=u.userText,b=u.fontSize,y=u.rotation,w=u.fontFamily,C=u.textAreaId,M=u.center,B=u.markupId,k=u.controlPt,T=null;switch(u.markupType){case"Ellipse":T=new a.default(p,f,h,y,m);break;case"Rectangle":T=new o.default(p,f,h,y,m);break;case"Arrow":T=new i.default(p,f,h);break;case"Cross":T=new r.default(p,f,h,y);break;case"Cloud":T=new l.default(p,f,h,k,y,m,g);break;case"CloudRect":T=new s.default(p,f,h,y,m);break;case"Text":if(2==p.length&&"number"==typeof p[0]){if(T=new d.default(p,v,f,b,w,y,C,M,!0),u.pureText){var L=T.getTextSize();T.resizeText(L)}}else T=new d.default(p[0],v,f,b,w,y,C,M);break;case"Polyline":T=new c.default(p,f,h,y,m,g);break;default:console.log("Current type is not supported.")}B&&(T.markupId=B),t.push(T)}return t},e}();n.default=u},{"./ArrowMarkup/ArrowMarkup":1,"./CloudMarkup/CloudMarkup":3,"./CloudRectMarkup/CloudRectMarkup":5,"./CrossMarkup/CrossMarkup":7,"./EllipsMarkup/EllipsMarkup":9,"./PolylineMarkup/PolylineMarkup":24,"./RectMarkup/RectMarkup":26,"./TextMarkup/TextMarkup":28}],15:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o=e("./MarkupIO"),a=e("./MathUtil"),i=function(){function e(e,t){this.MarkupVirtualPad=e,this.viewer=t,this.markups=[],this.strokeStyle="red",this.lineWidth=3,this.fontSize=14,this.fontFamily="Arial",this.fillStyle="",this.enableFillStyle=!0}return e.prototype.toString=function(e){return o.default.markups2string(e||this.markups)},e.prototype.fromString=function(e){return o.default.string2markups(e)},e.prototype.add=function(e){e.markupId=Date.now(),this.markups.push(e)},e.prototype.setMarkups=function(e){this.markups=e.slice(),this.viewer.editor.editIndex=-1},e.prototype.clear=function(){this.markups=[],this.viewer.editor.tool.markup&&(this.viewer.editor.tool.markup.setPoints([]),this.viewer.editor.tool.bFirstCloudMarkup=!0)},e.prototype.draw=function(e,t){for(var n=this.markups,o=0,a=n.length;o<a;++o){var i=n[o];t.strokeStyle=i.strokeStyle,t.lineWidth=i.lineWidth,t.fillStyle=i.fillStyle,t.fontFamily=i.fontFamily,i.highLight&&(t.strokeStyle=i.highLight,i.highLight=null),i.draw(e,t,this.MarkupVirtualPad,o)}},e.prototype.getColor=function(){return this.strokeStyle},e.prototype.setColor=function(e){this.strokeStyle=e},e.prototype.getFillColor=function(){return this.fillStyle},e.prototype.setFillColor=function(e){this.enableFillStyle=!0,e.getRGBA&&(e=e.getRGBA()),this.fillStyle=e},e.prototype.setFillStyleState=function(e){this.enableFillStyle=e},e.prototype.getFillStyleState=function(){return this.enableFillStyle},e.prototype.getLineWidth=function(){return this.lineWidth},e.prototype.setLineWidth=function(e){this.lineWidth=e},e.prototype.getFont=function(){return this.font},e.prototype.getFontSize=function(){return this.fontSize},e.prototype.setFont=function(e){this.font=e},e.prototype.get=function(e){return this.markups[e]},e.prototype.remove=function(e){e<0||this.markups.splice(e,1)},e.prototype.hitTest=function(e,t,n,o){var i=this.MarkupVirtualPad.hitTest(t,n);if(void 0==o||i>=0)return i;i=-1;for(var r=this.markups.length-1;r>=0;r--){var l=this.markups[r];if(0!=l.bNeedHitByBbox&&"rgba(255,255,255,0)"!=l.fillStyle){var s=this.getMarkupBbox(e,r),d=this.getMarkupCenter(e,r),c=a.default.rotateAround([t,n],d,-l.rotation);if(1==!(c[0]<s[0]||c[0]>s[2]||c[1]<s[1]||c[1]>s[3])){i=r;break}}}return i},e.prototype.getMarkupBbox=function(e,t){var n=this.markups[t];if(!(t<0)&&n){var o=[Number.MAX_VALUE,Number.MAX_VALUE],a=[-Number.MAX_VALUE,-Number.MAX_VALUE],i=n.getPoints();if("Text"==n.markupType){return n.getTextBbox(e)}n.editPt?i=i.concat(n.editPt):n.controlPt&&(i=i.concat(n.controlPt));for(var r=0;r<i.length;r++){var l=e.worldToClientPoint(i[r]);l[0]<o[0]&&(o[0]=l[0]),l[1]<o[1]&&(o[1]=l[1]),l[0]>a[0]&&(a[0]=l[0]),l[1]>a[1]&&(a[1]=l[1])}return o.concat(a)}},e.prototype.getMarkupCenter=function(e,t){var n=this.getMarkupBbox(e,t);if(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}},e.prototype.setFontSize=function(e){this.fontSize=e},e.prototype.getMarkupSize=function(e,t){var n=this.getMarkupBbox(e,t);return[Math.abs(n[2]-n[0]),Math.abs(n[3]-n[1])]},e.prototype.getFontFamily=function(){return this.fontFamily},e.prototype.setFontFamily=function(e){this.fontFamily=e},e.prototype.translatePos=function(e,t,n,o){var a=this.markups[t];if(a.setPoints(a.originPoints),a.editPt&&(a.editPt=a.originEditPt),a.controlPt&&(a.controlPt=a.originControlPt),this.getMarkupCenter(e,t)){for(var i=o[0]-n[0],r=o[1]-n[1],l=a.originPoints,s=[],d=[],c=0;c<l.length;c++)d[c]=e.worldToClientPoint(l[c]),d[c][0]+=i,d[c][1]+=r,s[c]=e.clientToWorldPoint(d[c]);if(a.setPoints(s),"Cloud"==a.markupType){var u=(a.editPt&&a.originEditPt||a.controlPt&&a.originControlPt).slice();if(u){for(var p=[],c=0;c<u.length;c++)p[c]=e.worldToClientPoint(u[c]),p[c][0]+=i,p[c][1]+=r,u[c]=e.clientToWorldPoint(p[c]);a.editPt?a.editPt=u:a.controlPt=u}}}},e.prototype.isPointInCircle=function(e,t,n){return a.default.distanceByArr(e,t)<=n},e.prototype.hitGrip=function(e,t,n){return this.MarkupVirtualPad.hitGrip(t[0],t[1])},e.prototype.getX=function(e,t,n,o){return(o-t)/n+e},e.prototype.getY=function(e,t,n,o){return(o-e)*n+t},e.prototype.gripRotate=function(e,t,n,o){var a=this.markups[t];a.rotation=a.originRotation;var i=this.getMarkupCenter(e,t),r=Math.sqrt(Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2)),l=Math.sqrt(Math.pow(o[0]-i[0],2)+Math.pow(o[1]-i[1],2)),s=Math.sqrt(Math.pow(o[0]-n[0],2)+Math.pow(o[1]-n[1],2)),d=(s*s-r*r-l*l)/(-2*r*l),c=Math.acos(d),u=(n[1]-i[1])/(n[0]-i[0]),p=this.getY(n[0],n[1],u,o[0]),f=this.getX(n[0],n[1],u,o[1]);n[0]>i[0]&&n[1]<i[1]?o[0]<f&&o[1]<p&&(c=2*Math.PI-c):n[0]>i[0]&&n[1]>i[1]?o[0]>f&&o[1]<p&&(c=2*Math.PI-c):n[0]<i[0]&&n[1]>i[1]?o[0]>f&&o[1]>p&&(c=2*Math.PI-c):n[0]<i[0]&&n[1]<i[1]&&o[0]<f&&o[1]>p&&(c=2*Math.PI-c),a.rotation=a.originRotation+c},e.prototype.rotateTransform=function(e,t,n,o,a){n%=2*Math.PI,n=-n;var i,r,l=Math.sin(n),s=Math.cos(n);i=o-e,r=a-t;var d=i*s-r*l,c=i*l+r*s;return i=d+e,r=c+t,[i,r]},e.prototype.gripDragging=function(e,t,n,o,a){var i=this.markups[t],r=i.originPoints;i.setPoints(r),i.originUserText&&(i.userText=i.originUserText);var l=i.getGrips(e,t),s=this.getMarkupSize(e,t),d=s.slice(),c=this.getMarkupCenter(e,t),u=c.slice();if("Arrow"==i.markupType){var p=a[0]-o[0],f=a[1]-o[1],h=e.worldToClientPoint(r[0]),m=e.worldToClientPoint(r[1]);switch(n){case 0:h[0]+=p,h[1]+=f;break;case 4:m[0]+=p,m[1]+=f;break;default:console.log("default grip id."+n)}return h=e.clientToWorldPoint(h),m=e.clientToWorldPoint(m),void i.setPoints([h,m])}var g=this.rotateTransform(o[0],o[1],i.rotation,a[0],a[1]),v=g[0]-o[0],b=g[1]-o[1];switch(n){case 0:u[0]+=.5*v*Math.cos(i.rotation),u[1]+=.5*v*Math.sin(i.rotation),u[0]-=.5*b*Math.sin(i.rotation),u[1]+=.5*b*Math.cos(i.rotation),d[1]-=b,d[0]-=v;break;case 1:u[0]+=.5*v*Math.cos(i.rotation),u[1]+=.5*v*Math.sin(i.rotation),d[0]-=v;break;case 2:u[0]+=.5*v*Math.cos(i.rotation),u[1]+=.5*v*Math.sin(i.rotation),u[0]-=.5*b*Math.sin(i.rotation),u[1]+=.5*b*Math.cos(i.rotation),d[1]+=b,d[0]-=v;break;case 3:u[0]-=.5*b*Math.sin(i.rotation),u[1]+=.5*b*Math.cos(i.rotation),d[1]+=b;break;case 4:u[0]+=.5*v*Math.cos(i.rotation),u[1]+=.5*v*Math.sin(i.rotation),u[0]-=.5*b*Math.sin(i.rotation),u[1]+=.5*b*Math.cos(i.rotation),d[0]+=v,d[1]+=b;break;case 5:u[0]+=.5*v*Math.cos(i.rotation),u[1]+=.5*v*Math.sin(i.rotation),d[0]+=v;break;case 6:u[0]+=.5*v*Math.cos(i.rotation),u[1]+=.5*v*Math.sin(i.rotation),u[0]-=.5*b*Math.sin(i.rotation),u[1]+=.5*b*Math.cos(i.rotation),d[1]-=b,d[0]+=v;break;case 7:u[0]-=.5*b*Math.sin(i.rotation),u[1]+=.5*b*Math.cos(i.rotation),d[1]-=b}if("Cloud"==i.markupType||"Polyline"==i.markupType)return void this.draggingMultipleGrip(e,i,n,o,a,v,b,l,s,d,c,u);var y=[u[0]-.5*d[0],u[1]-.5*d[1]],w=[u[0]+.5*d[0],u[1]+.5*d[1]];"Text"==i.markupType&&i.resizeText(d),y=e.clientToWorldPoint(y),w=e.clientToWorldPoint(w),i.setPoints([y,w])},e.prototype.draggingMultipleGrip=function(e,t,n,o,a,i,r,l,s,d,c,u){var p=t.originPoints.slice(),f=c[0]-s[0]/2,h=c[1]-s[1]/2,m=u[0]-d[0]/2,g=u[1]-d[1]/2,v=function(t){for(var n=0;n<t.length;n++){var o=e.worldToClientPoint(t[n]),a=o[0],i=o[1],r=a-f,l=i-h;o[0]=r/s[0]*d[0]+m,o[1]=l/s[1]*d[1]+g,t[n]=e.clientToWorldPoint(o)}return t},b=v(p);if(t.setPoints(b),"Cloud"==t.markupType){var y=(t.originEditPt||t.originControlPt).slice();t.editPt=v(y)}},e}();n.default=i},{"./MarkupIO":14,"./MathUtil":22}],16:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.onDrawing=function(e,t,n,o){this.markup&&(t.strokeStyle=this.markup.strokeStyle,t.lineWidth=this.markup.lineWidth,t.fillStyle=this.markup.fillStyle,this.markup.draw(e,t,n,o))},e.prototype.addMarkup=function(e,t){t.drawEnd=!0,this.markupManager.add(t)},e.prototype.redraw=function(e){},e.prototype.onExit=function(e){},e.prototype.onMouseMove=function(e,t,n,o){},e}();n.default=o},{}],17:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MarkupViewer=void 0;var o=e("./MarkupEditor"),a=e("./MarkupManager"),i=e("./MarkupVirtualPad"),r=e("./MarkupIO"),l=e("./Mouse"),s=l.MouseButtons,d=function(){function e(t,n){var r=this;this.getIsDesktop=function(){var e=navigator.userAgent,t=/(?:Windows Phone)/.test(e),n=/(?:SymbianOS)/.test(e)||t,o=/(?:Android)/.test(e),a=/(?:Firefox)/.test(e),i=(/(?:Chrome|CriOS)/.test(e),/(?:iPad|PlayBook)/.test(e)||o&&!/(?:Mobile)/.test(e)||a&&/(?:Tablet)/.test(e));return!(/(?:iPhone)/.test(e)&&!i||o||n||i)},this.work=!1,this.alwaysMode=!1,this.restoreState=!1,this.firstTouch=0,this.modelViewer=t,this.canvas=document.createElement("canvas"),this.canvas.id="markup",this.canvas.style.zIndex=10,this.canvas.width=n.clientWidth,this.canvas.height=n.clientHeight,this.canvas.style.position="absolute",this.canvas.style.top="0",this.canvas.style.left="0",this.ctx=this.canvas.getContext("2d"),this.wrapDom=n,this.canvas.style.display="none",e.isMobile=!this.getIsDesktop(),n.appendChild(this.canvas),this.bindEvent();var l=this;this.viewer=t.getViewer?t.getViewer():t,this.viewer.wrapDom=n,this.MarkupVirtualPad=new i.default(this.viewer,n,e.isMobile),this.viewer.markupManager=this.markupManager=new a.default(this.MarkupVirtualPad,this),this.editor=this.viewer.markupEditor=new o.default(this.canvas,this.markupManager,this.MarkupVirtualPad),this.editor.markupManager=this.viewer.markupManager,this.viewer.onSelectChange=function(e){},this.viewer.onClick=function(e){},this.initOnresize=window.onresize,window.onresize=function(){l.canvas.width=n.clientWidth,l.canvas.height=n.clientHeight,l.MarkupVirtualPad.canvas.width=n.clientWidth,l.MarkupVirtualPad.canvas.height=n.clientHeight,l.modelViewer.resize(),l.update(),"[object Function]"===toString.call(l.initOnresize)&&l.initOnresize()},e.isMobile&&(this.offsetHeight=this.wrapDom.offsetHeight,setInterval(function(){var e=r.wrapDom.offsetHeight;r.offsetHeight!=e&&(r.offsetHeight=e,r.resize())},1e3))}return e.prototype.resize=function(){this.editor.tool.reposition&&this.editor.tool.reposition(this.viewer)},e.prototype.getContainerSize=function(){return this.wrapDom.getBoundingClientRect()},e.prototype.hideCanvas=function(){this.canvas.style.display="none"},e.prototype.showCanvas=function(){this.canvas.style.display="block"},e.prototype.startDrawing=function(){this.work=!0,this.alwaysMode=!1,this.showCanvas()},e.prototype.switchMode=function(){},e.prototype.initStyle=function(){var e=this.viewer.markupManager;e.markups=[],e.strokeStyle="red",e.lineWidth=3,e.fontSize=14,e.fontFamily="Arial",e.fillStyle="white",e.enableFillStyle=!1},e.prototype.update=function(){this.editor.redraw(this.viewer)},e.prototype.bindEvent=function(){this.getIsDesktop()?(this.wrapDom.addEventListener("mousedown",this.onMouseDown.bind(this),!0),this.wrapDom.addEventListener("mouseup",this.onMouseUp.bind(this),!1),this.wrapDom.addEventListener("mousemove",this.onMouseMove.bind(this),!1),this.wrapDom.addEventListener("mousewheel",this.onMouseWheel.bind(this),!1),this.wrapDom.addEventListener("DOMMouseScroll",this.onMouseWheel.bind(this),!1),this.wrapDom.addEventListener("contextmenu",this.oncontextmenu.bind(this),!1)):(this.wrapDom.addEventListener("touchstart",this.onTouchstart.bind(this),!0),this.wrapDom.addEventListener("touchend",this.onTouchend.bind(this),!0),this.wrapDom.addEventListener("touchmove",this.onTouchmove.bind(this),!0)),document.addEventListener("keydown",this.onKeyDown.bind(this)),document.addEventListener("keyup",this.onKeyUp.bind(this))},e.prototype.endDrawing=function(){this.work=!1,this.clearAnnotations(),this.editor.redraw(this.viewer),this.hideCanvas(),this.switchMode(),this.restoreState=!1;var e=document.querySelector("#bf-drawing-textEditor");if(e){var t=e.querySelectorAll("textarea");t.length&&(t[t.length-1].style.display="none",t[t.length-1].value="")}},e.prototype.clearAnnotations=function(){this.markupManager.clear(),this.update()},e.prototype.removeSelectedAnnotation=function(){-1!=this.editor.editIndex&&(this.markupManager.remove(this.editor.editIndex),this.editor.editIndex=-1,this.update())},e.prototype.createSnapshot=function(e){},e.prototype.showAnnotation=function(){},e.prototype.setAnnotationType=function(e){this.editor.setMarkupType(e)},e.prototype.setAnnotationStyle=function(e){e["stroke-color"]&&this.markupManager.setColor(e["stroke-color"]),e["font-size"]&&this.markupManager.setFontSize(e["font-size"]),e["stroke-width"]&&this.markupManager.setLineWidth(e["stroke-width"]),e["fill-color"]&&this.markupManager.setFillColor(e["fill-color"]),e["font-family"]&&this.markupManager.setFontFamily(e["font-family"])},e.prototype.getAnnotationList=function(){return this.markupManager.markups.slice()},e.prototype.setAnnotationList=function(e){var t=e[0]
;if(!t)return this.clearAnnotations();if(t.drawPoints&&"number"==typeof t.drawPoints[0])for(var n=0;n<e.length;n++){for(var o=e[n].drawPoints,a=[],i=0;i<o.length;i+=2)a.push([o[i],o[i+1]]);e[n].drawPoints=a}t&&t.draw||(e=r.default.transform2markups(e)),this.markupManager.setMarkups(e),this.restoreState=!0,this.showCanvas(),this.update()},e.prototype.editAnnotationEnd=function(){this.endDrawing()},e.prototype.getCurrentState=function(){return{annotationList:this.getAnnotationList(),state:this.modelViewer.getCurrentState()}},e.prototype.transform=function(e){return e},e.prototype.setState=function(e){var t=this;this.clearAnnotations(),this.modelViewer.setState(e.state),setTimeout(function(){if("string"==typeof e.annotationList){var n=t.markupManager.fromString(e.annotationList);t.setAnnotationList(n)}else e.annotationList[0].id?t.setAnnotationList(t.transform(e.annotationList)):t.setAnnotationList(e.annotationList)},1500)},e.prototype.oncontextmenu=function(e){e.preventDefault()},e.prototype.onDoubleClick=function(e){this.alwaysMode||(!this.work&&this.restoreState&&(this.restoreState=!1,this.endDrawing()),e.preventDefault(),this.editor.onDoubleClick(this.viewer,e))},e.prototype.onMouseDown=function(e){if(!this.alwaysMode&&(!this.work&&this.restoreState&&(this.restoreState=!1,this.endDrawing()),this.work&&e.target==this.canvas))if(e.preventDefault(),e.buttons==s.LelftButton){e.stopPropagation();var t=Date.now(),n=[e.clientX,e.clientY];t-this.prevTime<500&&this.prevPoint[0]==n[0]?this.onDoubleClick(e):(this.prevTime=t,this.prevPoint=n,this.editor.onMouseDown(this.viewer,e))}else this.editor.onMouseDown(this.viewer,e)},e.prototype.onTouchstart=function(e){if(!this.alwaysMode&&"CANVAS"==e.target.tagName.toUpperCase()){var t=Date.now();if(t-this.firstTouch<500)return void this.editor.onDoubleTouch(this.viewer,e);this.firstTouch=t,!this.work&&this.restoreState&&(this.restoreState=!1,this.endDrawing()),this.work&&e.target==this.canvas&&(e.preventDefault(),e.buttons==s.LelftButton&&e.stopPropagation(),this.editor.onTouchstart(this.viewer,e),this.containerSize=this.getContainerSize())}},e.prototype.onMouseMove=function(e){if(this.alwaysMode)return void this.update();this.work&&(e.preventDefault(),e.stopPropagation(),this.editor.onMouseMove(this.viewer,e))},e.prototype.onTouchmove=function(e){if(this.alwaysMode||"CANVAS"!=e.target.tagName.toUpperCase())return void this.update();if(this.work){var t=e.touches[0],n=this.containerSize,o=n.left,a=n.top,i=n.width,r=n.height;e.preventDefault(),e.stopPropagation(),t.pageX>o&&t.pageX<o+i&&t.pageY>a&&t.pageY<a+r&&this.editor.onTouchmove(this.viewer,e)}},e.prototype.onTouchend=function(e){this.alwaysMode||"CANVAS"!=e.target.tagName.toUpperCase()||(!this.work&&this.restoreState&&(this.restoreState=!1,this.endDrawing()),this.work&&(e.preventDefault(),e.stopPropagation(),this.editor.onTouchend(this.viewer,e)))},e.prototype.onMouseWheel=function(e){this.alwaysMode||(!this.work&&this.restoreState&&(this.restoreState=!1,this.endDrawing()),this.work&&(e.preventDefault(),e.stopPropagation(),this.editor.onMouseWheel(this.viewer,e)))},e.prototype.onMouseUp=function(e){if(this.alwaysMode)return void this.editor.onMouseUp(this.viewer,e,!0);!this.work&&this.restoreState&&(this.restoreState=!1,this.endDrawing()),this.work&&(e.preventDefault(),e.stopPropagation(),this.editor.onMouseUp(this.viewer,e,!0))},e.prototype.onKeyDown=function(e){this.work&&("textarea"!=document.activeElement.tagName.toLowerCase()&&e.stopPropagation(),this.editor.onKeyDown(this.viewer,e))},e.prototype.onKeyUp=function(e){this.work&&"textarea"!=document.activeElement.tagName.toLowerCase()&&(e.preventDefault(),e.stopPropagation())},e}();n.MarkupViewer=d},{"./MarkupEditor":13,"./MarkupIO":14,"./MarkupManager":15,"./MarkupVirtualPad":20,"./Mouse":23}],18:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0}),n.MarkupViewer2D=void 0;var a=e("./MarkupViewer"),i=e("./ArrowMarkup/ArrowMarkup"),r=e("./EllipsMarkup/EllipsMarkup"),l=e("./RectMarkup/RectMarkup"),s=e("./CrossMarkup/CrossMarkup"),d=e("./CloudMarkup/CloudMarkup"),c=e("./CloudRectMarkup/CloudRectMarkup"),u=e("./TextMarkup/TextMarkup"),p=e("./Mouse"),f=p.MouseButtons,h=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.absoluteBasePoint=null,o.screenBasePoint=null,o.zoomFactor={x:1,y:1},o.viewBox={width:1e3,height:1e3},o.viewer.clientToWorldPoint=function(e){var t=o.viewer.clientToWorld({x:e[0],y:e[1]});return[t.x,t.y]},o.viewer.worldToClientPoint=function(e){var t=o.viewer.worldToClient({x:e[0],y:e[1]});return[t.x,t.y]},o}return o(t,e),t.prototype.onMouseUp=function(e){!this.work&&this.restoreState&&(this.restoreState=!1,this.endDrawing()),this.work&&this.editor.onMouseUp(this.viewer,e)},t.prototype.setState=function(e){if(this.modelViewer.setState(e.state),"string"==typeof e.annotationList){var t=this.markupManager.fromString(e.annotationList);this.setAnnotationList(t)}else e.annotationList[0].id?this.setAnnotationList(this.transform(e.annotationList)):this.setAnnotationList(e.annotationList)},t.prototype.createSnapshot=function(e){var t=this;this.viewer._imageRender.createSnapshotAsync("",function(n){t.getScreenSnapshot(n,e)})},t.prototype.getScreenSnapshot=function(e,t){var n=document.createElement("canvas"),o=this.getContainerOffsetToClient(this.wrapDom);n.width=o.width,n.height=o.height;var a=n.getContext("2d"),i=this;if(t&&e){var r=new Image;return r.onload=function(){a.drawImage(r,0,0),a.drawImage(i.canvas,0,0);var e=n.toDataURL("image/png");n=a=null,t(e)},r.src=e,null}if(e){var r=new Image;r.src=e,a.drawImage(r,0,0)}a.drawImage(this.canvas,0,0);var l=n.toDataURL("image/png");return n=a=null,l},t.prototype.transform=function(e){for(var t=[],n=0;n<e.length;n++){var o,a=e[n],p=a.style,f=p["fill-opacity"];switch(a.shapeType){case 0:var h=this.getArrowPoints(a.size,a.position,-a.rotation);o=new i.default(h,p["stroke-color"],p["stroke-width"],a.rotation);break;case 7:o=new c.default(this.getDrawPoints(a.size,a.position),p["stroke-color"],p["stroke-width"],a.rotation,f&&p["fill-color"]);break;case 4:var m=this.getCloudPoints(a);o=new d.default(m[0],p["stroke-color"],p["stroke-width"],m[1],a.rotation,f&&p["fill-color"]);break;case 1:o=new l.default(this.getDrawPoints(a.size,a.position),p["stroke-color"],p["stroke-width"],a.rotation,f&&p["fill-color"]);break;case 2:o=new r.default(this.getDrawPoints(a.size,a.position),p["stroke-color"],p["stroke-width"],a.rotation,f&&p["fill-color"]);break;case 3:o=new s.default(this.getDrawPoints(a.size,a.position),p["stroke-color"],p["stroke-width"],a.rotation);break;case 5:var g=this.worldToClient({x:a.position.x-.5*a.size.width,y:a.position.y+.5*a.size.height,z:a.position.z}),v=this.worldToClient(a.position),b=this.viewer.clientToWorldPoint([v.x,v.y]);o=new u.default(this.viewer.clientToWorldPoint([g.x,g.y]),decodeURIComponent(a.text),p["stroke-color"],p["font-size"],p["font-family"],a.rotation,null,b)}t.push(o)}return t},t.prototype.getContainerOffsetToClient=function(e){var t,n=function(e){for(var t=0,n=0;e;)t+=e.offsetTop,n+=e.offsetLeft,e=e.offsetParent;var o=document.body,a=document.documentElement,i=window.pageYOffset||a.scrollTop||o.scrollTop,r=window.pageXOffset||a.scrollLeft||o.scrollLeft;return t-=i,n-=r,{top:t,left:n}},o=function(e){var t=e.getBoundingClientRect(),n=document.body,o=document.documentElement,a=o.clientTop||n.clientTop,i=o.clientLeft||n.clientLeft,r=t.top-a,l=t.left-i;return{top:Math.round(r),left:Math.round(l)}};if(e!=document){var a=function(e){return e.getBoundingClientRect?o(e):n(e)}(e);t={width:e.offsetWidth,height:e.offsetHeight,left:a.left,top:a.top}}else t={width:window.innerWidth,height:window.innerHeight,left:0,top:0};return t},t.prototype.getCloudPoints=function(e){for(var t=e.size.width/e.originSize.width,n=e.size.height/e.originSize.height,o=(new window.THREE.Matrix4).makeScale(t,n,1),a=(new window.THREE.Matrix4).makeRotationZ(-e.rotation),i=(new window.THREE.Matrix4).makeTranslation(e.position.x,e.position.y,e.position.z),r=i.multiply(a).multiply(o),l=e.shapePoints.split(","),s=[],d=[],c=!0,u=(e.position,1);u<l.length;u+=2){var p=new window.THREE.Vector3,f=this.viewBoxToWorld({x:parseInt(l[u-1]),y:parseInt(l[u])},e.originSize);p.x=f.x,p.y=f.y,p.z=0,p.applyMatrix4(r);var h=this.worldToClient(p),m=this.viewer.clientToWorldPoint([h.x,h.y]);c?s.push(m):d.push(m),c=!c}return[s,d]},t.prototype.worldToClient=function(e){var t=this.getContainerOffsetToClient(this.wrapDom),n=new window.THREE.Vector3,o=this.absoluteBasePoint,a=this.screenBasePoint;return this.absoluteBasePoint||(o={x:0,y:0}),this.screenBasePoint||(a={x:.5*t.width,y:.5*t.height}),n.x=(e.x-o.x)*this.zoomFactor.x+a.x,n.y=(-e.y-o.y)*this.zoomFactor.y+a.y,n.z=0,n},t.prototype.viewBoxToWorld=function(e,t){var n=t.width,o=t.height,a=this.viewBox.width,i=this.viewBox.height;return{x:e.x/a*n,y:e.y/i*o}},t.prototype.getDrawPoints=function(e,t){var n=this.worldToClient({x:t.x-.5*e.width,y:t.y-.5*e.height,z:t.z}),o=this.worldToClient({x:t.x+.5*e.width,y:t.y+.5*e.height,z:t.z});return[this.viewer.clientToWorldPoint([n.x,n.y]),this.viewer.clientToWorldPoint([o.x,o.y])]},t.prototype.getArrowPoints=function(e,t,n){var o=this.worldToClient({x:t.x-.5*e.width,y:t.y,z:t.z}),a=this.worldToClient({x:t.x+.5*e.width,y:t.y,z:t.z}),i=this.worldToClient(t);return o=this.markupManager.rotateTransform(i.x,i.y,n,o.x,o.y),a=this.markupManager.rotateTransform(i.x,i.y,n,a.x,a.y),[this.viewer.clientToWorldPoint(o),this.viewer.clientToWorldPoint(a)]},t.prototype.onMouseDown=function(e){if(!this.work&&this.restoreState&&(this.restoreState=!1,this.endDrawing()),this.work&&e.target==this.canvas)if(e.preventDefault(),e.buttons==f.LelftButton){e.stopPropagation();var t=Date.now(),n=[e.clientX,e.clientY];t-this.prevTime<500&&this.prevPoint[0]==n[0]?this.onDoubleClick(e):(this.prevTime=t,this.prevPoint=n,this.editor.onMouseDown(this.viewer,e))}else this.editor.onMouseDown(this.viewer,e)},t.prototype.onMouseWheel=function(e){this.work&&(e.preventDefault(),this.update(),this.editor.onMouseWheel(this.viewer,e))},t}(a.MarkupViewer);n.MarkupViewer2D=h,window.MarkupViewer2D=h},{"./ArrowMarkup/ArrowMarkup":1,"./CloudMarkup/CloudMarkup":3,"./CloudRectMarkup/CloudRectMarkup":5,"./CrossMarkup/CrossMarkup":7,"./EllipsMarkup/EllipsMarkup":9,"./MarkupViewer":17,"./Mouse":23,"./RectMarkup/RectMarkup":26,"./TextMarkup/TextMarkup":28}],19:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0}),n.MarkupViewer3D=void 0;var a=e("./MarkupViewer"),i=e("./ArrowMarkup/ArrowMarkup"),r=e("./EllipsMarkup/EllipsMarkup"),l=e("./RectMarkup/RectMarkup"),s=e("./CrossMarkup/CrossMarkup"),d=e("./CloudMarkup/CloudMarkup"),c=e("./CloudRectMarkup/CloudRectMarkup"),u=e("./TextMarkup/TextMarkup"),p=e("./Mouse"),f=(p.MouseButtons,function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.cameraControl=o.viewer.cameraControl,o.viewBox={width:1e3,height:1e3},o.viewer.clientToWorldPoint=function(e){var t={x:e[0],y:e[1],z:0},n=o.viewer.canvasToWorld(t);return[n.x,n.y,n.z]},o.viewer.worldToClientPoint=function(e){var t={x:e[0],y:e[1],z:e[2]||0},n=o.viewer.worldToCanvas(t);return[n.x,n.y]},o}return o(t,e),t.prototype.bindEvent=function(){this.getIsDesktop()?(this.wrapDom.addEventListener("dblclick",this.onDoubleClick.bind(this),!0),this.wrapDom.addEventListener("mousedown",this.onMouseDown.bind(this),!0),this.wrapDom.addEventListener("mouseup",this.onMouseUp.bind(this),!0),this.wrapDom.addEventListener("mousemove",this.onMouseMove.bind(this),!0),this.wrapDom.addEventListener("mousewheel",this.onMouseWheel.bind(this),!0),this.wrapDom.addEventListener("DOMMouseScroll",this.onMouseWheel.bind(this),!0),this.wrapDom.addEventListener("contextmenu",this.oncontextmenu.bind(this),!0),document.addEventListener("keydown",this.onKeyDown.bind(this),!0),document.addEventListener("keyup",this.onKeyUp.bind(this),!0)):(this.wrapDom.addEventListener("touchstart",this.onTouchstart.bind(this),!0),this.wrapDom.addEventListener("touchend",this.onTouchend.bind(this),!0),this.wrapDom.addEventListener("touchmove",this.onTouchmove.bind(this),!0))},t.prototype.createSnapshot=function(e){var t=this.wrapDom.querySelector(".bf-view canvas"),n=document.createElement("canvas");n.width=this.wrapDom.clientWidth,n.height=this.wrapDom.clientHeight;var o=n.getContext("2d");o.beginPath();var a=window.devicePixelRatio||1;o.drawImage(t,0,0,n.width*a,n.height*a,0,0,n.width,n.height),o.drawImage(this.canvas,0,0),e(n.toDataURL())},t.prototype.transform=function(e){for(var t=[],n=0;n<e.length;n++){var o,a=e[n],p=a.style,f=p["fill-opacity"];switch(a.shapeType){case 0:var h=this.getArrowPoints(a.size,a.position,-a.rotation);o=new i.default(h,p["stroke-color"],p["stroke-width"],a.rotation);break;case 7:o=new c.default(this.getDrawPoints(a.size,a.position),p["stroke-color"],p["stroke-width"],a.rotation,f&&p["fill-color"]);break;case 4:var m=this.getCloudPoints(a);o=new d.default(m[0],p["stroke-color"],p["stroke-width"],m[1],a.rotation,f&&p["fill-color"],!0),o.close=!0;break;case 1:o=new l.default(this.getDrawPoints(a.size,a.position),p["stroke-color"],p["stroke-width"],a.rotation,f&&p["fill-color"]);break;case 2:o=new r.default(this.getDrawPoints(a.size,a.position),p["stroke-color"],p["stroke-width"],a.rotation,f&&p["fill-color"]);break;case 3:o=new s.default(this.getDrawPoints(a.size,a.position),p["stroke-color"],p["stroke-width"],a.rotation);break;case 5:var g=this.worldToClient({x:a.position.x-.5*a.size.width,y:a.position.y+.5*a.size.height,z:a.position.z}),v=this.worldToClient(a.position),b=this.viewer.clientToWorldPoint([v.x,v.y]);o=new u.default(this.viewer.clientToWorldPoint([g.x,g.y]),decodeURIComponent(a.text),p["stroke-color"],p["font-size"],p["font-family"],a.rotation,null,b)}t.push(o)}return t},t.prototype.getCloudPoints=function(e){for(var t=e.size.width/e.originSize.width,n=e.size.height/e.originSize.height,o=(new window.THREE.Matrix4).makeScale(t,n,1),a=(new window.THREE.Matrix4).makeRotationZ(-e.rotation),i=(new window.THREE.Matrix4).makeTranslation(e.position.x,e.position.y,e.position.z),r=i.multiply(a).multiply(o),l=e.shapePoints.split(","),s=[],d=[],c=!0,u=(e.position,1);u<l.length;u+=2){var p=new window.THREE.Vector3,f=this.viewBoxToWorld({x:parseInt(l[u-1]),y:parseInt(l[u])},e.originSize);p.x=f.x,p.y=f.y,p.z=0,p.applyMatrix4(r);var h=this.worldToClient(p),m=this.viewer.clientToWorldPoint([h.x,h.y]);c?s.push(m):d.push(m),c=!c}return[s,d]},t.prototype.viewBoxToWorld=function(e,t){var n=t.width,o=t.height,a=this.viewBox.width,i=this.viewBox.height;return{x:e.x/a*n,y:e.y/i*o}},t.prototype.getDrawPoints=function(e,t){var n=this.worldToClient({x:t.x-.5*e.width,y:t.y-.5*e.height,z:t.z}),o=this.worldToClient({x:t.x+.5*e.width,y:t.y+.5*e.height,z:t.z});return[this.viewer.clientToWorldPoint([n.x,n.y]),this.viewer.clientToWorldPoint([o.x,o.y])]},t.prototype.getArrowPoints=function(e,t,n){var o=this.worldToClient({x:t.x-.5*e.width,y:t.y,z:t.z}),a=this.worldToClient({x:t.x+.5*e.width,y:t.y,z:t.z}),i=this.worldToClient(t);return o=this.markupManager.rotateTransform(i.x,i.y,n,o.x,o.y),a=this.markupManager.rotateTransform(i.x,i.y,n,a.x,a.y),[this.viewer.clientToWorldPoint(o),this.viewer.clientToWorldPoint(a)]},t.prototype.worldToClient=function(e){var t=this.getContainerOffsetToClient(this.wrapDom),n=this.cameraControl.getCamera(),o=new window.THREE.Vector3(e.x,e.y,e.z);return o.applyMatrix4(n.matrixWorld),o.sub(n.position),o.project(n),o.x=Math.floor(.5*(o.x+1)*t.width+.5),o.y=Math.floor(-.5*(o.y-1)*t.height+.5),o.z=0,o},t.prototype.getContainerOffsetToClient=function(e){var t,n=function(e){for(var t=0,n=0;e;)t+=e.offsetTop,n+=e.offsetLeft,e=e.offsetParent;var o=document.body,a=document.documentElement,i=window.pageYOffset||a.scrollTop||o.scrollTop,r=window.pageXOffset||a.scrollLeft||o.scrollLeft;return t-=i,n-=r,{top:t,left:n}},o=function(e){var t=e.getBoundingClientRect(),n=document.body,o=document.documentElement,a=o.clientTop||n.clientTop,i=o.clientLeft||n.clientLeft,r=t.top-a,l=t.left-i;return{top:Math.round(r),left:Math.round(l)}};if(e!=document){var a=function(e){return e.getBoundingClientRect?o(e):n(e)}(e);t={width:e.offsetWidth,height:e.offsetHeight,left:a.left,top:a.top}}else t={width:window.innerWidth,height:window.innerHeight,left:0,top:0};return t},t}(a.MarkupViewer));n.MarkupViewer3D=f,window.MarkupViewer3D=f},{"./ArrowMarkup/ArrowMarkup":1,"./CloudMarkup/CloudMarkup":3,"./CloudRectMarkup/CloudRectMarkup":5,"./CrossMarkup/CrossMarkup":7,"./EllipsMarkup/EllipsMarkup":9,"./MarkupViewer":17,"./Mouse":23,"./RectMarkup/RectMarkup":26,"./TextMarkup/TextMarkup":28}],20:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MarkupVirtualPad=void 0;var o=e("./MarkupViewer"),a=function(){function e(e,t,n){this.isMobile=n,this.canvas=document.createElement("canvas"),this.viewer=e,this.canvas.id="markupVirtual",this.canvas.width=t.clientWidth,this.canvas.height=t.clientHeight,document.body.appendChild(this.canvas),this.canvas.style.display="none",this.ctx=this.canvas.getContext("2d"),this.lineWidth=o.MarkupViewer.isMobile?36:2}return e.prototype.init=function(e,t){var n=this.ctx;n.save(),n.translate(e[0],e[1]),n.rotate(t),n.beginPath()},e.prototype.drawEdit=function(e,t,n,o,a,i,r,l,s){var d=this.ctx;if(d.save(),d.translate(n[0],n[1]),"Arrow"!=o.markupType&&d.rotate(o.rotation),d.beginPath(),d.lineWidth=o.lineWidth+2,d.fillStyle="rgba("+(2*i+2)+",255,255,1)",d.fillRect(-.5*(t[0]-e[0]),-.5*(t[1]-e[1]),t[0]-e[0],t[1]-e[1]),d.fillStyle=d.strokeStyle="rgba("+(2*i+2)+",100,255,1)",d.arc(0,e[1]-n[1]-20,13,0,2*Math.PI,!1),d.fill(),"Arrow"==o.markupType)d.fillStyle=d.strokeStyle="rgba("+(2*i+2)+",110,255,1)",d.beginPath(),d.arc(a[0]-n[0]+(a[0]<a[2]?-r/2:r/2),a[1]-n[1]+(a[1]<a[3]?-l/2:l/2),10,0,2*Math.PI,!1),d.fill(),d.stroke(),d.closePath(),d.fillStyle=d.strokeStyle="rgba("+(2*i+2)+",150,255,1)",d.beginPath(),d.arc(a[2]-n[0]+(a[0]<a[2]?r:-r),a[3]-n[1]+(a[1]<a[3]?l:-l),10,0,2*Math.PI,!1),d.fill(),d.stroke(),d.closePath();else for(var c=0;c<a.length;c+=2){d.fillStyle=d.strokeStyle="rgba("+(2*i+2)+","+(5*c+110)+",255,1)",d.beginPath();var u=[a[c],a[c+1]],p=this.isMobile?10:3;switch(c){case 0:d.arc(u[0]-n[0]-s,u[1]-n[1]-s,p,0,2*Math.PI,!1);break;case 2:d.arc(u[0]-n[0]-s,u[1]-n[1],p,0,2*Math.PI,!1);break;case 4:d.arc(u[0]-n[0]-s,u[1]-n[1]+s,p,0,2*Math.PI,!1);break;case 6:d.arc(u[0]-n[0],u[1]-n[1]+s,p,0,2*Math.PI,!1);break;case 8:d.arc(u[0]-n[0]+s,u[1]-n[1]+s,p,0,2*Math.PI,!1);break;case 10:d.arc(u[0]-n[0]+s,u[1]-n[1],p,0,2*Math.PI,!1);break;case 12:d.arc(u[0]-n[0]+s,u[1]-n[1]-s,p,0,2*Math.PI,!1);break;case 14:d.arc(u[0]-n[0],u[1]-n[1]-s,p,0,2*Math.PI,!1)}d.fill(),d.stroke(),d.closePath()}d.restore()},e.prototype.drawArrow=function(e,t,n,a,i,r,l,s,d,c,u,p,f,h){var m=t-r,g=n-l,v=this.ctx;v.save(),v.lineWidth=o.MarkupViewer.isMobile?36:e.lineWidth+this.lineWidth,v.strokeStyle="rgba("+(2*p+2)+",20,20,1)",v.fillStyle="rgba("+(2*p+2)+",20,255,1)",v.beginPath(),v.moveTo(t,n),v.lineTo(a,i),m=a+r,g=i+l,v.moveTo(m,g),v.lineTo(a,i),m=a+s,g=i+d,v.lineTo(m,g),v.stroke(),v.restore()},e.prototype.drawRect=function(e,t,n,a,i,r){var l=this.ctx;l.save(),l.translate(a[0],a[1]),l.rotate(i),l.beginPath(),l.lineWidth=o.MarkupViewer.isMobile?36:e.lineWidth+this.lineWidth,l.strokeStyle="rgba("+(2*r+2)+",10,10,1)",l.fillStyle="rgba("+(2*r+2)+",10,255,1)",l.rect(-.5*(n[0]-t[0]),-.5*(n[1]-t[1]),n[0]-t[0],n[1]-t[1]),l.closePath(),l.stroke(),l.restore()},e.prototype.drawCross=function(e,t,n,o,a){var i=this.ctx;i.save(),i.translate(n[0],n[1]),i.rotate(o),i.strokeStyle="rgba("+(2*a+2)+",30,30,1)",i.fillStyle="rgba("+(2*a+2)+",30,255,1)",i.beginPath(),i.moveTo(-.5*(t[0]-e[0]),-.5*(t[1]-e[1])),i.lineTo(.5*(t[0]-e[0]),.5*(t[1]-e[1])),i.moveTo(-.5*(t[0]-e[0]),.5*(t[1]-e[1])),i.lineTo(.5*(t[0]-e[0]),-.5*(t[1]-e[1])),i.stroke(),i.restore()},e.prototype.drawCloudRect=function(e,t,n,o,a){var i=this.ctx;i.moveTo(e,t),i.quadraticCurveTo(n[0],n[1],o[0],o[1])},e.prototype.drawEllips=function(e,t,n,o,a,i,r){var l=this.ctx;l.save(),l.strokeStyle="rgba("+(2*a+2)+",50,50,1)",l.fillStyle="rgba("+(2*a+2)+",50,255,1)",l.translate(n[0],n[1]),l.rotate(o),l.beginPath(),l.ellipse(0,0,i,r,0,0,2*Math.PI),l.closePath(),l.stroke(),l.restore()},e.prototype.drawPolyline=function(e,t,n,o,a){var i=this.ctx;i.strokeStyle="rgba("+(2*a+2)+",70,70,1)",i.moveTo(e[0]-n[0],e[1]-n[1]),i.lineTo(t[0]-n[0],t[1]-n[1]),i.stroke()},e.prototype.isEdge=function(e,t){var n=this.ctx.getImageData(e,t,1,1),o=n.data,a=o[0],i=o[1],r=o[2],l=o[3];return r==i&&i<100&&r%10==0&&a>=2&&255==l},e.prototype.hitTest=function(e,t){var n=this.ctx.getImageData(e,t,1,1),o=n.data,a=o[0],i=o[1],r=o[2],l=o[3];return a+i+r<3?-1:r==i&&i<100&&r%10==0&&a>=2&&255==l?(a-2)/2:255==r&&i>99?(a-2)/2:void 0},e.prototype.hitGrip=function(e,t){var n=this.ctx.getImageData(e,t,1,1),o=n.data,a=o[0],i=o[1],r=o[2];if(a+i+r+o[3]<3)return-1;if(255==r){if(100==i)return 9;if(255==i)return 10;if(i>100)return(i-110)/10}return-1},e}();n.MarkupVirtualPad=a,n.default=a},{"./MarkupViewer":17}],21:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.getCenter=function(e){var t=e.worldToClientPoint(this.drawPoints[0]),n=e.worldToClientPoint(this.drawPoints[1]);return[(t[0]+n[0])/2,(t[1]+n[1])/2]},e.prototype.setColor=function(e){e&&(this.highLight=e)},e.prototype.getColor=function(){return this.strokeStyle},e}();n.default=o},{}],22:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(){}return e.distance=function(e,t){var n=t.x-e.x,o=t.y-e.y;return Math.sqrt(n*n+o*o)},e.center=function(e,t){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}},e.centerByArr=function(e,t){return[(t[0]+e[0])/2,(t[1]+e[1])/2]},e.distanceByArr=function(e,t){var n=t[0]-e[0],o=t[1]-e[1];return Math.sqrt(n*n+o*o)},e.normalize=function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]);return[e[0]/t,e[1]/t]},e.isPointInBBox=function(e,t,n,o){var a=.5*o[0];if(e<n[0]-a||e>n[0]+a)return!1;var i=.5*o[1];return!(t<n[1]-i||t>n[1]+i)},e.rotateAround=function(e,t,n){var o=[0,0],a=Math.cos(n),i=Math.sin(n),r=e[0]-t[0],l=e[1]-t[1];return o[0]=r*a-l*i+t[0],o[1]=r*i+l*a+t[1],o},e}();n.default=o},{}],23:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MouseButtons=void 0;!function(e){e[e.CONTINUE=0]="CONTINUE",e[e.FINISHED=1]="FINISHED",e[e.LelftButton=1]="LelftButton",e[e.RightButton=2]="RightButton",e[e.MiddleButton=4]="MiddleButton",e[e.MouseMode=1]="MouseMode",e[e.TouchMode=2]="TouchMode"}(n.MouseButtons||(n.MouseButtons={}))},{}],24:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("../MathUtil"),i=e("../MarkupViewer"),r=e("../Markups"),l=function(e){function t(t,n,o,a,i,r){var l=e.call(this)||this;return l.rotation=a||0,l.close=r||!1,l.fillStyle=i,l.markupType="Polyline",l.drawPoints=t,l.strokeStyle=n,l.lineWidth=o,l.editPt=null,l.bNeedHitByBbox=!1,l}return o(t,e),t.prototype.draw=function(e,t,n,o){if(!(this.drawPoints.length<2)){var a=e.markupManager.getMarkupCenter(e,o);a||(a=[0,0]),t.save(),t.translate(a[0],a[1]),t.rotate(this.rotation),t.beginPath(),t.lineJoin="round",n.init(a,this.rotation),n.ctx.lineWidth=i.MarkupViewer.isMobile?36:this.lineWidth+n.lineWidth;for(var r=1,l=this.drawPoints.length;r<l;r++){var s=e.worldToClientPoint([this.drawPoints[r-1][0],this.drawPoints[r-1][1],this.drawPoints[r-1][2]]),d=e.worldToClientPoint([this.drawPoints[r][0],this.drawPoints[r][1],this.drawPoints[r][2]]);1==r&&t.moveTo(s[0]-a[0],s[1]-a[1]),t.lineTo(d[0]-a[0],d[1]-a[1]),n.drawPolyline(s,d,a,this.rotation,o)}this.close&&this.fillStyle&&t.fill(),t.stroke(),t.restore(),n.ctx.restore()}},t.prototype.shouldClose=function(e,t,n){if(this.drawPoints.length<3)return!1;var o=e.worldToClientPoint([this.drawPoints[0][0],this.drawPoints[0][1],this.drawPoints[0][2]]);return a.default.distanceByArr(o,[t,n])<5?(this.close=!0,!0):(this.close=!1,!1)},t.prototype.setPoints=function(e){this.drawPoints=e},t.prototype.addPoint=function(e){this.drawPoints.push(e)},t.prototype.getStartPoint=function(){return this.drawPoints[0]},t.prototype.popPoint=function(){this.drawPoints.pop()},t.prototype.isEmpty=function(){return 0==this.drawPoints.length},t.prototype.getPoints=function(){return this.drawPoints},t.prototype.getGrips=function(e,t){if(void 0==t)return this.drawPoints;var n=e.markupManager.getMarkupBbox(e,t),o=[n[0],n[1]],a=[n[2],n[3]],i=[(o[0]+a[0])/2,(o[1]+a[1])/2],r=[];return r.push(o[0],o[1]),r.push(o[0],i[1]),r.push(o[0],a[1]),r.push(i[0],a[1]),r.push(a[0],a[1]),r.push(a[0],i[1]),r.push(a[0],o[1]),r.push(i[0],o[1]),r},t}(r.default);n.default=l},{"../MarkupViewer":17,"../Markups":21,"../MathUtil":22}],25:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./PolylineMarkup"),i=e("../MarkupTool"),r=e("../Mouse"),l=r.MouseButtons,s=function(e){function t(t){var n=e.call(this)||this;return n.markupManager=t,n.bFirstCloudMarkup=!0,n.uncertainty=!1,n}return o(t,e),t.prototype.begin=function(e,t,n,o){if(this.bFirstCloudMarkup){if(e.markupManager.hitTest(e,t,n)>-1)return;var i=e.markupManager.getColor(),r=e.markupManager.getLineWidth(),l=e.markupManager.getFillStyleState()?e.markupManager.getFillColor():void 0;this.markup=new a.default([],i,r,0,l),this.bFirstCloudMarkup=!1}if(this.markup.shouldClose(e,t,n))this.addMarkup(e,this.markup),this.markup=null,this.redraw(e),this.bFirstCloudMarkup=!0;else{var s=e.clientToWorldPoint([t,n]);this.markup.popPoint(),this.markup.addPoint(s)}this.uncertainty=!1},t.prototype.onEditing=function(e,t,n,o){if(!this.bFirstCloudMarkup){var a=void 0;a=this.markup.shouldClose(e,t,n)?this.markup.getStartPoint():e.clientToWorldPoint([t,n]),this.uncertainty&&this.markup.drawPoints.length>1?this.markup.popPoint():this.uncertainty=!0,this.markup.addPoint(a),this.redraw(e)}},t.prototype.onMouseMove=function(e,t,n,o){this.onEditing(e,t,n,o)},t.prototype.end=function(e,t,n,o){if(this.bFirstCloudMarkup)return l.FINISHED},t.prototype.onMouseRightClick=function(e,t){this.bFirstCloudMarkup||(this.markup.popPoint(),this.markup.drawPoints.length>1&&this.addMarkup(e,this.markup),this.markup=null,this.redraw(e),this.bFirstCloudMarkup=!0)},t.prototype.onDoubleClick=function(e,t){if(!this.bFirstCloudMarkup){this.markup.popPoint();this.markup.drawPoints.length>1&&this.addMarkup(e,this.markup),this.markup=null,this.redraw(e),this.bFirstCloudMarkup=!0}},t}(i.default);n.default=s},{"../MarkupTool":16,"../Mouse":23,"./PolylineMarkup":24}],26:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./../Markups"),i=e("../MarkupViewer"),r=function(e){function t(t,n,o,a,i){var r=e.call(this)||this;return r.rotation=a||0,r.markupType="Rectangle",r.drawPoints=t,r.strokeStyle=n,r.lineWidth=o,r.fillStyle=i,r.bNeedHitByBbox=!0,r}return o(t,e),t.prototype.draw=function(e,t,n,o){if(!(this.drawPoints.length<2)){var a=e.worldToClientPoint([this.drawPoints[0][0],this.drawPoints[0][1],this.drawPoints[0][2]]),r=e.worldToClientPoint([this.drawPoints[1][0],this.drawPoints[1][1],this.drawPoints[1][2]]),l=this.getCenter(e);t.save(),t.translate(l[0],l[1]),t.rotate(this.rotation),t.beginPath(),t.rect(-.5*(r[0]-a[0]),-.5*(r[1]-a[1]),r[0]-a[0],r[1]-a[1]),t.restore(),t.closePath(),this.fillStyle&&t.fill(),t.stroke(),n.ctx.lineWidth=i.MarkupViewer.isMobile?36:this.lineWidth+n.lineWidth,n.ctx.fillStyle=this.fillStyle,n.drawRect(this,a,r,l,this.rotation,o)}},t.prototype.setPoints=function(e){this.drawPoints=e},t.prototype.getPoints=function(){return this.drawPoints},t.prototype.getGrips=function(e){var t=e.worldToClientPoint(this.drawPoints[0]),n=e.worldToClientPoint(this.drawPoints[1]),o=[(t[0]+n[0])/2,(t[1]+n[1])/2],a=[];return a.push(t[0],t[1]),a.push(t[0],o[1]),a.push(t[0],n[1]),a.push(o[0],n[1]),a.push(n[0],n[1]),a.push(n[0],o[1]),a.push(n[0],t[1]),a.push(o[0],t[1]),a},t.prototype.getRotateGrips=function(e){var t=e.worldToClientPoint(this.drawPoints[0]),n=e.worldToClientPoint(this.drawPoints[1]);return[[(t[0]+n[0])/2,(t[1]+n[1])/2][0],t[1]-20]},t}(a.default);n.default=r},{"../MarkupViewer":17,"./../Markups":21}],27:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./../MarkupTool"),i=e("./RectMarkup"),r=e("./../Mouse"),l=r.MouseButtons,s=function(e){function t(t){var n=e.call(this)||this;return n.markupManager=t,n}return o(t,e),t.prototype.begin=function(e,t,n,o){this.startX=t,this.startY=n;var a=e.markupManager.getColor(),r=e.markupManager.getLineWidth(),l=e.markupManager.getFillStyleState()?e.markupManager.getFillColor():void 0;this.markup=new i.default([],a,r,0,l)},t.prototype.onEditing=function(e,t,n,o){var a=e.clientToWorldPoint([this.startX,this.startY]),i=e.clientToWorldPoint([t,n]);this.markup.setPoints([a,i]),this.redraw(e)},t.prototype.end=function(e,t,n,o){return this.startX==t&&this.startY==n?(console.log("Ignore single point."),l.FINISHED):(this.addMarkup(e,this.markup),this.markup=null,l.FINISHED)},t}(a.default);n.default=s},{"./../MarkupTool":16,"./../Mouse":23,"./RectMarkup":26}],28:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./../Markups"),i=function(e){function t(t,n,o,a,i,r,l,s,d){var c=e.call(this)||this;c.rotation=r||0,c.textAreaId=l||null,c.center=s||null,c.markupType="Text",c.drawPoints=d?t:[t],c.pureText=n,c.userText=n,c.strokeStyle=o,c.fontSize=a,c.fontFamily=i;var u=document.createElement("canvas");return c.virtualCtx=u.getContext("2d"),c.bNeedHitByBbox=!1,c}return o(t,e),t.prototype.draw=function(e,t,n,o){var a=e.worldToClientPoint(this.drawPoints[0]),i=this.getTextBbox(e),r=[(i[2]+i[0])/2,(i[3]+i[1])/2]
;this.center&&(r=e.worldToClientPoint(this.center)),t.save(),t.translate(r[0],r[1]),t.rotate(this.rotation),t.beginPath(),n.init(r,this.rotation),t.fillStyle=t.strokeStyle,t.font=this.fontSize+"px "+this.fontFamily,t.zIndex=120,n.ctx.font="bold "+this.fontSize+"px "+this.fontFamily,n.ctx.strokeStyle="rgba("+(2*o+2)+",80,80,1)",n.ctx.fillStyle="rgba("+(2*o+2)+",80,80,1)";for(var l=this.userText.split(/\n/),s=0;s<l.length;s++){t.fillText(l[s],a[0]-r[0],a[1]-r[1]+(s+1)*this.fontSize),n.ctx.fillText(l[s],a[0]-r[0],a[1]-r[1]+(s+1)*this.fontSize);var d=l[s].replace(/[a-z]/g,"aa").replace(/[^\u0000-\u00ff]/g,"aaaa").replace(/[A-Z]/g,"aaa").replace(/[0-9]/g,"aa").length;n.ctx.fillRect(a[0]-r[0],a[1]-r[1]+s*this.fontSize,d*this.fontSize*4/14,20)}t.restore(),n.ctx.restore()},t.prototype.setPoints=function(e){this.drawPoints=e},t.prototype.getPoints=function(){return this.drawPoints},t.prototype.getId=function(){return this.textAreaId},t.prototype.getUserText=function(){return this.userText},t.prototype.getPureText=function(){return this.pureText},t.prototype.setUserText=function(e){this.userText=e},t.prototype.setPureText=function(e){this.pureText=e},t.prototype.show=function(e){var t=e.worldToClientPoint([this.drawPoints[0][0],this.drawPoints[0][1],this.drawPoints[0][2]]),n=document.getElementById(this.textAreaId),o=e.wrapDom,a=o.getBoundingClientRect();n.style.left=t[0]+a.left+"px",n.style.top=t[1]+a.top+"px",n.style.fontFamily=this.fontFamily,n.style.fontSize=this.fontSize,n.style.border="4px",n.style.resize="none",n.style.zIndex=100,n.style.display="block",n.value=this.userText},t.prototype.resizeText=function(e){this.virtualCtx.font=this.fontSize+"px "+this.fontFamily;for(var t=this.pureText||this.userText,n=t.split(/\n/),o=e[0],a=e[1],i=(this.fontSize,0);i<n.length;i++){for(var r="",l=n[i].slice(),s="",d=0,c=0;c<l.length;c++){var u=this.virtualCtx.measureText(l[c]).width;d+=u,r+=l[c],d>o&&r.length>1?(s+="\n"+l[c],d=u,r=l[c]):d==o?(n[i]=l.slice(0,c+1)+"\n"+l.slice(c+1),s+=l[c]+"\n",d=0,r=""):s+=l[c]}n[i]=s}this.userText=n.join("\n")},t.prototype.resizeTextarea=function(){var e=document.getElementById(this.textAreaId);e.value=this.userText;var t=this.userText.split(/\n/),n=0;e.rows=t.length;for(var o=0;o<t.length;o++){var a=t[o].replace(/[^\u0000-\u00ff]/g,"aa").replace(/[A-Z]/g,"aa").length;a>n&&(n=a)}e.cols=n},t.prototype.getTextBbox=function(e){var t,n=this.getTextSize(),o=e.worldToClientPoint(this.drawPoints[0]);return t=this.drawPoints[1]?e.worldToClientPoint(this.drawPoints[1]):[o[0]+n[0],o[1]+n[1]],o.concat(t)},t.prototype.getTextSize=function(){var e=0,t=0;this.virtualCtx.font=this.fontSize+"px "+this.fontFamily;for(var n,o=this.userText.split(/\n/),a=0;a<o.length;a++)n=this.virtualCtx.measureText(o[a]),n.width>e&&(e=n.width);return t=o.length*this.fontSize,[e,t]},t.prototype.getEndPt=function(e){var t=this.getTextBbox(e);return[t[2],t[3]]},t.prototype.getGrips=function(e){var t=e.worldToClientPoint(this.drawPoints[0]);if(this.drawPoints[1]){a=e.worldToClientPoint(this.drawPoints[1]);var n=[(t[0]+a[0])/2,(t[1]+a[1])/2]}else var o=this.getTextBbox(e),n=[(o[2]+o[0])/2,(o[3]+o[1])/2],a=[o[2],o[3]];var i=[];return i.push(t[0],t[1]),i.push(t[0],n[1]),i.push(t[0],a[1]),i.push(n[0],a[1]),i.push(a[0],a[1]),i.push(a[0],n[1]),i.push(a[0],t[1]),i.push(n[0],t[1]),i},t}(a.default);n.default=i},{"./../Markups":21}],29:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./TextMarkup"),i=e("./../MarkupTool"),r=e("./../Mouse"),l=r.MouseButtons,s=function(e){function t(t,n){var o=e.call(this)||this;return o.editorMode=-1,o.rotation=n,o.worldPoint=[],o.markupManager=t,o}return o(t,e),t.prototype.begin=function(e,n,o,a){this.startX=n,this.startY=o,this.textAreaId="";var i=!0;void 0==this.userText&&(i=this.initDom(e)),i&&""==t.lastTextareaId&&(this.createDiv(t.divId),this.insertTextArea2Dom(e),this.addKeyDownListener(e),this.addInputListener(e))},t.prototype.onEditing=function(e,t,n,o){},t.prototype.end=function(e,t,n,o){return l.FINISHED},t.prototype.onExit=function(e){""!=t.lastTextareaId&&(this.removeTextAreaInDom(t.lastTextareaId),t.lastTextareaId="")},t.prototype.initDom=function(e){if(""!=t.lastTextareaId){var n=document.getElementById(t.lastTextareaId),o=n.value.trim();if(""==o)this.removeTextAreaInDom(t.lastTextareaId);else{var i=e.wrapDom,r=i.getBoundingClientRect(),l=parseInt(n.style.left.split("px")[0]),s=parseInt(n.style.top.split("px")[0]),d=[l-r.left,s-r.top],c=e.clientToWorldPoint(d),u=n.style.color,p=e.markupManager.getFontSize(),f=n.style.fontFamily,h=new a.default(c,o,u,p,f,this.rotation||0,t.lastTextareaId);this.size&&(h.setPureText(o),this.setPureText(o),h.resizeText(this.size)),this.rotation=0,this.hideTextArea(t.lastTextareaId),this.addMarkup(e,h),h=null,this.redraw(e)}return t.lastTextareaId="",!1}return!0},t.prototype.createDiv=function(e){if(null==document.getElementById(e)){console.log("Create div in dom.");var n=document.createElement("div");n.addEventListener("mousedown",function(){event.stopImmediatePropagation()}),n.addEventListener("mouseup",function(){event.stopImmediatePropagation()}),n.addEventListener("mousemove",function(){event.stopImmediatePropagation()}),n.setAttribute("id",t.divId),n.style.position="absolute",n.style.left="0",n.style.top="0",this.markupManager.viewer.wrapDom.appendChild(n);var o=document.createElement("span");o.id="box",o.style.visibility="hidden",n.appendChild(o);var a=document.createElement("span");o.id="boxEdit",o.style.visibility="hidden",o.style.wordBreak="break-all",o.style.display="inline-block",n.appendChild(a)}},t.prototype.setEditBox=function(e){this.size=e},t.prototype.hideTextArea=function(e){document.getElementById(e).style.display="none"},t.prototype.showTextArea=function(e){document.getElementById(e).style.display="block"},t.prototype.setUserText=function(e){this.userText=e},t.prototype.setPureText=function(e){this.pureText=e},t.prototype.addKeyDownListener=function(e){var t=this,n=document.getElementById(this.textAreaId);n&&n.addEventListener("keydown",function(n){return t.keyDownFunction(e,n)},!0)},t.prototype.addInputListener=function(e){var t=this,n=document.getElementById(this.textAreaId);n&&(n.addEventListener("input",function(o){t.resize(n,e)}),n.addEventListener("blur",function(n){t.onExit(e)}))},t.prototype.resize=function(e,n){var o=e.value.split(/\n/),a=document.querySelectorAll("#"+t.divId+" span")[0];a.innerText=e.value,a.style.fontSize=n.markupManager.getFontSize()+"px",e.style.width=a.offsetWidth+10+"px",e.rows=o.length},t.prototype.keyDownFunction=function(e,t){var n=document.getElementById(this.textAreaId);13==t.keyCode&&(n.rows=n.rows+1,console.log("Key enter pressed."))},t.prototype.addMouseDownListener=function(){var e=document.getElementById(this.textAreaId);e&&e.addEventListener("click",function(e){console.log("Mouse click textarea now.")})},t.prototype.createTextArea=function(e){var t=[this.startX,this.startY];this.worldPoint=e.clientToWorldPoint(t);var n=document.createElement("textArea");n.setAttribute("id",this.textAreaId),n.setAttribute("maxlength",999),n.value=void 0==this.userText?"":this.userText,n.style.color=e.markupManager.getColor(),n.style.position="fixed",n.style.lineHeight="100%";this.editorMode;n.style.width="10px",n.style.paddingLeft="6px",n.style.overflow="hidden",void 0!=this.userText?this.resize(n,e):n.rows="1";var o=e.wrapDom,a=o.getBoundingClientRect();return n.style.left=t[0]+a.left+"px",n.style.top=t[1]+a.top+"px",n.style.fontFamily=e.markupManager.getFontFamily(),n.style.fontSize=e.markupManager.getFontSize()+"px",n.style.border="1px solid red",n.style.background="transparent",n.style.outline="none",n.style.resize="none",n.style.zIndex=100,n.style.display="block",n},t.prototype.insertTextArea2Dom=function(e){var n=document.getElementById(t.divId),o=n.childElementCount+1;this.textAreaId="textArea_"+o;var a=this.createTextArea(e);this.textArea=a,n.appendChild(a),a.focus(),t.lastTextareaId=this.textAreaId},t.prototype.reposition=function(e){var t=e.worldToClientPoint(this.worldPoint),n=e.wrapDom.getBoundingClientRect();this.textArea.style.left=t[0]+n.left+"px",this.textArea.style.top=t[1]+n.top+"px"},t.prototype.removeTextAreaInDom=function(e){var n=document.getElementById(t.divId),o=document.getElementById(e);try{n.removeChild(o)}catch(e){}},t.lastTextareaId="",t.divId="bf-drawing-textEditor",t}(i.default);n.default=s},{"./../MarkupTool":16,"./../Mouse":23,"./TextMarkup":28}]},{},[11]),function(){function e(t,n,o){function a(r,l){if(!n[r]){if(!t[r]){var s="function"==typeof require&&require;if(!l&&s)return s(r,!0);if(i)return i(r,!0);var d=new Error("Cannot find module '"+r+"'");throw d.code="MODULE_NOT_FOUND",d}var c=n[r]={exports:{}};t[r][0].call(c.exports,function(e){return a(t[r][1][e]||e)},c,c.exports,e,t,n,o)}return n[r].exports}for(var i="function"==typeof require&&require,r=0;r<o.length;r++)a(o[r]);return a}return e}()({1:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.DomUtil2D=void 0;var o=function(){function e(){}return e.create=function(e,t,n){var o=document.createElement(e);return o.id=t||"",o.style.position="absolute",o.style.width="100%",o.style.top=0,o.style.bottom=0,n&&n.appendChild(o),o},e.remove=function(e){var t=e.parentNode;t&&t.removeChild(e)},e.setPosition=function(e,t){e.position=t,e.style.left=t.x+"px",e.style.top=t.y+"px"},e.setOpacity=function(t,n){"opacity"in t.style?t.style.opacity=n:"filter"in t.style&&e._setOpacityIE(t,n)},e._setOpacityIE=function(e,t){var n=!1,o="DXImageTransform.Microsoft.Alpha";try{n=e.filters.item(o)}catch(e){if(1===t)return}t=Math.round(100*t),n?(n.Enabled=100!==t,n.Opacity=t):e.style.filter+=" progid:"+o+"(opacity="+t+")"},e.splitStr=function(e){return e.trim().split(/\s+/g)},e.getContainerOffsetToClient=function(e){var t,n=function(e){for(var t=0,n=0;e;)t+=e.offsetTop,n+=e.offsetLeft,e=e.offsetParent;var o=document.body,a=document.documentElement,i=window.pageYOffset||a.scrollTop||o.scrollTop,r=window.pageXOffset||a.scrollLeft||o.scrollLeft;return t-=i,n-=r,{top:t,left:n}},o=function(e){var t=e.getBoundingClientRect(),n=document.body,o=document.documentElement,a=o.clientTop||n.clientTop,i=o.clientLeft||n.clientLeft,r=t.top-a,l=t.left-i;return{top:Math.round(r),left:Math.round(l)}};if(e!=document){var a=function(e){return e.getBoundingClientRect?o(e):n(e)}(e);t={width:e.offsetWidth,height:e.offsetHeight,left:a.left,top:a.top}}else t={width:window.innerWidth,height:window.innerHeight,left:0,top:0};return t},e.setClassName=function(e,t){var n=document.getElementById(e);n&&(n.className=t)},e.addClassName=function(e,t){var n,o,a,i,r,l=/\s+/,s=document.getElementById(e);if(s&&(o=s,t&&"string"==typeof t&&(n=t.split(l),1===o.nodeType)))if(o.className||1!==n.length){for(a=" "+o.className+" ",i=0,r=n.length;i<r;++i)a.indexOf(" "+n[i]+" ")<0&&(a+=n[0]+" ");o.className=a.trim()}else o.className=t},e.removeClassName=function(e,t){var n,o,a,i,r,l=/\s+/,s=document.getElementById(e);if(s&&(a=s,t&&"string"==typeof t&&(n=(t||"").split(l),1===a.nodeType&&a.className))){for(o=(" "+a.className+" ").replace("O"," "),i=0,r=n.length;i<r;i++)for(;o.indexOf(" "+n[i]+" ")>=0;)o=o.replace(" "+n[i]+" "," ");a.className=t?o.trim():""}},e.showOrHideElement=function(e,t){var n=document.getElementById(e);n&&(n.style.display=t?"":"none")},e.prototype.getStyleString=function(e){var t=[];for(var n in e){var o=e[n];t.push(n),t.push(":"),t.push(o),t.push("; ")}return t.join("")},e.cloneStyle=function(e){var t={};for(var n in e)t[n]=e[n];return t},e.removeStyleAttribute=function(e,t){Array.isArray(t)||(t=[t]),t.forEach(function(t){t in e&&delete e[t]})},e.trimRight=function(e){if(0===e.length)return"";for(var t=e.length-1,n=t;n>=0;--n)if(" "!==e.charAt(n)){t=n;break}return e.substr(0,t+1)},e.trimLeft=function(e){if(0===e.length)return"";for(var t=0,n=0;n<e.length;++n)if(" "!==e.charAt(n)){t=n;break}return e.substr(t)},e.matchesSelector=function(e,t){if(e.matches)return e.matches(t);if(e.matchesSelector)return e.matchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.mozMatchesSelector)return e.mozMatchesSelector(t);if(e.oMatchesSelector)return e.oMatchesSelector(t);if(e.querySelectorAll){for(var n=(e.document||e.ownerDocument).querySelectorAll(t),o=0;n[o]&&n[o]!==e;)o++;return!!n[o]}return!1},e.toTranslate3d=function(e,t){return"translate3d("+e+"px,"+t+"px,0)"},e.setCursorStyle=function(e,t){var n;switch(t){case"n":case"s":n="ns-resize";break;case"w":case"e":n="ew-resize";break;case"ne":case"sw":n="nesw-resize";break;case"nw":case"se":n="nwse-resize"}e.style.cursor=n},e}();n.DomUtil2D=o},{}],2:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Shape2D=void 0;var o=function(){function e(){}return e.createSvgElement=function(e){var t=document.createElementNS("http://www.w3.org/2000/svg",e);return t.setAttribute("pointer-events","inherit"),t},e.getRGBAString=function(e,t){return t<=0?"none":["rgba("+parseInt("0x"+e.substr(1,2)),",",parseInt("0x"+e.substr(3,2)),",",parseInt("0x"+e.substr(5,2)),",",t,")"].join("")},e.makeFlag=function(){var e=this.createSvgElement("path");return e.setAttribute("d","M0 0 L0 -20 L15 -13 L4 -6.87 L4 0Z"),e},e.makeBubble=function(){var e=this.createSvgElement("path");return e.setAttribute("d","m0.0035,-19.88544c-3.838253,0 -6.95,2.581968 -6.95,5.766754c0,3.185555 6.95,13.933247 6.95,13.933247s6.95,-10.747692 6.95,-13.933247c0,-3.184786 -3.11082,-5.766754 -6.95,-5.766754z"),e},e.makeCommon=function(e,t){var n=this.createSvgElement("image");return n.href.baseVal=e,n.setAttribute("height",t.height.toString()+"px"),n.setAttribute("width",t.width.toString()+"px"),n},e}();n.Shape2D=o},{}],3:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),e("./View3dAdapter"),e("./View2dAdapter"),e("./MarkerEditor")},{"./MarkerEditor":7,"./View2dAdapter":9,"./View3dAdapter":10}],4:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Marker=void 0;var o=e("../../Common/Utils/DomUtil2D"),a=function(){function e(t,n){this.id=t,this.editor=n,this.position=new window.THREE.Vector3,this.boundingBox=new window.THREE.Box3,this.shape=null,this.style=e.getDefaultStyle(),this.selected=!1,this.highlighted=!1,this.highlightColor="#000088",this.isDisableInteractions=!1,this.ratioW=1,this.ratioH=1,this.keys={BACKSPACE:8,ALT:18,ESC:27,LEFT:37,UP:38,RIGHT:39,BOTTOM:40,DELETE:46,ZERO:48,A:65,D:68,E:69,Q:81,S:83,W:87,PLUS:187,SUB:189},this.onMouseDownBinded=this.onMouseDown.bind(this),this.onKeyUpBinded=this.onKeyUp.bind(this)}return e.prototype.addDomEventListeners=function(){this.shape.addEventListener("mousedown",this.onMouseDownBinded,!0),this.shape.addEventListener("touchstart",this.onMouseDownBinded,!0),window.addEventListener("keyup",this.onKeyUpBinded)},e.prototype.removeDomEventListeners=function(){this.shape.removeEventListener("mousedown",this.onMouseDownBinded,!0),this.shape.removeEventListener("touchstart",this.onMouseDownBinded,!0),window.removeEventListener("keyup",this.onKeyUpBinded)},e.prototype.onMouseDown=function(e){e.preventDefault(),e.stopPropagation(),this.select(e.button)},e.prototype.onKeyUp=function(e){switch(e.keyCode){case this.keys.DELETE:this.editor.deselectMarker(),this.delete()}},e.prototype.createShape=function(){},e.prototype.destroy=function(){this.removeDomEventListeners(),this.deselect(),this.setParent(null)},e.prototype.set=function(e,t,n,a){this.userId=e,this.position.set(t.x,t.y,t.z),this.boundingBox=n&&n.clone(),a&&(this.style=o.DomUtil2D.cloneStyle(a)),this.update()},e.prototype.setRatio=function(e,t){this.ratioW=e,this.ratioH=t},e.prototype.setParent=function(e){var t=this.shape;t&&(t.parentNode&&t.parentNode.removeChild(t),e&&e.appendChild(t))},e.prototype.setStyle=function(e){this.style=o.DomUtil2D.cloneStyle(e),this.update()},e.prototype.select=function(e){this.selected||(this.selected=!0,this.highlight(!0)),this.editor.selectMarker(this,e)},e.prototype.deselect=function(){this.highlight(!1),this.selected=!1},e.prototype.highlight=function(e){this.isDisableInteractions||(this.highlighted=e,this.update())},e.prototype.disableInteractions=function(e){this.isDisableInteractions=e},e.prototype.delete=function(){this.editor.deleteMarker(this)},e.prototype.getClientPosition=function(){return this.editor.getAdapter().worldToClient(this.position)},e.prototype.getBoundingBox=function(){return this.boundingBox},e.prototype.toNewObject=function(){return{id:this.id,userId:this.userId,shapeType:this.shapeType,cx:this.cx,cy:this.cy,position:this.position?this.position.clone():null,boundingBox:this.boundingBox?this.boundingBox.clone():null}},e.prototype.show=function(){this.shape.style.display="block"},e.prototype.hide=function(){this.shape.style.display="none"},e.prototype.update=function(){var e=this.style["stroke-width"],t=this.highlighted?this.highlightColor:this.style["stroke-color"],n=this.style["stroke-opacity"],o=this.style["fill-color"],a=this.style["fill-opacity"],i=this.getClientPosition();if(!i)return void(this.shape.style.display="none");var r=i.x,l=i.y;if(2==this.shapeType)var s=["translate(",r-this.pictureSize.width*this.ratioW*.5,",",l-this.pictureSize.height*this.ratioH*.5,") "].join("");else var s=["translate(",r,",",l,") "].join("");this.cx=r,this.cy=l,this.shape.setAttribute("transform",s),this.shape.setAttribute("stroke-width",e),this.shape.setAttribute("stroke",t),this.shape.setAttribute("stroke-opacity",n),this.shape.setAttribute("fill",o),this.shape.setAttribute("fill-opacity",a)},e.shapeTypes={BUBBLE:0,FLAG:1,COMMON:2},e.getDefaultStyle=function(){var e={};return e["stroke-width"]=2,e["stroke-color"]="#fffaff",e["stroke-opacity"]=1,e["fill-color"]="#ff2129",e["fill-opacity"]=1,e},e}();n.Marker=a},{"../../Common/Utils/DomUtil2D":1}],5:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0}),n.MarkerBubble=void 0;var a=e("./Marker"),i=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.shapeType=a.Marker.shapeTypes.BUBBLE,o.createShape(),o.addDomEventListeners(),o}return o(t,e),t}(a.Marker);n.MarkerBubble=i},{"./Marker":4}],6:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0}),n.MarkerCommon=void 0;var a=e("./Marker"),i=e("./../../Common/Utils/Shape2D"),r=function(e){function t(t,n,o,i){var r=e.call(this,t,n)||this;return r.shapeType=a.Marker.shapeTypes.COMMON,r.pictureSize=i||{width:20,height:20},r.createShape(o),r.addDomEventListeners(),r}return o(t,e),t.prototype.createShape=function(e){this.shape=i.Shape2D.makeCommon(e,this.pictureSize)},t.prototype.reset=function(){var e=this.pictureSize.width*this.ratioW,t=this.pictureSize.height*this.ratioH;this.shape.setAttribute("width",e.toString()+"px"),this.shape.setAttribute("height",t.toString()+"px")},t}(a.Marker);n.MarkerCommon=r},{"./../../Common/Utils/Shape2D":2,"./Marker":4}],7:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MarkerEditor=void 0;var o=e("./MarkerBubble"),a=e("./MarkerCommon"),i=e("./MarkerFlag"),r=e("./../../Common/Utils/Shape2D"),l=e("./Marker"),s=function(){function e(e){this.disableInteractions=function(e){this.isDisableInteractions=e},this.adapter=e,this.markers=[],this.mapGroupMarkers={},this.groups=null,this.selectedMarker=null,this.flagColors={red:"#ff2129",green:"#85af03",yellow:"#fe9829"},this.bubbleColors={red:"#f92a24",green:"#86b507",gray:"#ff9326"},this.nextMarkerId=0,this.initialized=!1,this.markerClickCallback=null,this.markerRightClickCallback=null,this.markersRatioH=1,this.markersRatioW=1}return e.prototype.getAdapter=function(){return this.adapter},e.prototype.updateDomContainer=function(){var e=this.adapter.getDomContainer();this.adapter.setDomContainer(e)},e.prototype.getMarkers=function(){return this.markers},e.prototype.getMarkersByGroupName=function(e){return this.mapGroupMarkers.hasOwnProperty(e)?this.mapGroupMarkers[e]:[]},e.prototype.addMarkerToGroup=function(e,t){this.mapGroupMarkers.hasOwnProperty(t)||(this.mapGroupMarkers[t]=[]),this.mapGroupMarkers[t].push(e)},e.prototype.setMarkerGroups=function(e){this.groups=e},e.prototype.removeMarkerInGroup=function(e,t){for(var n=this.mapGroupMarkers[t],o=0,a=n.length;o<a;o++)if(n[o].userId==e)return n.splice(o,1),void this.updateByGroup()},e.prototype.removeMarker=function(e){for(var t=this.markers,n=0,o=t.length;n<o;n++)if(t[n].userId==e)return t[n].destroy(),void t.splice(n,1)},e.prototype.clearMarkers=function(){this.unloadMarkers(!0),this.markers=[],this.mapGroupMarkers={}},e.prototype.setVisible=function(e,t){var n=this.mapGroupMarkers;for(var o in n){var a=n[o];if(a instanceof Array){var i=a.getObjectByAttribute("id",e);i&&(!0===t?i.show():i.hide())}}},e.prototype.updateByGroup=function(e){var t=e||this.groupName;this.unloadMarkers();var n=this.mapGroupMarkers[t];if(n instanceof Array)for(var o=0,a=n.length;o<a;o++)n[o]&&n[o].setParent(this.svgGroup)},e.prototype.resize=function(e){var t=this.adapter.getInitialDomSize(),n=e.width/t.width,o=e.height/t.height;this.markersRatioH=o,this.markersRatioW=n;var a=this.mapGroupMarkers[this.groupName];if(a instanceof Array){for(var i=0,r=a.length;i<r;i++){var l=a[i];l.setRatio(n,o),l.reset(),l.update()}e.width==t.width&&e.height==t.height||(t=e),this.svg.setAttribute("width",e.width+""),this.svg.setAttribute("height",e.height+"")}},e.prototype.setGroupName=function(e){this.groupName=e},e.prototype.updateGroupName=function(){var e=this.adapter.getMinimap();e&&(this.groupName=e.getFloorPlaneName())},e.prototype.onResize=function(){if(this.svg){var e=this.adapter.getDomContainerBounds();this.svg.setAttribute("width",e.width+""),this.svg.setAttribute("height",e.height+""),this.updateMarkers()}},e.prototype.init=function(){if(!this.svg){var e=this.adapter.getDomContainerBounds(),t=e.width,n=e.height;this.svg=r.Shape2D.createSvgElement("svg"),this.svg.style.position="absolute",this.svg.style.display="block",this.svg.style.position="absolute",this.svg.style.display="block",this.svg.style.left="0",this.svg.style.top="0",this.svg.setAttribute("width",t+""),this.svg.setAttribute("height",n+"");this.adapter.getDomContainer().appendChild(this.svg),this.svgGroup=r.Shape2D.createSvgElement("g"),this.svg.insertBefore(this.svgGroup,this.svg.firstChild)}this.initialized=!0},e.prototype.uninit=function(){this.initialized=!1,this.svg&&(this.unloadMarkers(),this.svgGroup&&this.svgGroup.parentNode&&this.svgGroup.parentNode.removeChild(this.svgGroup),this.svg.parentNode&&this.svg.parentNode.removeChild(this.svg),this.svgGroup=null,this.svg=null,this.markerClickCallback=null,this.markerRightClickCallback=null)},e.prototype.isInitialized=function(){return this.initialized},e.prototype.generateMarkerId=function(){return++this.nextMarkerId,this.nextMarkerId.toString(10)},e.prototype.clear=function(e){var t=this.markers;if(1==e)for(;t.length;){var n=t[0];this.deleteMarker(n)}var o=this.svgGroup;if(o&&o.childNodes.length>0)for(;o.childNodes.length;)o.removeChild(o.childNodes[0])},e.prototype.addMarker=function(e){if("VIEW3D"==this.adapter.getName()&&e.setParent(this.svgGroup),this.markers.push(e),this.groups)for(var t=0,n=this.groups.length;t<n;t++)this.addMarkerToGroup(e,this.groups[t]);this.groupName&&this.updateByGroup(this.groupName)},e.prototype.deleteMarker=function(e){if(e){this.removeMarker(e.userId);var t=this.mapGroupMarkers;for(var n in t)this.removeMarkerInGroup(e.userId,n);t&&this.updateByGroup()}},e.prototype.selectMarker=function(e,t){if(!0===this.isDisableInteractions)return this.markerClickCallback&&0==t&&this.markerClickCallback(e.toNewObject()),void(this.markerRightClickCallback&&2==t&&this.markerRightClickCallback(e.toNewObject()));this.selectedMarker!==e?(this.deselectMarker(),this.selectedMarker=e):this.deselectMarker(),this.markerClickCallback&&(this.selectedMarker?this.markerClickCallback(this.selectedMarker.toNewObject()):this.markerClickCallback(null))},e.prototype.deselectMarker=function(){this.selectedMarker&&(this.selectedMarker.deselect(),this.selectedMarker=null)},e.prototype.enableSVGPaint=function(e){e?this.svg&&this.svg.setAttribute("pointer-events","painted"):this.svg&&this.svg.setAttribute("pointer-events","none")},e.prototype.getMarkerColor=function(e,t){var n=this.bubbleColors.red;switch(e<0&&e>1&&(e=0),t>2&&(t-=3),t<0&&t>2&&(t=0),t){case 0:n=0===e?this.bubbleColors.red:this.flagColors.red;break;case 1:n=0===e?this.bubbleColors.green:this.flagColors.green;break;case 2:n=0===e?this.bubbleColors.gray:this.flagColors.yellow}return n},e.prototype.createMarkerByIntersect=function(e,t,n,o){var a=e.id||this.generateMarkerId(),i=e.userId,r=e.worldPosition||e.object.point,l=e.worldBoundingBox||e.object&&e.object.boundingBox,s={size:o,id:a,userId:i,position:r,boundingBox:l,shapeType:t,state:n};this.createMarker(s)},e.prototype.createMarker=function(e){if(e){var t=l.Marker.getDefaultStyle();t["fill-color"]=this.getMarkerColor(e.shapeType,e.state);var n,r=e.id||this.generateMarkerId(),s=l.Marker.shapeTypes;switch(e.shapeType){case s.BUBBLE:n=new o.MarkerBubble(r,this);break;case s.COMMON:n=new a.MarkerCommon(r,this,e.state,e.size),n.setRatio(this.markersRatioW,this.markersRatioH),n.reset();break;case s.FLAG:default:n=new i.MarkerFlag(r,this)}this.isDisableInteractions&&n.disableInteractions(!0),n.set(e.userId,e.position,e.boundingBox,t),this.addMarker(n)}},e.prototype.getMarkersBoundingBox=function(){if(this.markers.length<1)return null;for(var e=new window.THREE.Box3,t=0,n=this.markers.length;t<n;t++){var o=this.markers[t];o.getBoundingBox()&&e.union(o.getBoundingBox())}return e},e.prototype.getMarkerInfoList=function(){for(var e=[],t=0,n=this.markers.length;t<n;t++){var o=this.markers[t],a=o.userId+"_"+t,i={id:o.id||a,userId:o.userId,shapeType:o.shapeType,position:o.position,boundingBox:o.boundingBox,state:o.state};e.push(i)}return e},e.prototype.loadMarkers=function(e){this.clear();for(var t=0,n=e.length;t<n;t++){var o=e[t],a=o.userId+"_"+t,i=o.id||a,r=o.userId,l=o.shapeType,s=o.state,d=o.position,c=new window.THREE.Box3;c.max.x=o.boundingBox.max.x,c.max.y=o.boundingBox.max.y,c.max.z=o.boundingBox.max.z,c.min.x=o.boundingBox.min.x,c.min.y=o.boundingBox.min.y,c.min.z=o.boundingBox.min.z;var u={id:i,userId:r,position:d,boundingBox:c,shapeType:l,state:s};this.createMarker(u)}},e.prototype.loadMarkersFromIntersect=function(e,t,n){this.clear(),this.createMarkerByIntersect(e,t,n)},e.prototype.unloadMarkers=function(e){this.clear(e)},e.prototype.updateMarkers=function(){for(var e=0,t=this.markers.length;e<t;e++){this.markers[e].update()}},e.prototype.getMarker=function(e){for(var t=this.markers,n=t.length,o=0;o<n;++o)if(t[o].userId==e)return t[o];return null},e.prototype.getMarkerByUserId=function(e){for(var t=this.markers,n=t.length,o=0;o<n;++o)if(t[o].userId==e)return t[o];return null},e.prototype.setMarkerClickCallback=function(e){this.markerClickCallback=e},e.prototype.setMarkerRightClickCallback=function(e){this.markerRightClickCallback=e},e.prototype.zoomAndPanMarkerById=function(e,t,n,o){var a=this.mapGroupMarkers,i=this.svg.getAttribute("width"),r=this.svg.getAttribute("height"),l=new THREE.Vector2(.5*i,.5*r);for(var s in a){var d=a[s];if(d instanceof Array){var c=d.getObjectByAttribute("id",e);if(c){var u=c.getClientPosition(),p=c.pictureSize.width*c.ratioW,f=c.pictureSize.height*c.ratioH,h=new THREE.Vector2(u.x,u.y),m=h.clone().sub(l);m.multiplyScalar(o);var g=l.x+m.x-.5*p,v=l.y+m.y-.5*f,b=g+t,y=v+n,w="translate("+b+","+y+")";c.shape.setAttribute("transform",w)}}}},e}();n.MarkerEditor=s,window.MarkerEditor=s},{"./../../Common/Utils/Shape2D":2,"./Marker":4,"./MarkerBubble":5,"./MarkerCommon":6,"./MarkerFlag":8}],8:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0}),n.MarkerFlag=void 0;var a=e("./Marker"),i=e("./../../Common/Utils/Shape2D"),r=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.shapeType=a.Marker.shapeTypes.COMMON,o.createShape(),o.addDomEventListeners(),o}return o(t,e),t.prototype.createShape=function(){this.shape=i.Shape2D.makeFlag()},t}(a.Marker);n.MarkerFlag=r},{"./../../Common/Utils/Shape2D":2,"./Marker":4}],9:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./ViewAdapter"),i=function(e){function t(t,n){var o=e.call(this)||this;o.name="VIEW2D",o.minimap=t,o.domContainer=t.getMapContainer(),o.cameraControl=n.cameraControl,o.scene=n.getScene();var a=t.viewerFloor.vfData,i=a.width||298,r=a.height||198;return o.initialDomSize={width:i,height:r},o.currentDomSize={width:i,height:r},o}return o(t,e),t.prototype.getInitialDomSize=function(){return this.initialDomSize},t.prototype.resize=function(e){this.currentDomSize=e},t.prototype.getDomContainerBounds=function(){return this.currentDomSize},t.prototype.getMinimap=function(){return this.minimap},t.prototype.worldToClient=function(e){var t=new window.THREE.Vector3(e.x,e.y,e.z),n=this.minimap.getAxisGridBox2D();this.worldToNormalizedPoint(t,n);var o=this.getDomContainerBounds(),a={width:o.width/2,height:o.height/2};return this.normalizedPointToScreen(t,a),t.x+=a.width,t.y+=a.height,t},t.prototype.normalizedPointToScreen=function(e,t){e.x=e.x*t.width,e.y=-e.y*t.height},t.prototype.worldToNormalizedPoint=function(e,t){var n=t.getSize();e.x=(e.x-t.min.x)/n.x*2-1,e.y=(e.y-t.min.y)/n.y*2-1},t}(a.ViewAdapter);window.Glodon.Bimface.Marker.View2dAdapter=i},{"./ViewAdapter":11}],10:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("./ViewAdapter"),i=function(e){function t(t){var n=e.call(this)||this;return n.name="VIEW3D",n.domContainer=t.domElement,n.cameraControl=t.cameraControl,n.scene=t.getScene(),n}return o(t,e),t.prototype.worldToClient=function(e){var t=this.getDomContainerBounds(),n=this.cameraControl.camera,o=this.getSceneMatrix(),a=new window.THREE.Vector3(e.x,e.y,e.z);return a.applyMatrix4(o),a.project(n),Math.abs(a.z)>1?null:(a.x=Math.round(.5*(a.x+1)*t.width),
a.y=Math.round(-.5*(a.y-1)*t.height),a.z=0,a)},t}(a.ViewAdapter);window.Glodon.Bimface.Marker.View3dAdapter=i},{"./ViewAdapter":11}],11:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ViewAdapter=void 0;var o=e("../../Common/Utils/DomUtil2D"),a=function(){function e(){this.domContainer=null,this.cameraControl=null,this.scene=null,this.name=""}return e.prototype.getName=function(){return this.name},e.prototype.setDomContainer=function(e){this.domContainer=e},e.prototype.getDomContainer=function(){return this.domContainer},e.prototype.worldToClient=function(e){},e.prototype.clientToWorld=function(e){var t=this.getDomContainerBounds(),n=this.cameraControl.camera,o=new window.THREE.Vector3;o.x=e.x/t.width*2-1,o.y=-e.y/t.height*2+1,o.z=0,o.unproject(n);var a=this.getInverseSceneMatrix();return o.applyMatrix4(a),o},e.prototype.getSceneMatrix=function(){return this.scene.getMatrixGlobal()},e.prototype.getInverseSceneMatrix=function(){var e=this.getSceneMatrix(),t=new window.THREE.Matrix4;return t.getInverse(e),t},e.prototype.clientToViewport=function(e){var t=this.getDomContainerBounds(),n=new window.THREE.Vector3;return n.x=e.x/t.width*2-1,n.y=-e.y/t.height*2+1,n.z=0,n},e.prototype.getDomContainerBounds=function(e){return o.DomUtil2D.getContainerOffsetToClient(e||this.domContainer)},e}();n.ViewAdapter=a,window.Glodon.Bimface.Marker={}},{"../../Common/Utils/DomUtil2D":1}]},{},[3]),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI"),t=function(){return{Toolbars:["MainToolbar","ModelTree"],Buttons:["Home","RectangleSelect","Measure","Section","Walk","Map","Property","Setting","Information","FullScreen"],contextMenu:!0,viewer:null,element:null}};e.UIConfig=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI"),t=function(e){var t=this,n=e.viewer;this._toolbars=[],this._panels=[],this._plugins=[],this._opt=e,this._objectTypes={},this._contextMenuCb=function(e){n.contextMenu&&n.contextMenu.element&&n.contextMenu.destroy();var o=e.clientPosition,a=e.containerBox,i={};n.getModels().forEach(function(e){i[e.modelId]=e.getSelectedComponents()});var r=n._getExtrudeBodyModel();r&&(i[r.modelId]=r.getSelectedComponents());var l=n._getExternalComponentModel();l&&(i[l.modelId]=l.getSelectedComponents());var s=new Glodon.Bimface.Application.UI.Menu.ContextMenu(t,i,t._objectTypes),d={},c=s.element.getBoundingClientRect();a.width-o.x>2*c.width?(d.x=o.x,s.element.removeClass("bf-menu-left"),s.element.addClass("bf-menu-right")):(d.x=o.x-c.width,s.element.addClass("bf-menu-left"),s.element.removeClass("bf-menu-right")),a.height-o.y>c.height?d.y=o.y:d.y=o.y-c.height,s.setPosition(d),n.contextMenu=s};var o={initialized:!1,menu:!0,hobby:!0,hover:!1,scroll:!1,backgroundColor:1,borderLine:!1,environment:"color",effect:"low",exposure:0,enableIBLBackground:!1,ambientLight:!1,IBLName:"none",SSAO:!1};o.setDefault=function(){var e=n.getInformation(),a=n.getLoadIBLScene();o=Object.assign(o,{menu:n.isEnableToggleContextMenuDisplay(),hover:n.isEnableHover(),borderLine:n.isEnableBorderLine(),exposure:n.getExposureShift(),ambientLight:n.isEnableIBLBackground(),IBLName:a.IBLSceneOption,enableIBLBackground:a.withBackground}),e.elements>8e4&&e.triangles>2e7||t._opt&&"fluency"===t._opt.effectMode?(o.effect="high",n._effectMode="fluency"):(o.effect="low",n._effectMode="performance")},this.state=o};t.prototype={init:function(){if(this.state.initialized)return!1;var e=this,t=this._opt,n=t.viewer,o=n._data,a=t.Toolbars,i=n._manifest;if("ViewerDrawing"==n.viewerType){if(-1!=a.indexOf("MainToolbar")){var r=Glodon.Bimface.UI.Toolbar.ToolbarConfig();r.id="MainToolbar",r.title="主菜单",r.className="bf-toolbar bf-toolbar-bottom",r.element=t.element,r.buttons=[].concat(_toConsumableArray(t.Buttons)),i.Features.HasSplitDrawing||r.buttons.removeByValue("Sheets"),this.addToolbar(r);var l=this.getToolbar("MainToolbar");document.addEventListener("keydown",function(t){if(27==t.which){var n=l.getControl("DrawingMeasure"),o=e.getPlugin("DrawingMeasure"),a=(e.getPanel("MeaurePanel"),l.getControl("RectZoom"));if(o&&n.isChecked()){var i=o.viewerDrawing.mouseEditorMgr.getEditor();1==i.points.length?o.drawableManager.setIsEnableSelection(!0):0==i.points.length&&n.setCheckedState(!1)}a&&a.setCheckedState(!1)}},!0)}if(-1!=a.indexOf("LeftSubToolbar")&&i.Features.HasLayout){var s=Glodon.Bimface.UI.Toolbar.ToolbarConfig();s.id="LeftSubToolbar",s.title="LeftSubToolbar",s.className="bf-toolbar bf-toolbar-select",s.element=t.element,s.buttons=["LayoutList"],this.addToolbar(s)}if(i.Features.HasText&&-1!=a.indexOf("SearchToolbar")){var d=Glodon.Bimface.UI.Toolbar.ToolbarConfig();d.id="SearchToolbar",d.title="",d.className="bf-toolbar bf-toolbar-search",d.element=t.element,d.buttons=[],this.addToolbar(d);var c=this.getToolbar("SearchToolbar"),u=new Glodon.Bimface.Plugins.Search.SearchConfig;u.wrapElement=c.element,u.viewer=n;var p=new Glodon.Bimface.Plugins.Search.Search(u);this.addPlugin(p)}}else{var f,h=i.Features.HasComponentStructure||i.Features.HasFileList||i.Features.HasLinkRelation||i.Features.HasRoom||i.Features.HasArea||i.Features.HasDrawing||i.Features.HasMEPSystem||i.Features.HasGroup||i.Features.HasAssemble;if(i.Metadata.filetype){var m=i.Metadata.FileType;f="rfa"!=m&&"stp"!=m&&"step"!=m}else f=!o.workerType||-1==o.workerType.indexOf("rfa-")&&-1==o.workerType.indexOf("stp-")&&-1==o.workerType.indexOf("step-");if(-1!=a.indexOf("MainToolbar")){var r=Glodon.Bimface.UI.Toolbar.ToolbarConfig();r.id="MainToolbar",r.title="主菜单",r.className="bf-toolbar bf-toolbar-bottom",r.element=t.element,r.buttons=[].concat(_toConsumableArray(t.Buttons)),i.Features.HasComponentProperty||(r.buttons.removeByValue("Property"),r.buttons.removeByValue("MobileProperty")),i.Features.HasMiniMap||r.buttons.removeByValue("Map"),f||r.buttons.removeByValue("Walk"),this.addToolbar(r)}if(h&&-1!=a.indexOf("ModelTree")&&!e._modelTree){var g=Glodon.Bimface.UI.Toolbar.ToolbarConfig();g.id="ModelTree",g.title="目录树",g.className="bf-toolbar bf-toolbar bf-tree-toolbar",g.element=t.element,g.buttons=["ModelTree"],this.addToolbar(g)}if(i.Features.HasFamilyTypeList&&t.EnableFamilyList){var v=Glodon.Bimface.UI.Toolbar.ToolbarConfig();v.id="FamilyTypes",v.title="FamilyTypes",v.className="bf-toolbar bf-toolbar bf-toolbar-select",v.element=t.element,v.buttons=["FamilyList"],this.addToolbar(v)}t.contextMenu&&(n.addEventListener(Glodon.Bimface.Viewer.Viewer3DEvent.ContextMenu,e._contextMenuCb),n.addEventListener(Glodon.Bimface.Viewer.Viewer3DEvent.ComponentsSelectionChanged,function(t){t.objectId&&(e._objectTypes[t.objectId]=t.objectType)})),this.onKeyUp=function(t){if(t&&27==t.keyCode&&!CLOUD.EditorConfig.NoKey){var o=e.getToolbar("MainToolbar"),a=o.getControl("RectangleSelect"),i=o.getControl("Measure"),r=getSectionState(e),l=o.getControl("Walk");if(a&&a.isChecked())a.setCheckedState(!1);else if(i&&i.isChecked()){var s=e.getPlugin("Measure");s&&s.getInfo().points.length>0?(s.redo(),0==s.getInfo().points.length&&s.drawableManager.setIsEnableSelection(!0)):i.setCheckedState(!1)}else r.enable?clearSection(e):l&&l.isChecked()&&l.setCheckedState(!1);n.render()}},document.addEventListener("keyup",this.onKeyUp),e.state.setDefault(),e.state.initialized=!0}},addToolbar:function(e){var t=this,n=Glodon.Bimface.Application.UI.Toolbar.Toolbar(e,t);this._toolbars.push(n)},removeToolbar:function(e){return this._toolbars.removeObjectByAttribute("id",e),[].concat(_toConsumableArray(this._toolbars))},getToolbar:function(e){return this._toolbars.getObjectByAttribute("id",e)},getToolbars:function(){return[].concat(_toConsumableArray(this._toolbars))},getViewer:function(){return this._opt.viewer},getRootElement:function(){return this._opt.element},addPanel:function(e){this._panels.push(e)},removePanel:function(e){this._panels.removeObjectByAttribute("id",e)},getPanel:function(e){return this._panels.getObjectByAttribute("id",e)},getPanels:function(e){return[].concat(_toConsumableArray(this._panels))},addPlugin:function(e){this._plugins.push(e)},removePlugin:function(e){this._plugins.removeObjectByAttribute("id",e)},getPlugin:function(e){return this._plugins.getObjectByAttribute("id",e)},getPlugins:function(e){return[].concat(_toConsumableArray(this._plugins))},destroy:function(){"ViewerDrawing"==this._opt.viewer.viewerType||(document.removeEventListener("keyup",this.onKeyUp),this._opt.viewer.removeEventListener(Glodon.Bimface.Viewer.Viewer3DEvent.ContextMenu,this._contextMenuCb));for(var e=0;e<this._toolbars.length;e++)this._toolbars[e].destroy();for(var t=0;t<this._panels.length;t++)this._panels[t].destroy();for(var n=0;n<this._plugins.length;n++)this._plugins[n].exit();this._toolbars=[],this._panels=[],this._plugins=[],this.state.initialized=!1,this._opt.viewer.render&&this._opt.viewer.render(),this._opt=null},updateModelTree:function(){var e=this,t=this._opt,n=t.viewer,o=n._manifest,a=o.Features.HasComponentStructure||o.Features.HasFileList||o.Features.HasLinkRelation||o.Features.HasRoom||o.Features.HasArea||o.Features.HasDrawing||o.Features.HasMEPSystem||o.Features.HasGroup||o.Features.HasAssemble,i=e.getPanel("ModelTree"),r=e.getToolbar("ModelTree");if(i){var l=i.isShow;if(l&&i.hide(),i.destroy(),e.removePanel("ModelTree"),l){r.hide();var s=new Glodon.Bimface.Application.UI.Panel.ModelTreePanel(e,r);e.getRootElement().appendChild(s.element),e.addPanel(s)}}if(!a&&r)r.destroy(),e.removeToolbar("ModelTree");else if(a&&!r){var d=Glodon.Bimface.UI.Toolbar.ToolbarConfig();d.id="ModelTree",d.title="目录树",d.className="bf-toolbar bf-toolbar bf-tree-toolbar",d.element=t.element,d.buttons=["ModelTree"],e.addToolbar(d)}}},e.UI=t}();